import{b as W,m as q,ai as Y,aj as ne,a3 as z,ak as ae,g as E,af as ie,al as le,ag as re,C as ce,ad as H,F as A,a6 as X,J as de,a2 as F,am as pe,D as ue,a9 as Z,S as me,W as fe,ac as he,a8 as ye,aa as we,a as be}from"./three.module.890a6b73.js";import{O as ve}from"./OrbitControls.7256e180.js";import{a as _e,C as ge}from"./CSS2DRenderer.f3645388.js";import{f as ke,a as Me}from"./solarSystem.4528ec56.js";import{d as xe,r as b,b as N,j,g as n,t as S,u as m,h as x,f as O,o as P,a6 as J,w as I,S as B,e as K,v as T,P as Q,Q as Se,p as Pe,ak as De,al as U}from"./vendor.289a3f5a.js";import{u as Ce}from"./index.cc2afb49.js";import"./index.e4957ff4.js";async function je({numStars:o=1e4}={}){function t(){const c=Math.random()*25+5e12,y=Math.random(),g=Math.random(),_=2*Math.PI*y,k=Math.acos(2*g-1),D=c*Math.sin(k)*Math.cos(_),$=c*Math.sin(k)*Math.sin(_),w=c*Math.cos(k);return{pos:new E(D,$,w),minDist:c}}const e=[],s=[],d=[0,.1,.65];let i;for(let c=0;c<o;c+=1){const y=d[Math.floor(Math.random()*d.length)],g=t(),{pos:_}=g;i=new W().setHSL(y,Math.random(),Math.random()),e.push(_.x,_.y,_.z),s.push(i.r,i.g,i.b)}const u=new q;u.setAttribute("position",new Y(e,3)),u.setAttribute("color",new Y(s,3));const h=await ke({filter:[{key:"key",value:"star"}]});if(h){const c=new ne({size:.2,vertexColors:!0,map:new z().load(h.data[0].url)});return new ae(u,c)}}const L=xe("solarSystemStore",()=>{const o=b(!0),t=b(!1),e=b(!0),s=1e-4,d=b(3),i=b(!0),u=b(60),a={exposure:1,strength:1.2,threshold:.4,radius:0},h=b(null),c=b(null),y=b([]);return{realTime:i,selectedPlanetMission:h,selectedPlanet:c,displayPath:o,displayGridHelper:t,isRealScale:e,controlSpeed:d,timelapseMultiply:u,scaleDown:s,BLOOM_PARAMS:a,planets:y}});function V(o){return o*1496e5}function ee(o,t,e=1,s=.4){const d=5e3,i=L(),u=new ie({color:t.color,linewidth:e,transparent:!0,opacity:s}),a=new le(0,0,V(t.perihelion_astronomical_unit)*i.scaleDown,V(t.aphelion_astronomical_unit)*i.scaleDown,0,2*Math.PI,!1,0),h=a.getPoints(d),c=new q().setFromPoints(h),y=new re(c,u);y.rotation.x=Math.PI*.5;const g=new ce;function _(){const k=new E,D=i.realTime?g.getElapsedTime()*(1/(t.synodic_orbital_period*31536e3)):g.getElapsedTime()*(1/t.synodic_orbital_period)/i.timelapseMultiply%1;a.getPointAt(D,k),o.position.copy(k),o.position.applyMatrix4(y.matrixWorld)}return{animatedPath:_,path:y}}function Te(o){return{all:o=o||new Map,on:function(t,e){var s=o.get(t);s?s.push(e):o.set(t,[e])},off:function(t,e){var s=o.get(t);s&&(e?s.splice(s.indexOf(e)>>>0,1):o.set(t,[]))},emit:function(t,e){var s=o.get(t);s&&s.slice().map(function(d){d(e)}),(s=o.get("*"))&&s.slice().map(function(d){d(t,e)})}}}var R=Te();const G=L();function ze(o){const t=new H,e=new H,s=new z().load(o.texture_map),d=new z().load(o.normal_map),i=new A(new X(o.radius*G.scaleDown,264,164),o.key==="sun"?new de({map:s}):new F({map:s,normalMap:o.normal_map?d:null}));if(i.rotateZ(Math.PI/180*o.tilt),o.ring){const a=new z().load(o.ring),h=new pe(20,30,128),c=new F({map:a,side:ue}),y=new A(h,c);y.rotateY(-.5*Math.PI),y.rotateX(-.4*Math.PI),e.add(y)}o.moons&&o.moons.length&&o.moons.forEach(a=>{const h=new H,c=new A(new X(a.radius*G.scaleDown,32,32),new F({map:new z().load(a.texture_map),normalMap:new z().load(a.normal_map)}));c.position.set(V(a.perihelion_astronomical_unit)*G.scaleDown,0,0);const y=new Z(a.color||16777215,.2,500,0);c.add(y),h.add(c),e.add(h),te(c,c,a),ee(h,a)});let u;if(o.key!=="sun"&&(u=ee(e,o)),o.key==="sun"){const a=new Z(16777215,o.luminosity*5,5e6,0);i.add(a)}te(i,e,o),e.add(i),t.add(e),G.planets.push({raw:o,bodySystemObj:t,bodySystem:e,body:i,path:u})}function te(o,t,e){const s=document.createElement("div");s.className=`${e.key} tracking-widest  uppercase cursor-pointer font-bold opacity-60`,s.innerText=e.name,s.addEventListener("pointerdown",()=>{R.emit("pin-planet",{object3d:t,planetData:e})});const d=new _e(s);d.position.copy(o.position),d.center.set(.5,1),d.layers.set(0),o.add(d)}const Re={class:"my-2 rounded w-[inherit] h-full bg-[#39393c3a] relative"},$e={class:"mx-3 py-1"},Ee={class:"flex justify-between items-center truncate"},Le={class:"tracking-[8px] uppercase truncate transition-all duration-100 font-bold opacity-60"},Oe={class:"flex items-center"},Ie=N({__name:"planetMission",emits:["close"],setup(o,{emit:t}){const e=L(),s=t;function d(){s("close")}return(i,u)=>{const a=O("Icon");return P(),j("div",Re,[n("div",$e,[n("div",Ee,[n("div",Le,S(m(e).selectedPlanetMission.name)+"'s Missions ",1),n("div",Oe,[x(a,{class:"scale-150 opacity-40 cursor-pointer",icon:"material-symbols:close-rounded",onClick:d})])])])])}}});const Be={class:"absolute bottom-10 left-1/2 z-10"},Ge={class:"-translate-x-1/2 w-max space-y-1"},He={key:0,class:"flex justify-center tracking-widest truncate transition-all duration-100 font-bold opacity-60 space-x-1"},Ae=n("span",{class:"mr-1"},"1 year =",-1),Fe={class:"text-green-400"},Ne={class:"grid grid-cols-3 gap-7 min-h-[34px]"},Ue={class:"flex justify-center items-center"},Ve={class:"absolute top-0 left-0 z-10"},We={class:"flex"},qe={class:"flex items-center justify-between mb-1"},Ye={class:"tracking-widest uppercase truncate transition-all duration-100 cursor-pointer font-bold opacity-60"},Xe={class:"overflow-y-auto overflow-x-hidden space-y-1 planet-list pb-1 pr-1 max-h-[70vh]"},Ze=["onClick"],Je={class:"flex justify-between h-full"},Ke={class:"mx-3 my-1 flex flex-col justify-between"},Qe={class:"tracking-widest cursor-pointer font-bold"},et={class:"flex space-x-2 mb-1"},tt={class:"translate-x-1/3"},st=["src"],ot={class:"absolute top-0 right-0 z-10"},nt={class:"m-2 space-y-1"},at=n("div",{class:"text-right"},[n("h3",{class:"tracking-widest uppercase cursor-pointer font-bold opacity-60"}," Option ")],-1),it=n("div",{class:"absolute z-10 bottom-1 left-1"},[n("div",{class:"opacity-30 italic"}," Real time position is not supported ")],-1),lt=N({__name:"navOverlay",setup(o){const{t}=Ce(),e=L(),s=b(!1),d=b("minute(s)"),i=[{key:"second(s)",label:"second"},{key:"minute(s)",label:"minute"},{key:"hour(s)",label:"hour"},{key:"day(s)",label:"day"}],u=b(!0),a=b(0);J(()=>{d.value==="minute(s)"?a.value=e.timelapseMultiply/60:d.value==="hour(s)"?a.value=e.timelapseMultiply/(60*60):d.value==="day(s)"?a.value=e.timelapseMultiply/(60*60*24):a.value=e.timelapseMultiply});function h(w){e.selectedPlanet?e.selectedPlanet.planetData.key===w.raw.key?e.selectedPlanet=null:R.emit("pin-planet",{object3d:w.bodySystem,planetData:w.raw}):R.emit("pin-planet",{object3d:w.bodySystem,planetData:w.raw})}function c(w){R.emit("move-to-planet",{object3d:w.bodySystem,planetData:w.raw})}function y(){switch(d.value){case"minute(s)":e.timelapseMultiply=e.timelapseMultiply+60;break;case"hour(s)":e.timelapseMultiply=e.timelapseMultiply+60*60;break;case"day(s)":e.timelapseMultiply=e.timelapseMultiply+60*60*24;break;default:++e.timelapseMultiply;break}}function g(){if(e.timelapseMultiply>0)switch(d.value){case"minute(s)":e.timelapseMultiply=e.timelapseMultiply-60;break;case"hour(s)":e.timelapseMultiply=e.timelapseMultiply-60*60;break;case"day(s)":e.timelapseMultiply=e.timelapseMultiply-60*60*24;break;default:--e.timelapseMultiply;break}}function _(w){switch(d.value=w,d.value){case"minute(s)":e.timelapseMultiply=a.value*60;break;case"hour(s)":e.timelapseMultiply=a.value*60*60;break;case"day(s)":e.timelapseMultiply=a.value*60*60*24;break;default:e.timelapseMultiply=a.value;break}}function k(){e.realTime=!e.realTime}function D(w,v){w.stopPropagation(),s.value=!0,e.selectedPlanetMission=v.raw}function $(){s.value=!s.value}return(w,v)=>{const l=O("n-dropdown"),p=O("Icon"),f=O("n-button");return P(),j(Q,null,[n("div",Be,[n("div",Ge,[m(e).realTime?B("",!0):(P(),j("div",He,[Ae,n("span",Fe,S(a.value),1),x(l,{trigger:"hover",options:i,onSelect:_},{default:I(()=>[n("span",null,S(d.value),1)]),_:1})])),n("div",Ne,[n("div",null,[m(e).realTime?B("",!0):(P(),K(f,{key:0,disabled:a.value===1||m(e).realTime,quaternary:"",class:"opacity-60 !bg-[#ffffff4d] w-min",onClick:g},{default:I(()=>[x(p,{icon:"solar:skip-previous-line-duotone"})]),_:1},8,["disabled"]))]),n("div",Ue,[n("div",{class:T(`${m(e).realTime?"bg-green-600 before:bg-green-600":"bg-blue-600 before:bg-blue-600"} rounded-full w-4 h-4 cursor-pointer before:w-6 before:h-6 before:opacity-60 before:content-[''] before:flex before:-m-1 before:rounded-full`),onClick:k},null,2)]),n("div",null,[m(e).realTime?B("",!0):(P(),K(f,{key:0,disabled:m(e).realTime,quaternary:"",class:"opacity-60 !bg-[#ffffff4d] w-min",onClick:y},{default:I(()=>[x(p,{icon:"solar:skip-next-line-duotone"})]),_:1},8,["disabled"]))])]),n("div",{class:T(`tracking-widest text-[16px] uppercase ${m(e).realTime?"text-green-600":"text-blue-600"} font-thin truncate transition-all duration-100 font-bold opacity-60`)},S(m(e).realTime?"Real time":"Relative time"),3)])]),n("div",Ve,[n("div",We,[n("div",{class:T(`m-2  transition-all duration-200
       ${u.value?"w-[20vw]":"w-0"}`)},[n("div",qe,[n("div",Ye,S(m(t)("view.solar_system.planet_nav.title")),1),n("div",null,[x(f,{size:"small",ghost:"",class:"bg-[#39393c99] opacity-60",onClick:v[0]||(v[0]=r=>u.value=!u.value)},{default:I(()=>[x(p,{icon:u.value?"ic:baseline-keyboard-double-arrow-left":"ic:baseline-keyboard-double-arrow-right"},null,8,["icon"])]),_:1})])]),n("div",Xe,[(P(!0),j(Q,null,Se(m(e).planets,(r,M)=>(P(),j("div",{key:M,class:"bg-[#3a3a3d99] h-[7vh] hover:bg-[#39393c99] transition-all duration-100 rounded-sm opacity-40 hover:opacity-100 cursor-pointer",onClick:C=>c(r)},[n("div",Je,[n("div",Ke,[n("div",Qe,S(r.raw.name),1),n("div",et,[x(p,{class:"cursor-pointer",icon:m(e).selectedPlanet&&m(e).selectedPlanet.planetData.key===r.raw.key?"solar:pin-bold":"solar:pin-broken",onClick:C=>h(r)},null,8,["icon","onClick"]),x(p,{class:"cursor-pointer",icon:"solar:satellite-linear",onClick:C=>D(C,r)},null,8,["onClick"])])]),n("div",tt,[n("img",{src:r.raw.logo,class:"h-full"},null,8,st)])])],8,Ze))),128))])],2),m(e).selectedPlanetMission?(P(),j("div",{key:0,class:T(`${u.value&&s.value?"w-[50vw]":"w-0"} h-[inherit] transition-all duration-100 `)},[x(Ie,{onClose:$})],2)):B("",!0)])]),n("div",ot,[n("div",nt,[at,n("div",{class:T(`p-2 cursor-pointer  ${m(e).displayPath?"bg-[#ffffffb0] text-black":"bg-[#ffffff33] "}`),onClick:v[1]||(v[1]=r=>m(e).displayPath=!m(e).displayPath)},S(m(e).displayPath?m(t)("view.solar_system.option.show_orbit"):m(t)("view.solar_system.option.hide_orbit")),3),n("div",{class:T(`p-2 cursor-pointer  ${m(e).displayGridHelper?"bg-[#ffffffb0] text-black":"bg-[#ffffff33] "}`),onClick:v[2]||(v[2]=r=>m(e).displayGridHelper=!m(e).displayGridHelper)},S(m(e).displayGridHelper?"Show grid":"Hide grid"),3),n("div",{class:T(`p-2 cursor-pointer  ${m(e).isRealScale?"bg-[#ffffffb0] text-black":"bg-[#ffffff33] "}`),onClick:v[3]||(v[3]=r=>m(e).isRealScale=!m(e).isRealScale)},S(m(e).isRealScale?"Real scale":"Relative scale"),3)])]),it],64)}}}),rt={class:"relative w-full h-full"},yt=N({__name:"index",setup(o){const t=L(),e=b(null),s=new me,d=b(null);let i,u;const a=new fe({antialias:!0,logarithmicDepthBuffer:!1}),h=new ge;let c=2;const y=new he(1e7,1e3),g=new ye(1e7),_=new we(4210752,.2);s.add(_),Pe(async()=>{s.background=new W("black");const l=await je();s.add(l);const{width:p,height:f,top:r}=e.value.getBoundingClientRect();i=new be(75,p/f,.1,1e12),i.position.set(0,8e4,8e4),a.setPixelRatio(window.devicePixelRatio),a.setSize(p,f),e.value.appendChild(a.domElement),h.setSize(p,f),h.domElement.style.position="absolute",h.domElement.style.top=r+"px",document.body.appendChild(h.domElement),u=new ve(i,h.domElement),u.zoomSpeed=t.controlSpeed,u.panSpeed=t.controlSpeed,v(),window.addEventListener("resize",D)}),De(()=>{e.value.removeChild(a.domElement),document.body.removeChild(h.domElement)}),R.on("pin-planet",l=>{c=2,t.selectedPlanet=l;const{x:p,y:f,z:r}=t.selectedPlanet.object3d.position;i.position.x=p-t.selectedPlanet.planetData.radius*t.scaleDown-2,i.position.y=f+t.selectedPlanet.planetData.radius*t.scaleDown+1,i.position.z=r+t.selectedPlanet.planetData.radius*t.scaleDown+2,u.target=new E(p,f,r)}),R.on("move-to-planet",l=>{const{x:p,y:f,z:r}=l.object3d.position;i.position.x=p-l.planetData.radius*t.scaleDown-2,i.position.y=f+l.planetData.radius*t.scaleDown+1,i.position.z=r+l.planetData.radius*t.scaleDown+2,u.target=new E(p,f,r)}),J(()=>{t.displayGridHelper?(s.add(y),s.add(g)):(s.remove(y),s.remove(g)),u&&(u.zoomSpeed=t.controlSpeed,u.panSpeed=t.controlSpeed)}),k();async function k(){const l=[],f=await Me({filter:[]});f&&(f.data.forEach(r=>{if(r.mother_planet){const M=f.data.find(C=>C.key===r.mother_planet);M&&(M.moons||(M.moons=[]),M.moons.push(r))}else l.push(r)}),l.forEach(r=>{ze(r)}),t.planets.forEach(r=>{s.add(U(r.bodySystemObj)),r.path&&s.add(U(r.path.path))}))}function D(){const{width:l,height:p}=e.value.getBoundingClientRect();a.setSize(l,p)}window.addEventListener("wheel",$);function $(l){p(l)?c>2&&--c:c<10&&++c;function p(f){return f.wheelDelta?f.wheelDelta>0:f.deltaY<0}}function w(l,p){a.render(l,p),h.render(l,p)}function v(){if(d.value=requestAnimationFrame(v),u.update(),w(s,i),t.planets.length&&t.planets.forEach(l=>{l.raw.key!=="sun"&&(l.body.rotateY(t.realTime?1/(l.raw.synodic_rotation_period*84600):1/(l.raw.synodic_rotation_period*84600)/t.timelapseMultiply),l.path&&U(l.path.animatedPath()))}),t.selectedPlanet){const l=t.planets.find(oe=>oe.raw.key==="sun"),p=t.selectedPlanet.object3d.position.distanceTo(l==null?void 0:l.bodySystem.position),{x:f,y:r,z:M}=t.selectedPlanet.object3d.position,C=(p-t.selectedPlanet.planetData.radius*t.scaleDown*c)*(f/p),se=(p-t.selectedPlanet.planetData.radius*t.scaleDown*c)*(M/p);i.position.x=C,i.position.z=se,u.target=new E(f,r,M)}}return(l,p)=>(P(),j("div",rt,[n("div",{ref_key:"el",ref:e,class:"w-full h-full"},null,512),x(lt)]))}});export{yt as default};
