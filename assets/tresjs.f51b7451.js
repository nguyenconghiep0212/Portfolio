var Ps=Object.defineProperty,Cs=Object.defineProperties;var Es=Object.getOwnPropertyDescriptors;var wn=Object.getOwnPropertySymbols;var ui=Object.prototype.hasOwnProperty,ci=Object.prototype.propertyIsEnumerable;var di=(n,e,t)=>e in n?Ps(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,He=(n,e)=>{for(var t in e||(e={}))ui.call(e,t)&&di(n,t,e[t]);if(wn)for(var t of wn(e))ci.call(e,t)&&di(n,t,e[t]);return n},Et=(n,e)=>Cs(n,Es(e));var Qn=(n,e)=>{var t={};for(var r in n)ui.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&wn)for(var r of wn(n))e.indexOf(r)<0&&ci.call(n,r)&&(t[r]=n[r]);return t};import{S as Ms,C as Ss,R as Ts,P as Ls,a as Ge,O as wt,W as Jn,b as lt,c as ks,d as As,e as Os,A as Vs,f as js,V as _e,B as Ds,T as Is,g as X,E as hi,h as Bs,i as pi,Q as er,M as bn,j as Rs,k as Fs,l as Us,m as Ns,I as zs,n as mi,o as fi,p as ut,q as vi,U as _n,r as Hs,s as tr,t as bt,L as Gs,u as $s,v as Ks,w as nr,D as qs,x as Ws,y as Mt,z as gi,F as Ht,G as Ys,H as Xs,J as Zs,K as wi,N as rr,X as Qs,Y as Js,Z as bi,_ as ea,$ as ta,a0 as na}from"./three.module.890a6b73.js";import{u as W,$ as _i,a0 as yi,p as ir,q as ra,r as Y,a1 as or,n as ye,a2 as yn,a3 as ia,a4 as xn,a5 as xi,c as ge,a6 as _t,a7 as oa,b as Je,a8 as St,a9 as Pi,o as Tt,j as Lt,v as sa,x as aa,aa as la,ab as sr,ac as et,ad as Ci,ae as ua,P as ca,af as da,S as Ei,ag as ha,h as Be,ah as pa,g as ma,w as Mi,f as Gt}from"./vendor.289a3f5a.js";function tt(n){return _i()?(yi(n),!0):!1}function $t(){const n=new Set,e=i=>{n.delete(i)};return{on:i=>{n.add(i);const o=()=>e(i);return tt(o),{off:o}},off:e,trigger:(...i)=>Promise.all(Array.from(n).map(o=>o(...i)))}}function ce(n){return typeof n=="function"?n():W(n)}const kt=typeof window!="undefined"&&typeof document!="undefined";typeof WorkerGlobalScope!="undefined"&&globalThis instanceof WorkerGlobalScope;const fa=n=>n!=null,va=Object.prototype.toString,ga=n=>va.call(n)==="[object Object]",wa=()=>{};function ba(n,e,t=!1){return e.reduce((r,i)=>(i in n&&(!t||n[i]!==void 0)&&(r[i]=n[i]),r),{})}function _a(n){return n||xn()}function ya(n,e={}){if(!or(n))return yn(n);const t=Array.isArray(n.value)?Array.from({length:n.value.length}):{};for(const r in n.value)t[r]=ia(()=>({get(){return n.value[r]},set(i){var o;if((o=ce(e.replaceRef))!=null?o:!0)if(Array.isArray(n.value)){const s=[...n.value];s[r]=i,n.value=s}else{const s=Et(He({},n.value),{[r]:i});Object.setPrototypeOf(s,Object.getPrototypeOf(n.value)),n.value=s}else n.value[r]=i}}));return t}function ar(n,e=!0,t){_a()?ir(n,t):e?n():ra(n)}function xa(n,e=1e3,t={}){const{immediate:r=!0,immediateCallback:i=!1}=t;let o=null;const a=Y(!1);function s(){o&&(clearInterval(o),o=null)}function p(){a.value=!1,s()}function f(){const _=ce(e);_<=0||(a.value=!0,i&&n(),s(),o=setInterval(n,_))}if(r&&kt&&f(),or(e)||typeof e=="function"){const _=ye(e,()=>{a.value&&kt&&f()});tt(_)}return tt(p),{isActive:a,pause:p,resume:f}}function Re(n){var e;const t=ce(n);return(e=t==null?void 0:t.$el)!=null?e:t}const nt=kt?window:void 0;kt&&window.document;kt&&window.navigator;kt&&window.location;function Kt(...n){let e,t,r,i;if(typeof n[0]=="string"||Array.isArray(n[0])?([t,r,i]=n,e=nt):[e,t,r,i]=n,!e)return wa;Array.isArray(t)||(t=[t]),Array.isArray(r)||(r=[r]);const o=[],a=()=>{o.forEach(_=>_()),o.length=0},s=(_,g,E,O)=>(_.addEventListener(g,E,O),()=>_.removeEventListener(g,E,O)),p=ye(()=>[Re(e),ce(i)],([_,g])=>{if(a(),!_)return;const E=ga(g)?He({},g):g;o.push(...t.flatMap(O=>r.map(b=>s(_,O,b,E))))},{immediate:!0,flush:"post"}),f=()=>{p(),a()};return tt(f),f}function Pa(){const n=Y(!1),e=xn();return e&&ir(()=>{n.value=!0},e),n}function Pn(n){const e=Pa();return ge(()=>(e.value,Boolean(n())))}function lr(n,e={}){const{immediate:t=!0,fpsLimit:r=void 0,window:i=nt}=e,o=Y(!1),a=r?1e3/r:null;let s=0,p=null;function f(E){if(!o.value||!i)return;s||(s=E);const O=E-s;if(a&&O<a){p=i.requestAnimationFrame(f);return}s=E,n({delta:O,timestamp:E}),p=i.requestAnimationFrame(f)}function _(){!o.value&&i&&(o.value=!0,s=0,p=i.requestAnimationFrame(f))}function g(){o.value=!1,p!=null&&i&&(i.cancelAnimationFrame(p),p=null)}return t&&_(),tt(g),{isActive:xi(o),pause:g,resume:_}}function Ca(n,e={}){const{window:t=nt}=e,r=Pn(()=>t&&"matchMedia"in t&&typeof t.matchMedia=="function");let i;const o=Y(!1),a=f=>{o.value=f.matches},s=()=>{!i||("removeEventListener"in i?i.removeEventListener("change",a):i.removeListener(a))},p=_t(()=>{!r.value||(s(),i=t.matchMedia(ce(n)),"addEventListener"in i?i.addEventListener("change",a):i.addListener(a),o.value=i.matches)});return tt(()=>{p(),s(),i=void 0}),o}function Ea(n,e,t={}){const E=t,{window:r=nt}=E,i=Qn(E,["window"]);let o;const a=Pn(()=>r&&"MutationObserver"in r),s=()=>{o&&(o.disconnect(),o=void 0)},p=ge(()=>{const O=ce(n),b=(Array.isArray(O)?O:[O]).map(Re).filter(fa);return new Set(b)}),f=ye(()=>p.value,O=>{s(),a.value&&r&&O.size&&(o=new MutationObserver(e),O.forEach(b=>o.observe(b,i)))},{immediate:!0,flush:"post"}),_=()=>o==null?void 0:o.takeRecords(),g=()=>{s(),f()};return tt(g),{isSupported:a,stop:g,takeRecords:_}}function Ma(n={}){const{window:e=nt}=n,t=Y(1);if(e){let r=function(){t.value=e.devicePixelRatio,i(),o=e.matchMedia(`(resolution: ${t.value}dppx)`),o.addEventListener("change",r,{once:!0})},i=function(){o==null||o.removeEventListener("change",r)},o;r(),tt(i)}return{pixelRatio:t}}function Si(n,e,t={}){const g=t,{window:r=nt}=g,i=Qn(g,["window"]);let o;const a=Pn(()=>r&&"ResizeObserver"in r),s=()=>{o&&(o.disconnect(),o=void 0)},p=ge(()=>Array.isArray(n)?n.map(E=>Re(E)):[Re(n)]),f=ye(p,E=>{if(s(),a.value&&r){o=new ResizeObserver(e);for(const O of E)O&&o.observe(O,i)}},{immediate:!0,flush:"post"}),_=()=>{s(),f()};return tt(_),{isSupported:a,stop:_}}function Sa(n,e={}){const{reset:t=!0,windowResize:r=!0,windowScroll:i=!0,immediate:o=!0}=e,a=Y(0),s=Y(0),p=Y(0),f=Y(0),_=Y(0),g=Y(0),E=Y(0),O=Y(0);function b(){const P=Re(n);if(!P){t&&(a.value=0,s.value=0,p.value=0,f.value=0,_.value=0,g.value=0,E.value=0,O.value=0);return}const M=P.getBoundingClientRect();a.value=M.height,s.value=M.bottom,p.value=M.left,f.value=M.right,_.value=M.top,g.value=M.width,E.value=M.x,O.value=M.y}return Si(n,b),ye(()=>Re(n),P=>!P&&b()),Ea(n,b,{attributeFilter:["style","class"]}),i&&Kt("scroll",b,{capture:!0,passive:!0}),r&&Kt("resize",b,{passive:!0}),ar(()=>{o&&b()}),{height:a,bottom:s,left:p,right:f,top:_,width:g,x:E,y:O,update:b}}function Ta(n,e={width:0,height:0},t={}){const{window:r=nt,box:i="content-box"}=t,o=ge(()=>{var g,E;return(E=(g=Re(n))==null?void 0:g.namespaceURI)==null?void 0:E.includes("svg")}),a=Y(e.width),s=Y(e.height),{stop:p}=Si(n,([g])=>{const E=i==="border-box"?g.borderBoxSize:i==="content-box"?g.contentBoxSize:g.devicePixelContentBoxSize;if(r&&o.value){const O=Re(n);if(O){const b=r.getComputedStyle(O);a.value=Number.parseFloat(b.width),s.value=Number.parseFloat(b.height)}}else if(E){const O=Array.isArray(E)?E:[E];a.value=O.reduce((b,{inlineSize:P})=>b+P,0),s.value=O.reduce((b,{blockSize:P})=>b+P,0)}else a.value=g.contentRect.width,s.value=g.contentRect.height},t);ar(()=>{const g=Re(n);g&&(a.value="offsetWidth"in g?g.offsetWidth:e.width,s.value="offsetHeight"in g?g.offsetHeight:e.height)});const f=ye(()=>Re(n),g=>{a.value=g?e.width:0,s.value=g?e.height:0});function _(){p(),f()}return{width:a,height:s,stop:_}}function La(n){var e;const t=Y(0);if(typeof performance=="undefined")return t;const r=(e=n==null?void 0:n.every)!=null?e:10;let i=performance.now(),o=0;return lr(()=>{if(o+=1,o>=r){const a=performance.now(),s=a-i;t.value=Math.round(1e3/(s/o)),i=a,o=0}}),t}function ka(n={}){const e=Y(),t=Pn(()=>typeof performance!="undefined"&&"memory"in performance);if(t.value){const{interval:r=1e3}=n;xa(()=>{e.value=performance.memory},r,{immediate:n.immediate,immediateCallback:n.immediateCallback})}return{isSupported:t,memory:e}}const Ti={x:0,y:0,pointerId:0,pressure:0,tiltX:0,tiltY:0,width:0,height:0,twist:0,pointerType:null},Aa=Object.keys(Ti);function Oa(n={}){const{target:e=nt}=n,t=Y(!1),r=Y(n.initialValue||{});Object.assign(r.value,Ti,r.value);const i=o=>{t.value=!0,!(n.pointerTypes&&!n.pointerTypes.includes(o.pointerType))&&(r.value=ba(o,Aa,!1))};if(e){const o={passive:!0};Kt(e,["pointerdown","pointermove","pointerup"],i,o),Kt(e,"pointerleave",()=>t.value=!1,o)}return Et(He({},ya(r)),{isInside:t})}function Va(n={}){const{window:e=nt,initialWidth:t=Number.POSITIVE_INFINITY,initialHeight:r=Number.POSITIVE_INFINITY,listenOrientation:i=!0,includeScrollbar:o=!0}=n,a=Y(t),s=Y(r),p=()=>{e&&(o?(a.value=e.innerWidth,s.value=e.innerHeight):(a.value=e.document.documentElement.clientWidth,s.value=e.document.documentElement.clientHeight))};if(p(),ar(p),Kt("resize",p,{passive:!0}),i){const f=Ca("(orientation: portrait)");ye(f,()=>p())}return{width:a,height:s}}const ja=({sizes:n,scene:e})=>{const t=Y([]),r=ge(()=>t.value[0]),i=(s,p=!1)=>{t.value.some(({uuid:f})=>f===s.uuid)||(p?a(s):t.value.push(s))},o=s=>{t.value=t.value.filter(({uuid:p})=>p!==s.uuid)},a=s=>{const p=s instanceof ks?s:t.value.find(_=>_.uuid===s);if(!p)return;const f=t.value.filter(({uuid:_})=>_!==p.uuid);t.value=[p,...f]};return _t(()=>{n.aspectRatio.value&&t.value.forEach(s=>{s instanceof Ge&&(s.aspect=n.aspectRatio.value),(s instanceof Ge||s instanceof wt)&&s.updateProjectionMatrix()})}),e.userData.tres__registerCamera=i,e.userData.tres__deregisterCamera=o,et(()=>{t.value=[]}),{camera:r,cameras:t,registerCamera:i,deregisterCamera:o,setCameraActive:a}},Li=$t(),ki=$t(),ur=$t(),qt=new Ss;let Cn=0,En=0;const{pause:Da,resume:Ia,isActive:Ba}=lr(()=>{Li.trigger({delta:Cn,elapsed:En,clock:qt}),ki.trigger({delta:Cn,elapsed:En,clock:qt}),ur.trigger({delta:Cn,elapsed:En,clock:qt})},{immediate:!1});ur.on(()=>{Cn=qt.getDelta(),En=qt.getElapsedTime()});const At=()=>({onBeforeLoop:Li.on,onLoop:ki.on,onAfterLoop:ur.on,pause:Da,resume:Ia,isActive:Ba}),Ai="[TresJS \u25B2 \u25A0 \u25CF] ";function cr(){function n(r,i){console.error(`${Ai} ${r}`,i||"")}function e(r){console.warn(`${Ai} ${r}`)}function t(r,i){}return{logError:n,logWarning:e,logMessage:t}}function Ra(n){return n instanceof lt?n:Array.isArray(n)?new lt(...n):new lt(n)}const Oi=(n,e)=>{for(const t of Object.keys(e))e[t]instanceof Object&&Object.assign(e[t],Oi(n[t],e[t]));return Object.assign(n||{},e),n},Fa="html,body,base,head,link,meta,style,title,address,article,aside,footer,header,hgroup,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot",Ua=Na(Fa);function Vi(n){return n&&n.nodeType===1}function Mn(n){return n.replace(/-([a-z])/g,(e,t)=>t.toUpperCase())}function Na(n,e){const t=Object.create(null),r=n.split(",");for(let i=0;i<r.length;i++)t[r[i]]=!0;return e?i=>!!t[i.toLowerCase()]:i=>!!t[i]}const za=(n,e)=>{const t=new Set,r=[];for(const i of n){const o=e(i);t.has(o)||(t.add(o),r.push(i))}return r},ji=(n,e)=>{if(!e)return;const t=Array.isArray(e)?e:e.match(/([^[.\]])+/g);return t==null?void 0:t.reduce((r,i)=>r&&r[i],n)},Ha=(n,e,t)=>{const r=Array.isArray(e)?e:e.match(/([^[.\]])+/g);r&&r.reduce((i,o,a)=>(i[o]===void 0&&(i[o]={}),a===r.length-1&&(i[o]=t),i[o]),n)};function Di(n,e){if(Vi(n)&&Vi(e)){const i=n.attributes,o=e.attributes;return i.length!==o.length?!1:Array.from(i).every(({name:a,value:s})=>e.getAttribute(a)===s)}if(n===e)return!0;if(n===null||typeof n!="object"||e===null||typeof e!="object")return!1;const t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(const i of t)if(!r.includes(i)||!Di(n[i],e[i]))return!1;return!0}function Ga(n,e){if(!Array.isArray(n)||!Array.isArray(e)||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!Di(n[t],e[t]))return!1;return!0}const $a=Number.parseInt(As.replace("dev","")),Sn={realistic:{shadows:!0,physicallyCorrectLights:!0,outputColorSpace:Os,toneMapping:Vs,toneMappingExposure:3,shadowMap:{enabled:!0,type:js}}};function Ka({scene:n,canvas:e,options:t,disableRender:r,contextParts:{sizes:i,camera:o}}){const a=ge(()=>({alpha:ce(t.alpha),depth:ce(t.depth),canvas:Re(e),context:ce(t.context),stencil:ce(t.stencil),antialias:ce(t.antialias)===void 0?!0:ce(t.antialias),precision:ce(t.precision),powerPreference:ce(t.powerPreference),premultipliedAlpha:ce(t.premultipliedAlpha),preserveDrawingBuffer:ce(t.preserveDrawingBuffer),logarithmicDepthBuffer:ce(t.logarithmicDepthBuffer),failIfMajorPerformanceCaveat:ce(t.failIfMajorPerformanceCaveat)})),s=St(new Jn(a.value));ye(a,()=>{s.value.dispose(),s.value=new Jn(a.value)}),_t(()=>{s.value.setSize(i.width.value,i.height.value)});const{pixelRatio:p}=Ma();_t(()=>{s.value.setPixelRatio(p.value)});const{logError:f}=cr(),_=(()=>{const b=new Jn,P={shadowMap:{enabled:b.shadowMap.enabled,type:b.shadowMap.type},toneMapping:b.toneMapping,toneMappingExposure:b.toneMappingExposure,outputColorSpace:b.outputColorSpace};return b.dispose(),P})();_t(()=>{const b=ce(t.preset);b&&(b in Sn||f(`Renderer Preset must be one of these: ${Object.keys(Sn).join(", ")}`),Oi(s.value,Sn[b]));const P=(S,L)=>{const T=ce(S),j=()=>{if(b)return ji(Sn[b],L)};if(T!==void 0)return T;const v=j();return v!==void 0?v:ji(_,L)},M=(S,L)=>Ha(s.value,L,P(S,L));M(t.shadows,"shadowMap.enabled"),M(t.toneMapping,"toneMapping"),M(t.shadowMapType,"shadowMap.type"),$a<150&&M(!t.useLegacyLights,"physicallyCorrectLights"),M(t.outputColorSpace,"outputColorSpace"),M(t.toneMappingExposure,"toneMappingExposure");const C=P(t.clearColor,"clearColor");C&&s.value.setClearColor(C?Ra(C):new lt(0))});const{pause:g,resume:E,onLoop:O}=At();return O(()=>{o.value&&!ce(r)&&s.value.render(n,o.value)}),E(),et(()=>{g(),s.value.dispose(),s.value.forceContextLoss()}),{renderer:s}}const Ii=n=>typeof n=="function",qa=(n,{renderer:e,camera:t,raycaster:r})=>{const i=ge(()=>e.value.domElement),{x:o,y:a}=Oa({target:i}),{width:s,height:p,top:f,left:_}=Sa(i),g=({x:y,y:c})=>{if(i.value)return{x:(y-_.value)/s.value*2-1,y:-((c-f.value)/p.value)*2+1}},E=({x:y,y:c})=>{if(t.value)return r.value.setFromCamera(new _e(y,c),t.value),r.value.intersectObjects(n.value,!1)},O=y=>{var d,u;const c=g({x:(d=y==null?void 0:y.clientX)!=null?d:o.value,y:(u=y==null?void 0:y.clientY)!=null?u:a.value});return c?E(c)||[]:[]},b=ge(()=>O()),P=$t(),M=$t(),C=(y,c)=>{y.trigger({event:c,intersects:O(c)})},S=y=>{C(M,y)};let L;const T=y=>{var c;L=(c=O(y)[0])==null?void 0:c.object},j=y=>{var c;y instanceof PointerEvent&&L===((c=O(y)[0])==null?void 0:c.object)&&C(P,y)},v=y=>M.trigger({event:y,intersects:[]});return i.value.addEventListener("pointerup",j),i.value.addEventListener("pointerdown",T),i.value.addEventListener("pointermove",S),i.value.addEventListener("pointerleave",v),et(()=>{i!=null&&i.value&&(i.value.removeEventListener("pointerup",j),i.value.removeEventListener("pointerdown",T),i.value.removeEventListener("pointermove",S),i.value.removeEventListener("pointerleave",v))}),{intersects:b,onClick:y=>P.on(y).off,onPointerMove:y=>M.on(y).off}},Wa=({scene:n,contextParts:e})=>{const t=la({click:new Map,pointerMove:new Map,pointerEnter:new Map,pointerLeave:new Map}),r=Y(new Set),i=E=>{r.value.add(E)},o=E=>{r.value.delete(E)},a=E=>{Object.values(t).forEach(O=>O.delete(E)),o(E)},s=E=>{const{onClick:O,onPointerMove:b,onPointerEnter:P,onPointerLeave:M}=E;O&&t.click.set(E,O),b&&t.pointerMove.set(E,b),P&&t.pointerEnter.set(E,P),M&&t.pointerLeave.set(E,M)};n.userData.tres__registerAtPointerEventHandler=s,n.userData.tres__deregisterAtPointerEventHandler=a,n.userData.tres__registerBlockingObjectAtPointerEventHandler=i,n.userData.tres__deregisterBlockingObjectAtPointerEventHandler=o;const p=ge(()=>za([...Array.from(r.value),...Object.values(t).map(E=>Array.from(E.keys())).flat()],({uuid:E})=>E)),{onClick:f,onPointerMove:_}=qa(p,e);f(({intersects:E,event:O})=>{var b;E.length&&((b=t.click.get(E[0].object))==null||b(E[0],O))});let g;return _(({intersects:E,event:O})=>{var b,P,M,C;const S=(b=E==null?void 0:E[0])==null?void 0:b.object,{pointerLeave:L,pointerEnter:T,pointerMove:j}=t;g&&g!==S&&((P=L.get(g))==null||P(g,O)),S&&(g!==S&&((M=T.get(S))==null||M(E[0],O)),(C=j.get(S))==null||C(E[0],O)),g=S||null}),{registerObject:s,deregisterObject:a}};function Ya(n){let e=0;return n.traverse(t=>{if(t.isMesh&&t.geometry){const r=t.geometry,i=r.attributes.position.count*3*Float32Array.BYTES_PER_ELEMENT,o=r.index?r.index.count*Uint32Array.BYTES_PER_ELEMENT:0,a=r.attributes.normal?r.attributes.normal.count*3*Float32Array.BYTES_PER_ELEMENT:0,s=r.attributes.uv?r.attributes.uv.count*2*Float32Array.BYTES_PER_ELEMENT:0;e+=i+o+a+s}}),e}const dr=Y({}),hr=n=>Object.assign(dr.value,n);function Xa({scene:n,canvas:e,windowSize:t,disableRender:r,rendererOptions:i}){const o=ge(()=>ce(t)?Va():Ta(ce(e).parentElement)),a=ge(()=>o.value.width.value),s=ge(()=>o.value.height.value),p=ge(()=>a.value/s.value),f={height:s,width:a,aspectRatio:p},_=St(n),{camera:g,cameras:E,registerCamera:O,deregisterCamera:b,setCameraActive:P}=ja({sizes:f,scene:n}),{renderer:M}=Ka({scene:n,canvas:e,options:i,contextParts:{sizes:f,camera:g},disableRender:r}),C={sizes:f,scene:_,camera:g,cameras:xi(E),renderer:M,raycaster:St(new Ts),controls:Y(null),perf:{maxFrames:160,fps:{value:0,accumulator:[]},memory:{currentMem:0,allocatedMem:0,accumulator:[]}},extend:hr,registerCamera:O,setCameraActive:P,deregisterCamera:b};sr("useTres",C);const S=100,L=La({every:S}),{isSupported:T,memory:j}=ka({interval:S}),v=160;let y=performance.now();const c=({timestamp:U})=>{C.scene.value&&(C.perf.memory.allocatedMem=Ya(C.scene.value)),U-y>=S&&(y=U,C.perf.fps.accumulator.push(L.value),C.perf.fps.accumulator.length>v&&C.perf.fps.accumulator.shift(),C.perf.fps.value=L.value,T.value&&j.value&&(C.perf.memory.accumulator.push(j.value.usedJSHeapSize/1024/1024),C.perf.memory.accumulator.length>v&&C.perf.memory.accumulator.shift(),C.perf.memory.currentMem=C.perf.memory.accumulator.reduce((B,D)=>B+D,0)/C.perf.memory.accumulator.length))};let d=0;const u=1,{pause:m,resume:k}=lr(({delta:U})=>{window.__TRES__DEVTOOLS__&&(c({timestamp:performance.now()}),d+=U,d>=u&&(window.__TRES__DEVTOOLS__.cb(C),d=0))},{immediate:!0});return et(()=>{m()}),C}function Wt(){const n=ua("useTres");if(!n)throw new Error("useTresContext must be used together with useTresContextProvider");return n}let he=null;const{logError:Bi}=cr(),Za={createElement(n,e,t,r){var i,o;if(r||(r={}),r.args||(r.args=[]),n==="template"||Ua(n))return null;let a=n.replace("Tres",""),s;if(n==="primitive"){(r==null?void 0:r.object)===void 0&&Bi("Tres primitives need a prop 'object'");const p=r.object;a=p.type,s=Object.assign(p,{type:a,attach:r.attach,primitive:!0})}else{const p=dr.value[a];p||Bi(`${a} is not defined on the THREE namespace. Use extend to add it to the catalog.`),s=new p(...r.args)}return s.isCamera&&(r!=null&&r.position||s.position.set(3,3,3),r!=null&&r.lookAt||s.lookAt(0,0,0)),(r==null?void 0:r.attach)===void 0&&(s.isMaterial?s.attach="material":s.isBufferGeometry&&(s.attach="geometry")),s.isObject3D&&((i=r==null?void 0:r.material)!=null&&i.isMaterial&&(s.userData.tres__materialViaProp=!0),(o=r==null?void 0:r.geometry)!=null&&o.isBufferGeometry&&(s.userData.tres__geometryViaProp=!0)),s.userData=Et(He({},s.userData),{tres__name:a}),s},insert(n,e){var t,r,i,o;e&&e.isScene&&(he=e);const a=e||he;if(n!=null&&n.isObject3D){if(n!=null&&n.isCamera){if(!(he!=null&&he.userData.tres__registerCamera))throw"could not find tres__registerCamera on scene's userData";(r=he==null?void 0:(t=he.userData).tres__registerCamera)==null||r.call(t,n)}if(n!=null&&n.onClick||n!=null&&n.onPointerMove||n!=null&&n.onPointerEnter||n!=null&&n.onPointerLeave){if(!(he!=null&&he.userData.tres__registerAtPointerEventHandler))throw"could not find tres__registerAtPointerEventHandler on scene's userData";(o=he==null?void 0:(i=he.userData).tres__registerAtPointerEventHandler)==null||o.call(i,n)}}n!=null&&n.isObject3D&&a!=null&&a.isObject3D?(a.add(n),n.dispatchEvent({type:"added"})):n!=null&&n.isFog?a.fog=n:typeof(n==null?void 0:n.attach)=="string"&&(n.__previousAttach=n[a==null?void 0:a.attach],a&&(a[n.attach]=n))},remove(n){var e,t;if(n){if(n.isObject3D){const r=n,i=f=>{var _,g;const E=f;f.userData.tres__materialViaProp||((_=E.material)==null||_.dispose(),E.material=void 0),f.userData.tres__geometryViaProp||((g=E.geometry)==null||g.dispose(),E.geometry=void 0)},o=he==null?void 0:he.userData.tres__deregisterAtPointerEventHandler,a=he==null?void 0:he.userData.tres__deregisterBlockingObjectAtPointerEventHandler,s=f=>{var _,g;if(!a)throw"could not find tres__deregisterBlockingObjectAtPointerEventHandler on scene's userData";if((g=he==null?void 0:(_=he.userData).tres__deregisterBlockingObjectAtPointerEventHandler)==null||g.call(_,f),!o)throw"could not find tres__deregisterAtPointerEventHandler on scene's userData";(f!=null&&f.onClick||f!=null&&f.onPointerMove||f!=null&&f.onPointerEnter||f!=null&&f.onPointerLeave)&&(o==null||o(f))},p=f=>{const _=he==null?void 0:he.userData.tres__deregisterCamera;if(!_)throw"could not find tres__deregisterCamera on scene's userData";f.isCamera&&(_==null||_(f))};(e=n.removeFromParent)==null||e.call(n),r.traverse(f=>{i(f),p(f),s==null||s(f)}),i(r),p(r),s==null||s(r)}(t=n.dispose)==null||t.call(n)}},patchProp(n,e,t,r){var i,o,a,s;if(n){let p=n,f=e;if(n.isObject3D&&f==="blocks-pointer-events"){r||r===""?(o=he==null?void 0:(i=he.userData).tres__registerBlockingObjectAtPointerEventHandler)==null||o.call(i,n):(s=he==null?void 0:(a=he.userData).tres__deregisterBlockingObjectAtPointerEventHandler)==null||s.call(a,n);return}let _=Mn(f),g=p==null?void 0:p[_];if(f==="args"){const O=n,b=t!=null?t:[],P=r!=null?r:[],M=n.userData.tres__name||n.type;M&&b.length&&!Ga(b,P)&&(p=Object.assign(O,new dr.value[M](...r)));return}if(p.type==="BufferGeometry"){if(f==="args")return;p.setAttribute(Mn(f),new Ds(...r));return}if(f.includes("-")&&g===void 0){const O=f.split("-");g=O.reduce((b,P)=>b[Mn(P)],p),f=O.pop(),_=f.toLowerCase(),g!=null&&g.set||(p=O.reduce((b,P)=>b[Mn(P)],p))}let E=r;if(E===""&&(E=!0),Ii(g)){Array.isArray(E)?n[_](...E):n[_](E);return}!(g!=null&&g.set)&&!Ii(g)?p[_]=E:g.constructor===E.constructor&&g!=null&&g.copy?g==null||g.copy(E):Array.isArray(E)?g.set(...E):!g.isColor&&g.setScalar?g.setScalar(E):g.set(E)}},parentNode(n){return(n==null?void 0:n.parent)||null},createText:()=>{},createComment:()=>{},setText:()=>{},setElementText:()=>{},nextSibling:()=>{},querySelector:()=>{},setScopeId:()=>{},cloneNode:()=>{},insertStaticContent:()=>{}},{render:Qa}=oa(Za);hr(Ls);const Ja=["data-scene"],el=Je({__name:"TresCanvas",props:{shadows:{type:Boolean,default:void 0},clearColor:{},toneMapping:{},shadowMapType:{},useLegacyLights:{type:Boolean,default:void 0},outputColorSpace:{},toneMappingExposure:{},camera:{},preset:{},windowSize:{type:Boolean,default:void 0},disableRender:{type:Boolean,default:void 0},context:{},precision:{},alpha:{type:Boolean,default:void 0},premultipliedAlpha:{type:Boolean},antialias:{type:Boolean,default:void 0},stencil:{type:Boolean,default:void 0},preserveDrawingBuffer:{type:Boolean,default:void 0},powerPreference:{},depth:{type:Boolean,default:void 0},logarithmicDepthBuffer:{type:Boolean,default:void 0},failIfMajorPerformanceCaveat:{type:Boolean,default:void 0}},setup(n,{expose:e}){var t;const r=n,{logWarning:i}=cr(),o=Y(),a=St(new Ms),{resume:s}=At(),p=Pi(),f=(t=xn())==null?void 0:t.appContext.app,_=P=>Je({setup(){var M;const C=(M=xn())==null?void 0:M.appContext;return C&&(C.app=f),sr("useTres",P),sr("extend",hr),()=>Ci(ca,null,p!=null&&p.default?p.default():[])}}),g=P=>{const M=_(P);Qa(Ci(M),a.value)},E=(P,M=!1)=>{a.value.children=[],M&&(P.renderer.value.dispose(),P.renderer.value.renderLists.dispose(),P.renderer.value.forceContextLoss()),g(P),s()},O=ge(()=>r.disableRender),b=St(null);return e({context:b,dispose:()=>E(b.value,!0)}),ir(()=>{const P=o;b.value=Xa({scene:a.value,canvas:P,windowSize:r.windowSize,disableRender:O,rendererOptions:r}),Wa({scene:a.value,contextParts:b.value});const{registerCamera:M,camera:C,cameras:S,deregisterCamera:L}=b.value;g(b.value);const T=()=>{const j=new Ge(45,window.innerWidth/window.innerHeight,.1,1e3);j.position.set(3,3,3),j.lookAt(0,0,0),M(j);const v=_t(()=>{S.value.length>=2&&(j.removeFromParent(),L(j),v==null||v())})};ye(()=>r.camera,(j,v)=>{j&&M(j),v&&(v.removeFromParent(),L(v))},{immediate:!0}),C.value||(i("No camera found. Creating a default perspective camera. To have full control over a camera, please add one to the scene."),T())}),(P,M)=>(Tt(),Lt("canvas",{ref_key:"canvas",ref:o,"data-scene":a.value.uuid,class:sa(P.$attrs.class),style:aa(He({display:"block",width:"100%",height:"100%",position:P.windowSize?"fixed":"relative",top:0,left:0,pointerEvents:"auto",touchAction:"none"},P.$attrs.style))},null,14,Ja))}});/*! Tweakpane 4.0.3 (c) 2016 cocopon, licensed under the MIT license. */function Fe(n){return n}function de(n){return n==null}function pr(n){return n!==null&&typeof n=="object"}function mr(n){return n!==null&&typeof n=="object"}function tl(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function yt(n,e){return Array.from(new Set([...Object.keys(n),...Object.keys(e)])).reduce((r,i)=>{const o=n[i],a=e[i];return mr(o)&&mr(a)?Object.assign(Object.assign({},r),{[i]:yt(o,a)}):Object.assign(Object.assign({},r),{[i]:i in e?a:o})},{})}function nl(n){return pr(n)?"target"in n:!1}const rl={alreadydisposed:()=>"View has been already disposed",invalidparams:n=>`Invalid parameters for '${n.name}'`,nomatchingcontroller:n=>`No matching controller for '${n.key}'`,nomatchingview:n=>`No matching view for '${JSON.stringify(n.params)}'`,notbindable:()=>"Value is not bindable",notcompatible:n=>`Not compatible with  plugin '${n.id}'`,propertynotfound:n=>`Property '${n.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class Ae{static alreadyDisposed(){return new Ae({type:"alreadydisposed"})}static notBindable(){return new Ae({type:"notbindable"})}static notCompatible(e,t){return new Ae({type:"notcompatible",context:{id:`${e}.${t}`}})}static propertyNotFound(e){return new Ae({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new Ae({type:"shouldneverhappen"})}constructor(e){var t;this.message=(t=rl[e.type](Fe(e.context)))!==null&&t!==void 0?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}toString(){return this.message}}class Tn{constructor(e,t){this.obj_=e,this.key=t}static isBindable(e){return!(e===null||typeof e!="object"&&typeof e!="function")}read(){return this.obj_[this.key]}write(e){this.obj_[this.key]=e}writeProperty(e,t){const r=this.read();if(!Tn.isBindable(r))throw Ae.notBindable();if(!(e in r))throw Ae.propertyNotFound(e);r[e]=t}}class Oe{constructor(){this.observers_={}}on(e,t,r){var i;let o=this.observers_[e];return o||(o=this.observers_[e]=[]),o.push({handler:t,key:(i=r==null?void 0:r.key)!==null&&i!==void 0?i:t}),this}off(e,t){const r=this.observers_[e];return r&&(this.observers_[e]=r.filter(i=>i.key!==t)),this}emit(e,t){const r=this.observers_[e];!r||r.forEach(i=>{i.handler(t)})}}class il{constructor(e,t){var r;this.constraint_=t==null?void 0:t.constraint,this.equals_=(r=t==null?void 0:t.equals)!==null&&r!==void 0?r:(i,o)=>i===o,this.emitter=new Oe,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const r=t!=null?t:{forceEmit:!1,last:!0},i=this.constraint_?this.constraint_.constrain(e):e,o=this.rawValue_;!!this.equals_(o,i)&&!r.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=i,this.emitter.emit("change",{options:r,previousRawValue:o,rawValue:i,sender:this}))}}class ol{constructor(e){this.emitter=new Oe,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const r=t!=null?t:{forceEmit:!1,last:!0},i=this.value_;i===e&&!r.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:r,previousRawValue:i,rawValue:this.value_,sender:this}))}}class sl{constructor(e){this.emitter=new Oe,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=e,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}}function be(n,e){const t=e==null?void 0:e.constraint,r=e==null?void 0:e.equals;return!t&&!r?new ol(n):new il(n,e)}function al(n){return[new sl(n),(e,t)=>{n.setRawValue(e,t)}]}class J{constructor(e){this.emitter=new Oe,this.valMap_=e;for(const t in this.valMap_)this.valMap_[t].emitter.on("change",()=>{this.emitter.emit("change",{key:t,sender:this})})}static createCore(e){return Object.keys(e).reduce((r,i)=>Object.assign(r,{[i]:be(e[i])}),{})}static fromObject(e){const t=this.createCore(e);return new J(t)}get(e){return this.valMap_[e].rawValue}set(e,t){this.valMap_[e].rawValue=t}value(e){return this.valMap_[e]}}class Ln{constructor(e){this.values=J.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),r=this.values.get("min");return Math.min(Math.max(e,r),t)}}class ll{constructor(e){this.values=J.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),r=this.values.get("min");let i=e;return de(r)||(i=Math.max(i,r)),de(t)||(i=Math.min(i,t)),i}}class ul{constructor(e,t=0){this.step=e,this.origin=t}constrain(e){const t=this.origin%this.step,r=Math.round((e-t)/this.step);return t+r*this.step}}class cl{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}}const dl={"**":(n,e)=>Math.pow(n,e),"*":(n,e)=>n*e,"/":(n,e)=>n/e,"%":(n,e)=>n%e,"+":(n,e)=>n+e,"-":(n,e)=>n-e,"<<":(n,e)=>n<<e,">>":(n,e)=>n>>e,">>>":(n,e)=>n>>>e,"&":(n,e)=>n&e,"^":(n,e)=>n^e,"|":(n,e)=>n|e};class hl{constructor(e,t,r){this.left=t,this.operator=e,this.right=r}evaluate(){const e=dl[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const pl={"+":n=>n,"-":n=>-n,"~":n=>~n};class ml{constructor(e,t){this.operator=e,this.expression=t}evaluate(){const e=pl[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function fr(n){return(e,t)=>{for(let r=0;r<n.length;r++){const i=n[r](e,t);if(i!=="")return i}return""}}function Yt(n,e){var t;const r=n.substr(e).match(/^\s+/);return(t=r&&r[0])!==null&&t!==void 0?t:""}function fl(n,e){const t=n.substr(e,1);return t.match(/^[1-9]$/)?t:""}function Xt(n,e){var t;const r=n.substr(e).match(/^[0-9]+/);return(t=r&&r[0])!==null&&t!==void 0?t:""}function vl(n,e){const t=Xt(n,e);if(t!=="")return t;const r=n.substr(e,1);if(e+=1,r!=="-"&&r!=="+")return"";const i=Xt(n,e);return i===""?"":r+i}function vr(n,e){const t=n.substr(e,1);if(e+=1,t.toLowerCase()!=="e")return"";const r=vl(n,e);return r===""?"":t+r}function Ri(n,e){const t=n.substr(e,1);if(t==="0")return t;const r=fl(n,e);return e+=r.length,r===""?"":r+Xt(n,e)}function gl(n,e){const t=Ri(n,e);if(e+=t.length,t==="")return"";const r=n.substr(e,1);if(e+=r.length,r!==".")return"";const i=Xt(n,e);return e+=i.length,t+r+i+vr(n,e)}function wl(n,e){const t=n.substr(e,1);if(e+=t.length,t!==".")return"";const r=Xt(n,e);return e+=r.length,r===""?"":t+r+vr(n,e)}function bl(n,e){const t=Ri(n,e);return e+=t.length,t===""?"":t+vr(n,e)}const _l=fr([gl,wl,bl]);function yl(n,e){var t;const r=n.substr(e).match(/^[01]+/);return(t=r&&r[0])!==null&&t!==void 0?t:""}function xl(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0b")return"";const r=yl(n,e);return r===""?"":t+r}function Pl(n,e){var t;const r=n.substr(e).match(/^[0-7]+/);return(t=r&&r[0])!==null&&t!==void 0?t:""}function Cl(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0o")return"";const r=Pl(n,e);return r===""?"":t+r}function El(n,e){var t;const r=n.substr(e).match(/^[0-9a-f]+/i);return(t=r&&r[0])!==null&&t!==void 0?t:""}function Ml(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0x")return"";const r=El(n,e);return r===""?"":t+r}const Sl=fr([xl,Cl,Ml]),Tl=fr([Sl,_l]);function Ll(n,e){const t=Tl(n,e);return e+=t.length,t===""?null:{evaluable:new cl(t),cursor:e}}function kl(n,e){const t=n.substr(e,1);if(e+=t.length,t!=="(")return null;const r=Ui(n,e);if(!r)return null;e=r.cursor,e+=Yt(n,e).length;const i=n.substr(e,1);return e+=i.length,i!==")"?null:{evaluable:r.evaluable,cursor:e}}function Al(n,e){var t;return(t=Ll(n,e))!==null&&t!==void 0?t:kl(n,e)}function Fi(n,e){const t=Al(n,e);if(t)return t;const r=n.substr(e,1);if(e+=r.length,r!=="+"&&r!=="-"&&r!=="~")return null;const i=Fi(n,e);return i?(e=i.cursor,{cursor:e,evaluable:new ml(r,i.evaluable)}):null}function Ol(n,e,t){t+=Yt(e,t).length;const r=n.filter(i=>e.startsWith(i,t))[0];return r?(t+=r.length,t+=Yt(e,t).length,{cursor:t,operator:r}):null}function Vl(n,e){return(t,r)=>{const i=n(t,r);if(!i)return null;r=i.cursor;let o=i.evaluable;for(;;){const a=Ol(e,t,r);if(!a)break;r=a.cursor;const s=n(t,r);if(!s)return null;r=s.cursor,o=new hl(a.operator,o,s.evaluable)}return o?{cursor:r,evaluable:o}:null}}const jl=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((n,e)=>Vl(n,e),Fi);function Ui(n,e){return e+=Yt(n,e).length,jl(n,e)}function Dl(n){const e=Ui(n,0);return!e||e.cursor+Yt(n,e.cursor).length!==n.length?null:e.evaluable}function ct(n){var e;const t=Dl(n);return(e=t==null?void 0:t.evaluate())!==null&&e!==void 0?e:null}function Ni(n){if(typeof n=="number")return n;if(typeof n=="string"){const e=ct(n);if(!de(e))return e}return 0}function Ee(n){return e=>e.toFixed(Math.max(Math.min(n,20),0))}function ne(n,e,t,r,i){const o=(n-e)/(t-e);return r+o*(i-r)}function zi(n){return String(n.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function we(n,e,t){return Math.min(Math.max(n,e),t)}function Hi(n,e){return(n%e+e)%e}function Il(n,e){return de(n.step)?Math.max(zi(e),2):zi(n.step)}function Gi(n){var e;return(e=n.step)!==null&&e!==void 0?e:1}function Bl(n,e){var t;const r=Math.abs((t=n.step)!==null&&t!==void 0?t:e);return r===0?.1:Math.pow(10,Math.floor(Math.log10(r))-1)}function $i(n,e){return de(n.step)?null:new ul(n.step,e)}function Ki(n){return!de(n.max)&&!de(n.min)?new Ln({max:n.max,min:n.min}):!de(n.max)||!de(n.min)?new ll({max:n.max,min:n.min}):null}function qi(n,e){var t,r,i;return{formatter:(t=n.format)!==null&&t!==void 0?t:Ee(Il(n,e)),keyScale:(r=n.keyScale)!==null&&r!==void 0?r:Gi(n),pointerScale:(i=n.pointerScale)!==null&&i!==void 0?i:Bl(n,e)}}function Wi(n){return{format:n.optional.function,keyScale:n.optional.number,max:n.optional.number,min:n.optional.number,pointerScale:n.optional.number,step:n.optional.number}}function gr(n){return{constraint:n.constraint,textProps:J.fromObject(qi(n.params,n.initialValue))}}class wr{constructor(e){this.controller=e}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(e){this.controller.viewProps.set("disabled",e)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(e){this.controller.viewProps.set("hidden",e)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(e){return this.controller.importState(e)}exportState(){return this.controller.exportState()}}class kn{constructor(e){this.target=e}}class Yi extends kn{constructor(e,t,r){super(e);this.value=t,this.last=r!=null?r:!0}}class Rl extends kn{constructor(e,t){super(e);this.expanded=t}}class Fl extends kn{constructor(e,t){super(e);this.index=t}}class Ul extends kn{constructor(e,t){super(e);this.native=t}}class br extends wr{constructor(e){super(e);this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new Oe,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(e){this.controller.tag=e}on(e,t){const r=t.bind(this);return this.emitter_.on(e,i=>{r(i)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}refresh(){this.controller.value.fetch()}onValueChange_(e){const t=this.controller.value;this.emitter_.emit("change",new Yi(this,Fe(t.binding.target.read()),e.options.last))}}function Nl(n,e){const r=Object.keys(e).reduce((i,o)=>{if(i===void 0)return;const s=e[o](n[o]);return s.succeeded?Object.assign(Object.assign({},i),{[o]:s.value}):void 0},{});return Fe(r)}function zl(n,e){return n.reduce((t,r)=>{if(t===void 0)return;const i=e(r);if(!(!i.succeeded||i.value===void 0))return[...t,i.value]},[])}function Hl(n){return n===null?!1:typeof n=="object"}function rt(n){return e=>t=>{if(!e&&t===void 0)return{succeeded:!1,value:void 0};if(e&&t===void 0)return{succeeded:!0,value:void 0};const r=n(t);return r!==void 0?{succeeded:!0,value:r}:{succeeded:!1,value:void 0}}}function Xi(n){return{custom:e=>rt(e)(n),boolean:rt(e=>typeof e=="boolean"?e:void 0)(n),number:rt(e=>typeof e=="number"?e:void 0)(n),string:rt(e=>typeof e=="string"?e:void 0)(n),function:rt(e=>typeof e=="function"?e:void 0)(n),constant:e=>rt(t=>t===e?e:void 0)(n),raw:rt(e=>e)(n),object:e=>rt(t=>{if(!!Hl(t))return Nl(t,e)})(n),array:e=>rt(t=>{if(!!Array.isArray(t))return zl(t,e)})(n)}}const _r={optional:Xi(!0),required:Xi(!1)};function xe(n,e){const t=e(_r),r=_r.required.object(t)(n);return r.succeeded?r.value:void 0}function $e(n,e,t,r){if(e&&!e(n))return!1;const i=xe(n,t);return i?r(i):!1}function Ke(n,e){var t;return yt((t=n==null?void 0:n())!==null&&t!==void 0?t:{},e)}function An(n){return"value"in n}function Gl(n){if(!pr(n)||!("binding"in n))return!1;const e=n.binding;return nl(e)}const qe="http://www.w3.org/2000/svg";function On(n){n.offsetHeight}function $l(n,e){const t=n.style.transition;n.style.transition="none",e(),n.style.transition=t}function yr(n){return n.ontouchstart!==void 0}function Kl(n){const e=n.ownerDocument.defaultView;return e&&"document"in e?n.getContext("2d",{willReadFrequently:!0}):null}const ql={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function Vn(n,e){const t=n.createElementNS(qe,"svg");return t.innerHTML=ql[e],t}function Zi(n,e,t){n.insertBefore(e,n.children[t])}function xr(n){n.parentElement&&n.parentElement.removeChild(n)}function Qi(n){for(;n.children.length>0;)n.removeChild(n.children[0])}function Wl(n){for(;n.childNodes.length>0;)n.removeChild(n.childNodes[0])}function Ji(n){return n.relatedTarget?Fe(n.relatedTarget):"explicitOriginalTarget"in n?n.explicitOriginalTarget:null}function it(n,e){n.emitter.on("change",t=>{e(t.rawValue)}),e(n.rawValue)}function We(n,e,t){it(n.value(e),t)}const Yl="tp";function ee(n){return(t,r)=>[Yl,"-",n,"v",t?`_${t}`:"",r?`-${r}`:""].join("")}const Zt=ee("lbl");function Xl(n,e){const t=n.createDocumentFragment();return e.split(`
`).map(i=>n.createTextNode(i)).forEach((i,o)=>{o>0&&t.appendChild(n.createElement("br")),t.appendChild(i)}),t}class Zl{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Zt()),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("div");r.classList.add(Zt("l")),We(t.props,"label",o=>{de(o)?this.element.classList.add(Zt(void 0,"nol")):(this.element.classList.remove(Zt(void 0,"nol")),Wl(r),r.appendChild(Xl(e,o)))}),this.element.appendChild(r),this.labelElement=r;const i=e.createElement("div");i.classList.add(Zt("v")),this.element.appendChild(i),this.valueElement=i}}class Ql{constructor(e,t){this.props=t.props,this.valueController=t.valueController,this.viewProps=t.valueController.viewProps,this.view=new Zl(e,{props:t.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(e){return $e(e,null,t=>({label:t.optional.string}),t=>(this.props.set("label",t.label),!0))}exportProps(){return Ke(null,{label:this.props.get("label")})}}function Jl(){return["veryfirst","first","last","verylast"]}const eo=ee(""),to={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class no{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const t=this.view.element;this.blade.value("positions").emitter.on("change",()=>{Jl().forEach(r=>{t.classList.remove(eo(void 0,to[r]))}),this.blade.get("positions").forEach(r=>{t.classList.add(eo(void 0,to[r]))})}),this.viewProps.handleDispose(()=>{xr(t)})}get parent(){return this.parent_}set parent(e){this.parent_=e,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(e){return $e(e,null,t=>({disabled:t.required.boolean,hidden:t.required.boolean}),t=>(this.viewProps.importState(t),!0))}exportState(){return Ke(null,Object.assign({},this.viewProps.exportState()))}}class eu extends wr{get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get title(){var e;return(e=this.controller.buttonController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.buttonController.props.set("title",e)}on(e,t){const r=t.bind(this);return this.controller.buttonController.emitter.on(e,o=>{r(new Ul(this,o.nativeEvent))}),this}off(e,t){return this.controller.buttonController.emitter.off(e,t),this}}function tu(n,e,t){t?n.classList.add(e):n.classList.remove(e)}function Ot(n,e){return t=>{tu(n,e,t)}}function Pr(n,e){it(n,t=>{e.textContent=t!=null?t:""})}const Cr=ee("btn");class nu{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Cr()),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("button");r.classList.add(Cr("b")),t.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r;const i=e.createElement("div");i.classList.add(Cr("t")),Pr(t.props.value("title"),i),this.buttonElement.appendChild(i)}}class ru{constructor(e,t){this.emitter=new Oe,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new nu(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(e){return $e(e,null,t=>({title:t.optional.string}),t=>(this.props.set("title",t.title),!0))}exportProps(){return Ke(null,{title:this.props.get("title")})}onClick_(e){this.emitter.emit("click",{nativeEvent:e,sender:this})}}class ro extends no{constructor(e,t){const r=new ru(e,{props:t.buttonProps,viewProps:t.viewProps}),i=new Ql(e,{blade:t.blade,props:t.labelProps,valueController:r});super({blade:t.blade,view:i.view,viewProps:t.viewProps});this.buttonController=r,this.labelController=i}importState(e){return $e(e,t=>super.importState(t)&&this.buttonController.importProps(t)&&this.labelController.importProps(t),()=>({}),()=>!0)}exportState(){return Ke(()=>super.exportState(),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}}class io{constructor(e){const[t,r]=e.split("-"),i=t.split(".");this.major=parseInt(i[0],10),this.minor=parseInt(i[1],10),this.patch=parseInt(i[2],10),this.prerelease=r!=null?r:null}toString(){const e=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[e,this.prerelease].join("-"):e}}const iu=new io("2.0.3");function Pe(n){return Object.assign({core:iu},n)}Pe({id:"button",type:"blade",accept(n){const e=xe(n,t=>({title:t.required.string,view:t.required.constant("button"),label:t.optional.string}));return e?{params:e}:null},controller(n){return new ro(n.document,{blade:n.blade,buttonProps:J.fromObject({title:n.params.title}),labelProps:J.fromObject({label:n.params.label}),viewProps:n.viewProps})},api(n){return n.controller instanceof ro?new eu(n.controller):null}});function ou(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function su(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function au(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}function lu(n){return pr(n)?"refresh"in n&&typeof n.refresh=="function":!1}function uu(n,e){if(!Tn.isBindable(n))throw Ae.notBindable();return new Tn(n,e)}class cu{constructor(e,t){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=e,this.emitter_=new Oe,this.pool_=t,this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map(e=>this.pool_.createApi(e))}addBinding(e,t,r){const i=r!=null?r:{},o=this.controller_.element.ownerDocument,a=this.pool_.createBinding(o,uu(e,t),i),s=this.pool_.createBindingApi(a);return this.add(s,i.index)}addFolder(e){return su(this,e)}addButton(e){return ou(this,e)}addTab(e){return au(this,e)}add(e,t){const r=e.controller;return this.controller_.rack.add(r,t),e}remove(e){this.controller_.rack.remove(e.controller)}addBlade(e){const t=this.controller_.element.ownerDocument,r=this.pool_.createBlade(t,e),i=this.pool_.createApi(r);return this.add(i,e.index)}on(e,t){const r=t.bind(this);return this.emitter_.on(e,i=>{r(i)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}refresh(){this.children.forEach(e=>{lu(e)&&e.refresh()})}onRackValueChange_(e){const t=e.bladeController,r=this.pool_.createApi(t),i=Gl(t.value)?t.value.binding:null;this.emitter_.emit("change",new Yi(r,i?i.target.read():t.value.rawValue,e.options.last))}}class Er extends wr{constructor(e,t){super(e);this.rackApi_=new cu(e.rackController,t)}refresh(){this.rackApi_.refresh()}}class Mr extends no{constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps});this.rackController=e.rackController}importState(e){return $e(e,t=>super.importState(t),t=>({children:t.required.array(t.required.raw)}),t=>this.rackController.rack.children.every((r,i)=>r.importState(t.children[i])))}exportState(){return Ke(()=>super.exportState(),{children:this.rackController.rack.children.map(e=>e.exportState())})}}function Sr(n){return"rackController"in n}class du{constructor(e){this.emitter=new Oe,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const t of this.allItems())if(e(t))return t;return null}includes(e){return this.cache_.has(e)}add(e,t){if(this.includes(e))throw Ae.shouldNeverHappen();const r=t!==void 0?t:this.items_.length;this.items_.splice(r,0,e),this.cache_.add(e);const i=this.extract_(e);i&&(i.emitter.on("add",this.onSubListAdd_),i.emitter.on("remove",this.onSubListRemove_),i.allItems().forEach(o=>{this.cache_.add(o)})),this.emitter.emit("add",{index:r,item:e,root:this,target:this})}remove(e){const t=this.items_.indexOf(e);if(t<0)return;this.items_.splice(t,1),this.cache_.delete(e);const r=this.extract_(e);r&&(r.allItems().forEach(i=>{this.cache_.delete(i)}),r.emitter.off("add",this.onSubListAdd_),r.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:t,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}}function hu(n,e){for(let t=0;t<n.length;t++){const r=n[t];if(An(r)&&r.value===e)return r}return null}function pu(n){return Sr(n)?n.rackController.rack.bcSet_:null}class mu{constructor(e){var t,r;this.emitter=new Oe,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=(t=e.blade)!==null&&t!==void 0?t:null,(r=this.blade_)===null||r===void 0||r.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=e.viewProps,this.bcSet_=new du(pu),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,t){var r;(r=e.parent)===null||r===void 0||r.remove(e),e.parent=this,this.bcSet_.add(e,t)}remove(e){e.parent=null,this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter(e)}onSetAdd_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,root:t,sender:this}),!t)return;const r=e.item;if(r.viewProps.emitter.on("change",this.onChildViewPropsChange_),r.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),r.viewProps.handleDispose(this.onChildDispose_),An(r))r.value.emitter.on("change",this.onChildValueChange_);else if(Sr(r)){const i=r.rackController.rack;if(i){const o=i.emitter;o.on("layout",this.onRackLayout_),o.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,root:t,sender:this}),!t)return;const r=e.item;if(An(r))r.value.emitter.off("change",this.onChildValueChange_);else if(Sr(r)){const i=r.rackController.rack;if(i){const o=i.emitter;o.off("layout",this.onRackLayout_),o.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){const e=this.bcSet_.items.filter(i=>!i.viewProps.get("hidden")),t=e[0],r=e[e.length-1];this.bcSet_.items.forEach(i=>{const o=[];i===t&&(o.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&o.push("veryfirst")),i===r&&(o.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&o.push("verylast")),i.blade.set("positions",o)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(t=>t.viewProps.get("disposed")).forEach(t=>{this.bcSet_.remove(t)})}onChildValueChange_(e){const t=hu(this.find(An),e.sender);if(!t)throw Ae.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:t,options:e.options,sender:this})}onRackLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(e){this.emitter.emit("valuechange",{bladeController:e.bladeController,options:e.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class Tr{constructor(e){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=e.element,this.viewProps=e.viewProps;const t=new mu({blade:e.root?void 0:e.blade,viewProps:e.viewProps});t.emitter.on("add",this.onRackAdd_),t.emitter.on("remove",this.onRackRemove_),this.rack=t,this.viewProps.handleDispose(()=>{for(let r=this.rack.children.length-1;r>=0;r--)this.rack.children[r].viewProps.set("disposed",!0)})}onRackAdd_(e){!e.root||Zi(this.element,e.bladeController.view.element,e.index)}onRackRemove_(e){!e.root||xr(e.bladeController.view.element)}}function oo(){return new J({positions:be([],{equals:tl})})}class Qt extends J{constructor(e){super(e)}static create(e){const t={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},r=J.createCore(t);return new Qt(r)}get styleExpanded(){var e;return(e=this.get("temporaryExpanded"))!==null&&e!==void 0?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!de(e)?`${e}px`:"auto"}bindExpandedClass(e,t){const r=()=>{this.styleExpanded?e.classList.add(t):e.classList.remove(t)};We(this,"expanded",r),We(this,"temporaryExpanded",r)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function fu(n,e){let t=0;return $l(e,()=>{n.set("expandedHeight",null),n.set("temporaryExpanded",!0),On(e),t=e.clientHeight,n.set("temporaryExpanded",null),On(e)}),t}function so(n,e){e.style.height=n.styleHeight}function Lr(n,e){n.value("expanded").emitter.on("beforechange",()=>{if(n.set("completed",!1),de(n.get("expandedHeight"))){const t=fu(n,e);t>0&&n.set("expandedHeight",t)}n.set("shouldFixHeight",!0),On(e)}),n.emitter.on("change",()=>{so(n,e)}),so(n,e),e.addEventListener("transitionend",t=>{t.propertyName==="height"&&n.cleanUpTransition()})}class vu extends Er{constructor(e,t){super(e,t);this.emitter_=new Oe,this.controller.foldable.value("expanded").emitter.on("change",r=>{this.emitter_.emit("fold",new Rl(this,r.sender.rawValue))}),this.rackApi_.on("change",r=>{this.emitter_.emit("change",r)})}get expanded(){return this.controller.foldable.get("expanded")}set expanded(e){this.controller.foldable.set("expanded",e)}get title(){return this.controller.props.get("title")}set title(e){this.controller.props.set("title",e)}get children(){return this.rackApi_.children}addBinding(e,t,r){return this.rackApi_.addBinding(e,t,r)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){return this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,t){const r=t.bind(this);return this.emitter_.on(e,i=>{r(i)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}}const ao=ee("cnt");class gu{constructor(e,t){var r;this.className_=ee((r=t.viewName)!==null&&r!==void 0?r:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),ao()),t.viewProps.bindClassModifiers(this.element),this.foldable_=t.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),We(this.foldable_,"completed",Ot(this.element,this.className_(void 0,"cpl")));const i=e.createElement("button");i.classList.add(this.className_("b")),We(t.props,"title",f=>{de(f)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const o=e.createElement("div");o.classList.add(this.className_("i")),this.element.appendChild(o);const a=e.createElement("div");a.classList.add(this.className_("t")),Pr(t.props.value("title"),a),this.buttonElement.appendChild(a),this.titleElement=a;const s=e.createElement("div");s.classList.add(this.className_("m")),this.buttonElement.appendChild(s);const p=e.createElement("div");p.classList.add(this.className_("c")),this.element.appendChild(p),this.containerElement=p}}class lo extends Mr{constructor(e,t){var r;const i=Qt.create((r=t.expanded)!==null&&r!==void 0?r:!0),o=new gu(e,{foldable:i,props:t.props,viewName:t.root?"rot":void 0,viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new Tr({blade:t.blade,element:o.containerElement,root:t.root,viewProps:t.viewProps}),view:o}));this.onTitleClick_=this.onTitleClick_.bind(this),this.props=t.props,this.foldable=i,Lr(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(e){return $e(e,t=>super.importState(t),t=>({expanded:t.required.boolean,title:t.optional.string}),t=>(this.foldable.set("expanded",t.expanded),this.props.set("title",t.title),!0))}exportState(){return Ke(()=>super.exportState(),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}Pe({id:"folder",type:"blade",accept(n){const e=xe(n,t=>({title:t.required.string,view:t.required.constant("folder"),expanded:t.optional.boolean}));return e?{params:e}:null},controller(n){return new lo(n.document,{blade:n.blade,expanded:n.params.expanded,props:J.fromObject({title:n.params.title}),viewProps:n.viewProps})},api(n){return n.controller instanceof lo?new vu(n.controller,n.pool):null}});const wu=ee("");function uo(n,e){return Ot(n,wu(void 0,e))}class Jt extends J{constructor(e){var t;super(e);this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=al(be(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(e){var t,r,i;const o=e!=null?e:{};return new Jt(J.createCore({disabled:(t=o.disabled)!==null&&t!==void 0?t:!1,disposed:!1,hidden:(r=o.hidden)!==null&&r!==void 0?r:!1,parent:(i=o.parent)!==null&&i!==void 0?i:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(e){it(this.globalDisabled_,uo(e,"disabled")),We(this,"hidden",uo(e,"hidden"))}bindDisabled(e){it(this.globalDisabled_,t=>{e.disabled=t})}bindTabIndex(e){it(this.globalDisabled_,t=>{e.tabIndex=t?-1:0})}handleDispose(e){this.value("disposed").emitter.on("change",t=>{t&&e()})}importState(e){this.set("disabled",e.disabled),this.set("hidden",e.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){const e=this.get("parent");return(e?e.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(e){var t;const r=e.previousRawValue;r==null||r.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}const co=ee("tbp");class bu{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(co()),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("div");r.classList.add(co("c")),this.element.appendChild(r),this.containerElement=r}}const en=ee("tbi");class _u{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(en()),t.viewProps.bindClassModifiers(this.element),We(t.props,"selected",o=>{o?this.element.classList.add(en(void 0,"sel")):this.element.classList.remove(en(void 0,"sel"))});const r=e.createElement("button");r.classList.add(en("b")),t.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r;const i=e.createElement("div");i.classList.add(en("t")),Pr(t.props.value("title"),i),this.buttonElement.appendChild(i),this.titleElement=i}}class yu{constructor(e,t){this.emitter=new Oe,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new _u(e,{props:t.props,viewProps:t.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class kr extends Mr{constructor(e,t){const r=new bu(e,{viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new Tr({blade:t.blade,element:r.containerElement,viewProps:t.viewProps}),view:r}));this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new yu(e,{props:t.itemProps,viewProps:Jt.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=t.props,We(this.props,"selected",i=>{this.itemController.props.set("selected",i),this.viewProps.set("hidden",!i)})}get itemController(){return this.ic_}importState(e){return $e(e,t=>super.importState(t),t=>({selected:t.required.boolean,title:t.required.string}),t=>(this.ic_.props.set("selected",t.selected),this.ic_.props.set("title",t.title),!0))}exportState(){return Ke(()=>super.exportState(),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}}class xu extends Er{constructor(e,t){super(e,t);this.emitter_=new Oe,this.onSelect_=this.onSelect_.bind(this),this.pool_=t,this.rackApi_.on("change",r=>{this.emitter_.emit("change",r)}),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(e){const t=this.controller.view.element.ownerDocument,r=new kr(t,{blade:oo(),itemProps:J.fromObject({selected:!1,title:e.title}),props:J.fromObject({selected:!1}),viewProps:Jt.create()}),i=this.pool_.createApi(r);return this.rackApi_.add(i,e.index)}removePage(e){this.rackApi_.remove(this.rackApi_.children[e])}on(e,t){const r=t.bind(this);return this.emitter_.on(e,i=>{r(i)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}onSelect_(e){this.emitter_.emit("select",new Fl(this,e.rawValue))}}class Pu extends Er{get title(){var e;return(e=this.controller.itemController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.itemController.props.set("title",e)}get selected(){return this.controller.props.get("selected")}set selected(e){this.controller.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBinding(e,t,r){return this.rackApi_.addBinding(e,t,r)}addBlade(e){return this.rackApi_.addBlade(e)}}const ho=-1;class Cu{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=be(!0),this.selectedIndex=be(ho),this.items_=[]}add(e,t){const r=t!=null?t:this.items_.length;this.items_.splice(r,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(e){const t=this.items_.indexOf(e);t<0||(this.items_.splice(t,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=ho,this.empty.rawValue=!0;return}const e=this.items_.findIndex(t=>t.rawValue);e<0?(this.items_.forEach((t,r)=>{t.rawValue=r===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((t,r)=>{t.rawValue=r===e}),this.selectedIndex.rawValue=e),this.empty.rawValue=!1}onItemSelectedChange_(e){if(e.rawValue){const t=this.items_.findIndex(r=>r===e.sender);this.items_.forEach((r,i)=>{r.rawValue=i===t}),this.selectedIndex.rawValue=t}else this.keepSelection_()}}const tn=ee("tab");class Eu{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(tn(),ao()),t.viewProps.bindClassModifiers(this.element),it(t.empty,Ot(this.element,tn(void 0,"nop")));const r=e.createElement("div");r.classList.add(tn("t")),this.element.appendChild(r),this.itemsElement=r;const i=e.createElement("div");i.classList.add(tn("i")),this.element.appendChild(i);const o=e.createElement("div");o.classList.add(tn("c")),this.element.appendChild(o),this.contentsElement=o}}class po extends Mr{constructor(e,t){const r=new Cu,i=new Eu(e,{empty:r.empty,viewProps:t.viewProps});super({blade:t.blade,rackController:new Tr({blade:t.blade,element:i.contentsElement,viewProps:t.viewProps}),view:i});this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const o=this.rackController.rack;o.emitter.on("add",this.onRackAdd_),o.emitter.on("remove",this.onRackRemove_),this.tab=r}add(e,t){this.rackController.rack.add(e,t)}remove(e){this.rackController.rack.remove(this.rackController.rack.children[e])}onRackAdd_(e){if(!e.root)return;const t=e.bladeController;Zi(this.view.itemsElement,t.itemController.view.element,e.index),t.itemController.viewProps.set("parent",this.viewProps),this.tab.add(t.props.value("selected"))}onRackRemove_(e){if(!e.root)return;const t=e.bladeController;xr(t.itemController.view.element),t.itemController.viewProps.set("parent",null),this.tab.remove(t.props.value("selected"))}}Pe({id:"tab",type:"blade",accept(n){const e=xe(n,t=>({pages:t.required.array(t.required.object({title:t.required.string})),view:t.required.constant("tab")}));return!e||e.pages.length===0?null:{params:e}},controller(n){const e=new po(n.document,{blade:n.blade,viewProps:n.viewProps});return n.params.pages.forEach(t=>{const r=new kr(n.document,{blade:oo(),itemProps:J.fromObject({selected:!1,title:t.title}),props:J.fromObject({selected:!1}),viewProps:Jt.create()});e.add(r)}),e},api(n){return n.controller instanceof po?new xu(n.controller,n.pool):n.controller instanceof kr?new Pu(n.controller,n.pool):null}});class Ar extends br{get options(){return this.controller.valueController.props.get("options")}set options(e){this.controller.valueController.props.set("options",e)}}class nn{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce((t,r)=>r.constrain(t),e)}}function jn(n,e){if(n instanceof e)return n;if(n instanceof nn){const t=n.constraints.reduce((r,i)=>r||(i instanceof e?i:null),null);if(t)return t}return null}class Dn{constructor(e){this.values=J.fromObject({options:e})}constrain(e){const t=this.values.get("options");return t.length===0||t.filter(i=>i.value===e).length>0?e:t[0].value}}function In(n){var e;const t=_r;if(Array.isArray(n))return(e=xe({items:n},r=>({items:r.required.array(r.required.object({text:r.required.string,value:r.required.raw}))})))===null||e===void 0?void 0:e.items;if(typeof n=="object")return t.required.raw(n).value}function mo(n){if(Array.isArray(n))return n;const e=[];return Object.keys(n).forEach(t=>{e.push({text:t,value:n[t]})}),e}function Or(n){return de(n)?null:new Dn(mo(Fe(n)))}const Vr=ee("lst");class Mu{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.element=e.createElement("div"),this.element.classList.add(Vr()),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("select");r.classList.add(Vr("s")),t.viewProps.bindDisabled(r),this.element.appendChild(r),this.selectElement=r;const i=e.createElement("div");i.classList.add(Vr("m")),i.appendChild(Vn(e,"dropdown")),this.element.appendChild(i),t.value.emitter.on("change",this.onValueChange_),this.value_=t.value,We(this.props_,"options",o=>{Qi(this.selectElement),o.forEach(a=>{const s=e.createElement("option");s.textContent=a.text,this.selectElement.appendChild(s)}),this.update_()})}update_(){const e=this.props_.get("options").map(t=>t.value);this.selectElement.selectedIndex=e.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}}class Vt{constructor(e,t){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new Mu(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const t=Fe(e.currentTarget);this.value.rawValue=this.props.get("options")[t.selectedIndex].value}importProps(e){return $e(e,null,t=>({options:t.required.custom(In)}),t=>(this.props.set("options",mo(t.options)),!0))}exportProps(){return Ke(null,{options:this.props.get("options")})}}const fo=ee("pop");class Su{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(fo()),t.viewProps.bindClassModifiers(this.element),it(t.shows,Ot(this.element,fo(void 0,"v")))}}class vo{constructor(e,t){this.shows=be(!1),this.viewProps=t.viewProps,this.view=new Su(e,{shows:this.shows,viewProps:this.viewProps})}}const go=ee("txt");class Tu{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(go()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);const r=e.createElement("input");r.classList.add(go("i")),r.type="text",t.viewProps.bindDisabled(r),this.element.appendChild(r),this.inputElement=r,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}}class jr{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new Tu(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const r=Fe(e.currentTarget).value,i=this.parser_(r);de(i)||(this.value.rawValue=i),this.view.refresh()}}function Lu(n){return String(n)}function wo(n){return n==="false"?!1:!!n}function bo(n){return Lu(n)}function ku(n){return e=>n.reduce((t,r)=>t!==null?t:r(e),null)}const Au=Ee(0);function Bn(n){return Au(n)+"%"}function _o(n){return String(n)}function Dr(n){return n}function jt({primary:n,secondary:e,forward:t,backward:r}){let i=!1;function o(a){i||(i=!0,a(),i=!1)}n.emitter.on("change",a=>{o(()=>{e.setRawValue(t(n.rawValue,e.rawValue),a.options)})}),e.emitter.on("change",a=>{o(()=>{n.setRawValue(r(n.rawValue,e.rawValue),a.options)}),o(()=>{e.setRawValue(t(n.rawValue,e.rawValue),a.options)})}),o(()=>{e.setRawValue(t(n.rawValue,e.rawValue),{forceEmit:!1,last:!0})})}function Me(n,e){const t=n*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+t:e.downKey?-t:0}function rn(n){return{altKey:n.altKey,downKey:n.key==="ArrowDown",shiftKey:n.shiftKey,upKey:n.key==="ArrowUp"}}function ot(n){return{altKey:n.altKey,downKey:n.key==="ArrowLeft",shiftKey:n.shiftKey,upKey:n.key==="ArrowRight"}}function Ou(n){return n==="ArrowUp"||n==="ArrowDown"}function yo(n){return Ou(n)||n==="ArrowLeft"||n==="ArrowRight"}function Ir(n,e){var t,r;const i=e.ownerDocument.defaultView,o=e.getBoundingClientRect();return{x:n.pageX-(((t=i&&i.scrollX)!==null&&t!==void 0?t:0)+o.left),y:n.pageY-(((r=i&&i.scrollY)!==null&&r!==void 0?r:0)+o.top)}}class xt{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new Oe,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var t;e.preventDefault(),(t=e.currentTarget)===null||t===void 0||t.focus();const r=this.elem_.ownerDocument;r.addEventListener("mousemove",this.onDocumentMouseMove_),r.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(Ir(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(Ir(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(Ir(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const t=e.targetTouches.item(0),r=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-r.left,y:t.clientY-r.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchMove_(e){const t=e.targetTouches.item(0),r=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-r.left,y:t.clientY-r.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchEnd_(e){var t;const r=(t=e.targetTouches.item(0))!==null&&t!==void 0?t:this.lastTouch_,i=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(r?{x:r.clientX-i.left,y:r.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey})}}const je=ee("txt");class Vu{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(je(),je(void 0,"num")),t.arrayPosition&&this.element.classList.add(je(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("input");r.classList.add(je("i")),r.type="text",t.viewProps.bindDisabled(r),this.element.appendChild(r),this.inputElement=r,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(je()),this.inputElement.classList.add(je("i"));const i=e.createElement("div");i.classList.add(je("k")),this.element.appendChild(i),this.knobElement=i;const o=e.createElementNS(qe,"svg");o.classList.add(je("g")),this.knobElement.appendChild(o);const a=e.createElementNS(qe,"path");a.classList.add(je("gb")),o.appendChild(a),this.guideBodyElem_=a;const s=e.createElementNS(qe,"path");s.classList.add(je("gh")),o.appendChild(s),this.guideHeadElem_=s;const p=e.createElement("div");p.classList.add(ee("tt")()),this.knobElement.appendChild(p),this.tooltipElem_=p,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}onDraggingChange_(e){if(e.rawValue===null){this.element.classList.remove(je(void 0,"drg"));return}this.element.classList.add(je(void 0,"drg"));const t=e.rawValue/this.props_.get("pointerScale"),r=t+(t>0?-1:t<0?1:0),i=we(-r,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${r+i},0 L${r},4 L${r+i},8`,`M ${t},-1 L${t},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${t},4`);const o=this.props_.get("formatter");this.tooltipElem_.textContent=o(this.value.rawValue),this.tooltipElem_.style.left=`${t}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}}class on{constructor(e,t){var r;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=t.parser,this.props=t.props,this.sliderProps_=(r=t.sliderProps)!==null&&r!==void 0?r:null,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=be(null),this.view=new Vu(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const i=new xt(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}constrainValue_(e){var t,r;const i=(t=this.sliderProps_)===null||t===void 0?void 0:t.get("min"),o=(r=this.sliderProps_)===null||r===void 0?void 0:r.get("max");let a=e;return i!==void 0&&(a=Math.max(a,i)),o!==void 0&&(a=Math.min(a,o)),a}onInputChange_(e){const r=Fe(e.currentTarget).value,i=this.parser_(r);de(i)||(this.value.rawValue=this.constrainValue_(i)),this.view.refresh()}onInputKeyDown_(e){const t=Me(this.props.get("keyScale"),rn(e));t!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})}onInputKeyUp_(e){Me(this.props.get("keyScale"),rn(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("pointerScale"))}onPointerMove_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const Br=ee("sld");class ju{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Br()),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("div");r.classList.add(Br("t")),t.viewProps.bindTabIndex(r),this.element.appendChild(r),this.trackElement=r;const i=e.createElement("div");i.classList.add(Br("k")),this.trackElement.appendChild(i),this.knobElement=i,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.update_()}update_(){const e=we(ne(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width=`${e}%`}onChange_(){this.update_()}}class Du{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.props=t.props,this.view=new ju(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new xt(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){!e.point||this.value.setRawValue(ne(we(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("min"),this.props.get("max")),t)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Me(this.props.get("keyScale"),ot(e));t!==0&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})}onKeyUp_(e){Me(this.props.get("keyScale"),ot(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Rr=ee("sldtxt");class Iu{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Rr());const r=e.createElement("div");r.classList.add(Rr("s")),this.sliderView_=t.sliderView,r.appendChild(this.sliderView_.element),this.element.appendChild(r);const i=e.createElement("div");i.classList.add(Rr("t")),this.textView_=t.textView,i.appendChild(this.textView_.element),this.element.appendChild(i)}}class xo{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sliderC_=new Du(e,{props:t.sliderProps,value:t.value,viewProps:this.viewProps}),this.textC_=new on(e,{parser:t.parser,props:t.textProps,sliderProps:t.sliderProps,value:t.value,viewProps:t.viewProps}),this.view=new Iu(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(e){return $e(e,null,t=>({max:t.required.number,min:t.required.number}),t=>{const r=this.sliderC_.props;return r.set("max",t.max),r.set("min",t.min),!0})}exportProps(){const e=this.sliderC_.props;return Ke(null,{max:e.get("max"),min:e.get("min")})}}function Bu(n){return{sliderProps:new J({keyScale:n.keyScale,max:n.max,min:n.min}),textProps:new J({formatter:be(n.formatter),keyScale:n.keyScale,pointerScale:be(n.pointerScale)})}}const Ru={containerUnitSize:"cnt-usz"};function Po(n){return`--${Ru[n]}`}function sn(n){return Wi(n)}function dt(n){if(!!mr(n))return xe(n,sn)}function st(n,e){if(!n)return;const t=[],r=$i(n,e);r&&t.push(r);const i=Ki(n);return i&&t.push(i),new nn(t)}function Co(n){if(n==="inline"||n==="popup")return n}function an(n,e){n.write(e)}const Rn=ee("ckb");class Fu{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Rn()),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("label");r.classList.add(Rn("l")),this.element.appendChild(r),this.labelElement=r;const i=e.createElement("input");i.classList.add(Rn("i")),i.type="checkbox",this.labelElement.appendChild(i),this.inputElement=i,t.viewProps.bindDisabled(this.inputElement);const o=e.createElement("div");o.classList.add(Rn("w")),this.labelElement.appendChild(o);const a=Vn(e,"check");o.appendChild(a),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class Uu{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.onLabelMouseDown_=this.onLabelMouseDown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Fu(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.labelElement.addEventListener("mousedown",this.onLabelMouseDown_)}onInputChange_(e){const t=Fe(e.currentTarget);this.value.rawValue=t.checked,e.preventDefault(),e.stopPropagation()}onLabelMouseDown_(e){e.preventDefault()}}function Nu(n){const e=[],t=Or(n.options);return t&&e.push(t),new nn(e)}Pe({id:"input-bool",type:"input",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=xe(e,r=>({options:r.optional.custom(In),readonly:r.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>wo,constraint:n=>Nu(n.params),writer:n=>an},controller:n=>{const e=n.document,t=n.value,r=n.constraint,i=r&&jn(r,Dn);return i?new Vt(e,{props:new J({options:i.values.value("options")}),value:t,viewProps:n.viewProps}):new Uu(e,{value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="boolean"?null:n.controller.valueController instanceof Vt?new Ar(n.controller):null}});const Pt=ee("col");class zu{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Pt()),t.foldable.bindExpandedClass(this.element,Pt(void 0,"expanded")),We(t.foldable,"completed",Ot(this.element,Pt(void 0,"cpl")));const r=e.createElement("div");r.classList.add(Pt("h")),this.element.appendChild(r);const i=e.createElement("div");i.classList.add(Pt("s")),r.appendChild(i),this.swatchElement=i;const o=e.createElement("div");if(o.classList.add(Pt("t")),r.appendChild(o),this.textElement=o,t.pickerLayout==="inline"){const a=e.createElement("div");a.classList.add(Pt("p")),this.element.appendChild(a),this.pickerElement=a}else this.pickerElement=null}}function Hu(n,e,t){const r=we(n/255,0,1),i=we(e/255,0,1),o=we(t/255,0,1),a=Math.max(r,i,o),s=Math.min(r,i,o),p=a-s;let f=0,_=0;const g=(s+a)/2;return p!==0&&(_=p/(1-Math.abs(a+s-1)),r===a?f=(i-o)/p:i===a?f=2+(o-r)/p:f=4+(r-i)/p,f=f/6+(f<0?1:0)),[f*360,_*100,g*100]}function Gu(n,e,t){const r=(n%360+360)%360,i=we(e/100,0,1),o=we(t/100,0,1),a=(1-Math.abs(2*o-1))*i,s=a*(1-Math.abs(r/60%2-1)),p=o-a/2;let f,_,g;return r>=0&&r<60?[f,_,g]=[a,s,0]:r>=60&&r<120?[f,_,g]=[s,a,0]:r>=120&&r<180?[f,_,g]=[0,a,s]:r>=180&&r<240?[f,_,g]=[0,s,a]:r>=240&&r<300?[f,_,g]=[s,0,a]:[f,_,g]=[a,0,s],[(f+p)*255,(_+p)*255,(g+p)*255]}function $u(n,e,t){const r=we(n/255,0,1),i=we(e/255,0,1),o=we(t/255,0,1),a=Math.max(r,i,o),s=Math.min(r,i,o),p=a-s;let f;p===0?f=0:a===r?f=60*(((i-o)/p%6+6)%6):a===i?f=60*((o-r)/p+2):f=60*((r-i)/p+4);const _=a===0?0:p/a,g=a;return[f,_*100,g*100]}function Eo(n,e,t){const r=Hi(n,360),i=we(e/100,0,1),o=we(t/100,0,1),a=o*i,s=a*(1-Math.abs(r/60%2-1)),p=o-a;let f,_,g;return r>=0&&r<60?[f,_,g]=[a,s,0]:r>=60&&r<120?[f,_,g]=[s,a,0]:r>=120&&r<180?[f,_,g]=[0,a,s]:r>=180&&r<240?[f,_,g]=[0,s,a]:r>=240&&r<300?[f,_,g]=[s,0,a]:[f,_,g]=[a,0,s],[(f+p)*255,(_+p)*255,(g+p)*255]}function Ku(n,e,t){const r=t+e*(100-Math.abs(2*t-100))/(2*100);return[n,r!==0?e*(100-Math.abs(2*t-100))/r:0,t+e*(100-Math.abs(2*t-100))/(2*100)]}function qu(n,e,t){const r=100-Math.abs(t*(200-e)/100-100);return[n,r!==0?e*t/r:0,t*(200-e)/(2*100)]}function Ye(n){return[n[0],n[1],n[2]]}function Fn(n,e){return[n[0],n[1],n[2],e]}const Wu={hsl:{hsl:(n,e,t)=>[n,e,t],hsv:Ku,rgb:Gu},hsv:{hsl:qu,hsv:(n,e,t)=>[n,e,t],rgb:Eo},rgb:{hsl:Hu,hsv:$u,rgb:(n,e,t)=>[n,e,t]}};function Dt(n,e){return[e==="float"?1:n==="rgb"?255:360,e==="float"?1:n==="rgb"?255:100,e==="float"?1:n==="rgb"?255:100]}function Yu(n,e){return n===e?e:Hi(n,e)}function Mo(n,e,t){var r;const i=Dt(e,t);return[e==="rgb"?we(n[0],0,i[0]):Yu(n[0],i[0]),we(n[1],0,i[1]),we(n[2],0,i[2]),we((r=n[3])!==null&&r!==void 0?r:1,0,1)]}function So(n,e,t,r){const i=Dt(e,t),o=Dt(e,r);return n.map((a,s)=>a/i[s]*o[s])}function To(n,e,t){const r=So(n,e.mode,e.type,"int"),i=Wu[e.mode][t.mode](...r);return So(i,t.mode,"int",t.type)}class Z{static black(){return new Z([0,0,0],"rgb")}constructor(e,t){this.type="int",this.mode=t,this.comps_=Mo(e,t,this.type)}getComponents(e){return Fn(To(Ye(this.comps_),{mode:this.mode,type:this.type},{mode:e!=null?e:this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const ht=ee("colp");class Xu{constructor(e,t){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(ht()),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("div");r.classList.add(ht("hsv"));const i=e.createElement("div");i.classList.add(ht("sv")),this.svPaletteView_=t.svPaletteView,i.appendChild(this.svPaletteView_.element),r.appendChild(i);const o=e.createElement("div");o.classList.add(ht("h")),this.hPaletteView_=t.hPaletteView,o.appendChild(this.hPaletteView_.element),r.appendChild(o),this.element.appendChild(r);const a=e.createElement("div");if(a.classList.add(ht("rgb")),this.textsView_=t.textsView,a.appendChild(this.textsView_.element),this.element.appendChild(a),t.alphaViews){this.alphaViews_={palette:t.alphaViews.palette,text:t.alphaViews.text};const s=e.createElement("div");s.classList.add(ht("a"));const p=e.createElement("div");p.classList.add(ht("ap")),p.appendChild(this.alphaViews_.palette.element),s.appendChild(p);const f=e.createElement("div");f.classList.add(ht("at")),f.appendChild(this.alphaViews_.text.element),s.appendChild(f),this.element.appendChild(s)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map(t=>t.inputElement)];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}}function Zu(n){return n==="int"?"int":n==="float"?"float":void 0}function Fr(n){return xe(n,e=>({color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(Zu)}),expanded:e.optional.boolean,picker:e.optional.custom(Co),readonly:e.optional.constant(!1)}))}function Ct(n){return n?.1:1}function Lo(n){var e;return(e=n.color)===null||e===void 0?void 0:e.type}class Ur{constructor(e,t){this.type="float",this.mode=t,this.comps_=Mo(e,t,this.type)}getComponents(e){return Fn(To(Ye(this.comps_),{mode:this.mode,type:this.type},{mode:e!=null?e:this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const Qu={int:(n,e)=>new Z(n,e),float:(n,e)=>new Ur(n,e)};function Nr(n,e,t){return Qu[t](n,e)}function Ju(n){return n.type==="float"}function ec(n){return n.type==="int"}function tc(n){const e=n.getComponents(),t=Dt(n.mode,"int");return new Z([Math.round(ne(e[0],0,1,0,t[0])),Math.round(ne(e[1],0,1,0,t[1])),Math.round(ne(e[2],0,1,0,t[2])),e[3]],n.mode)}function nc(n){const e=n.getComponents(),t=Dt(n.mode,"int");return new Ur([ne(e[0],0,t[0],0,1),ne(e[1],0,t[1],0,1),ne(e[2],0,t[2],0,1),e[3]],n.mode)}function Ce(n,e){if(n.type===e)return n;if(ec(n)&&e==="float")return nc(n);if(Ju(n)&&e==="int")return tc(n);throw Ae.shouldNeverHappen()}function rc(n,e){return n.alpha===e.alpha&&n.mode===e.mode&&n.notation===e.notation&&n.type===e.type}function De(n,e){const t=n.match(/^(.+)%$/);return Math.min(t?parseFloat(t[1])*.01*e:parseFloat(n),e)}const ic={deg:n=>n,grad:n=>n*360/400,rad:n=>n*360/(2*Math.PI),turn:n=>n*360};function ko(n){const e=n.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(n);const t=parseFloat(e[1]),r=e[2];return ic[r](t)}function Ao(n){const e=n.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[De(e[1],255),De(e[2],255),De(e[3],255)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function oc(n){const e=Ao(n);return e?new Z(e,"rgb"):null}function Oo(n){const e=n.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[De(e[1],255),De(e[2],255),De(e[3],255),De(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function sc(n){const e=Oo(n);return e?new Z(e,"rgb"):null}function Vo(n){const e=n.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[ko(e[1]),De(e[2],100),De(e[3],100)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function ac(n){const e=Vo(n);return e?new Z(e,"hsl"):null}function jo(n){const e=n.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[ko(e[1]),De(e[2],100),De(e[3],100),De(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function lc(n){const e=jo(n);return e?new Z(e,"hsl"):null}function Do(n){const e=n.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)];const t=n.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null}function uc(n){const e=Do(n);return e?new Z(e,"rgb"):null}function Io(n){const e=n.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),ne(parseInt(e[4]+e[4],16),0,255,0,1)];const t=n.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),ne(parseInt(t[4],16),0,255,0,1)]:null}function cc(n){const e=Io(n);return e?new Z(e,"rgb"):null}function Bo(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function Ro(n){return e=>{const t=Bo(e);return t?Nr(t,"rgb",n):null}}function Fo(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function Uo(n){return e=>{const t=Fo(e);return t?Nr(t,"rgb",n):null}}const dc=[{parser:Do,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:Io,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:Ao,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:Oo,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:Vo,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:jo,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:Bo,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:Fo,result:{alpha:!0,mode:"rgb",notation:"object"}}];function hc(n){return dc.reduce((e,{parser:t,result:r})=>e||(t(n)?r:null),null)}function pc(n,e="int"){const t=hc(n);return t?t.notation==="hex"&&e!=="float"?Object.assign(Object.assign({},t),{type:"int"}):t.notation==="func"?Object.assign(Object.assign({},t),{type:e}):null:null}function ln(n){const e=[uc,cc,oc,sc,ac,lc];n==="int"&&e.push(Ro("int"),Uo("int")),n==="float"&&e.push(Ro("float"),Uo("float"));const t=ku(e);return r=>{const i=t(r);return i?Ce(i,n):null}}function mc(n){const e=ln("int");if(typeof n!="string")return Z.black();const t=e(n);return t!=null?t:Z.black()}function No(n){const e=we(Math.floor(n),0,255).toString(16);return e.length===1?`0${e}`:e}function zr(n,e="#"){const t=Ye(n.getComponents("rgb")).map(No).join("");return`${e}${t}`}function Hr(n,e="#"){const t=n.getComponents("rgb"),r=[t[0],t[1],t[2],t[3]*255].map(No).join("");return`${e}${r}`}function zo(n){const e=Ee(0),t=Ce(n,"int");return`rgb(${Ye(t.getComponents("rgb")).map(i=>e(i)).join(", ")})`}function Un(n){const e=Ee(2),t=Ee(0);return`rgba(${Ce(n,"int").getComponents("rgb").map((o,a)=>(a===3?e:t)(o)).join(", ")})`}function fc(n){const e=[Ee(0),Bn,Bn],t=Ce(n,"int");return`hsl(${Ye(t.getComponents("hsl")).map((i,o)=>e[o](i)).join(", ")})`}function vc(n){const e=[Ee(0),Bn,Bn,Ee(2)];return`hsla(${Ce(n,"int").getComponents("hsl").map((i,o)=>e[o](i)).join(", ")})`}function Ho(n,e){const t=Ee(e==="float"?2:0),r=["r","g","b"],i=Ce(n,e);return`{${Ye(i.getComponents("rgb")).map((a,s)=>`${r[s]}: ${t(a)}`).join(", ")}}`}function gc(n){return e=>Ho(e,n)}function Go(n,e){const t=Ee(2),r=Ee(e==="float"?2:0),i=["r","g","b","a"];return`{${Ce(n,e).getComponents("rgb").map((s,p)=>{const f=p===3?t:r;return`${i[p]}: ${f(s)}`}).join(", ")}}`}function wc(n){return e=>Go(e,n)}const bc=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:zr},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:Hr},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:zo},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:Un},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:fc},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:vc},...["int","float"].reduce((n,e)=>[...n,{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:gc(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:wc(e)}],[])];function $o(n){return bc.reduce((e,t)=>e||(rc(t.format,n)?t.stringifier:null),null)}const un=ee("apl");class _c{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(un()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const r=e.createElement("div");r.classList.add(un("b")),this.element.appendChild(r);const i=e.createElement("div");i.classList.add(un("c")),r.appendChild(i),this.colorElem_=i;const o=e.createElement("div");o.classList.add(un("m")),this.element.appendChild(o),this.markerElem_=o;const a=e.createElement("div");a.classList.add(un("p")),this.markerElem_.appendChild(a),this.previewElem_=a,this.update_()}update_(){const e=this.value.rawValue,t=e.getComponents("rgb"),r=new Z([t[0],t[1],t[2],0],"rgb"),i=new Z([t[0],t[1],t[2],255],"rgb"),o=["to right",Un(r),Un(i)];this.colorElem_.style.background=`linear-gradient(${o.join(",")})`,this.previewElem_.style.backgroundColor=Un(e);const a=ne(t[3],0,1,0,100);this.markerElem_.style.left=`${a}%`}onValueChange_(){this.update_()}}class yc{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new _c(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new xt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const r=e.point.x/e.bounds.width,i=this.value.rawValue,[o,a,s]=i.getComponents("hsv");this.value.setRawValue(new Z([o,a,s,r],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Me(Ct(!0),ot(e));if(t===0)return;const r=this.value.rawValue,[i,o,a,s]=r.getComponents("hsv");this.value.setRawValue(new Z([i,o,a,s+t],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){Me(Ct(!0),ot(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const It=ee("coltxt");function xc(n){const e=n.createElement("select"),t=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}];return e.appendChild(t.reduce((r,i)=>{const o=n.createElement("option");return o.textContent=i.text,o.value=i.value,r.appendChild(o),r},n.createDocumentFragment())),e}class Pc{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(It()),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("div");r.classList.add(It("m")),this.modeElem_=xc(e),this.modeElem_.classList.add(It("ms")),r.appendChild(this.modeSelectElement),t.viewProps.bindDisabled(this.modeElem_);const i=e.createElement("div");i.classList.add(It("mm")),i.appendChild(Vn(e,"dropdown")),r.appendChild(i),this.element.appendChild(r);const o=e.createElement("div");o.classList.add(It("w")),this.element.appendChild(o),this.inputsElem_=o,this.inputViews_=t.inputViews,this.applyInputViews_(),it(t.mode,a=>{this.modeElem_.value=a})}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(e){this.inputViews_=e,this.applyInputViews_()}applyInputViews_(){Qi(this.inputsElem_);const e=this.element.ownerDocument;this.inputViews_.forEach(t=>{const r=e.createElement("div");r.classList.add(It("c")),r.appendChild(t.element),this.inputsElem_.appendChild(r)})}}function Cc(n){return Ee(n==="float"?2:0)}function Ec(n,e,t){const r=Dt(n,e)[t];return new Ln({min:0,max:r})}function Mc(n,e,t){return new on(n,{arrayPosition:t===0?"fst":t===3-1?"lst":"mid",parser:e.parser,props:J.fromObject({formatter:Cc(e.colorType),keyScale:Ct(!1),pointerScale:e.colorType==="float"?.01:1}),value:be(0,{constraint:Ec(e.colorMode,e.colorType,t)}),viewProps:e.viewProps})}function Sc(n,e){const t={colorMode:e.colorMode,colorType:e.colorType,parser:ct,viewProps:e.viewProps};return[0,1,2].map(r=>{const i=Mc(n,t,r);return jt({primary:e.value,secondary:i.value,forward(o){return Ce(o,e.colorType).getComponents(e.colorMode)[r]},backward(o,a){const s=e.colorMode,f=Ce(o,e.colorType).getComponents(s);f[r]=a;const _=Nr(Fn(Ye(f),f[3]),s,e.colorType);return Ce(_,"int")}}),i})}function Tc(n,e){const t=new jr(n,{parser:ln("int"),props:J.fromObject({formatter:zr}),value:be(Z.black()),viewProps:e.viewProps});return jt({primary:e.value,secondary:t.value,forward:r=>new Z(Ye(r.getComponents()),r.mode),backward:(r,i)=>new Z(Fn(Ye(i.getComponents(r.mode)),r.getComponents()[3]),r.mode)}),[t]}function Lc(n){return n!=="hex"}class kc{constructor(e,t){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=t.colorType,this.value=t.value,this.viewProps=t.viewProps,this.colorMode=be(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new Pc(e,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const t=this.colorMode.rawValue;return Lc(t)?Sc(e,{colorMode:t,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):Tc(e,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(e){const t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map(r=>r.view)}}const Gr=ee("hpl");class Ac{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Gr()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const r=e.createElement("div");r.classList.add(Gr("c")),this.element.appendChild(r);const i=e.createElement("div");i.classList.add(Gr("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}update_(){const e=this.value.rawValue,[t]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=zo(new Z([t,100,100],"hsv"));const r=ne(t,0,360,0,100);this.markerElem_.style.left=`${r}%`}onValueChange_(){this.update_()}}class Oc{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Ac(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new xt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const r=ne(we(e.point.x,0,e.bounds.width),0,e.bounds.width,0,360),i=this.value.rawValue,[,o,a,s]=i.getComponents("hsv");this.value.setRawValue(new Z([r,o,a,s],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Me(Ct(!1),ot(e));if(t===0)return;const r=this.value.rawValue,[i,o,a,s]=r.getComponents("hsv");this.value.setRawValue(new Z([i+t,o,a,s],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){Me(Ct(!1),ot(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const $r=ee("svp"),Ko=64;class Vc{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add($r()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const r=e.createElement("canvas");r.height=Ko,r.width=Ko,r.classList.add($r("c")),this.element.appendChild(r),this.canvasElement=r;const i=e.createElement("div");i.classList.add($r("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}update_(){const e=Kl(this.canvasElement);if(!e)return;const r=this.value.rawValue.getComponents("hsv"),i=this.canvasElement.width,o=this.canvasElement.height,a=e.getImageData(0,0,i,o),s=a.data;for(let _=0;_<o;_++)for(let g=0;g<i;g++){const E=ne(g,0,i,0,100),O=ne(_,0,o,100,0),b=Eo(r[0],E,O),P=(_*i+g)*4;s[P]=b[0],s[P+1]=b[1],s[P+2]=b[2],s[P+3]=255}e.putImageData(a,0,0);const p=ne(r[1],0,100,0,100);this.markerElem_.style.left=`${p}%`;const f=ne(r[2],0,100,100,0);this.markerElem_.style.top=`${f}%`}onValueChange_(){this.update_()}}class jc{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Vc(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new xt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const r=ne(e.point.x,0,e.bounds.width,0,100),i=ne(e.point.y,0,e.bounds.height,100,0),[o,,,a]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new Z([o,r,i,a],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){yo(e.key)&&e.preventDefault();const[t,r,i,o]=this.value.rawValue.getComponents("hsv"),a=Ct(!1),s=Me(a,ot(e)),p=Me(a,rn(e));s===0&&p===0||this.value.setRawValue(new Z([t,r+s,i+p,o],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const t=Ct(!1),r=Me(t,ot(e)),i=Me(t,rn(e));r===0&&i===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Dc{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.hPaletteC_=new Oc(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new jc(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=t.supportsAlpha?{palette:new yc(e,{value:this.value,viewProps:this.viewProps}),text:new on(e,{parser:ct,props:J.fromObject({pointerScale:.01,keyScale:.1,formatter:Ee(2)}),value:be(0,{constraint:new Ln({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&jt({primary:this.value,secondary:this.alphaIcs_.text.value,forward:r=>r.getComponents()[3],backward:(r,i)=>{const o=r.getComponents();return o[3]=i,new Z(o,r.mode)}}),this.textsC_=new kc(e,{colorType:t.colorType,value:this.value,viewProps:this.viewProps}),this.view=new Xu(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:t.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}}const Kr=ee("colsw");class Ic{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(Kr()),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("div");r.classList.add(Kr("sw")),this.element.appendChild(r),this.swatchElem_=r;const i=e.createElement("button");i.classList.add(Kr("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=Hr(e)}onValueChange_(){this.update_()}}class Bc{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Ic(e,{value:this.value,viewProps:this.viewProps})}}class qr{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Qt.create(t.expanded),this.swatchC_=new Bc(e,{value:this.value,viewProps:this.viewProps});const r=this.swatchC_.view.buttonElement;r.addEventListener("blur",this.onButtonBlur_),r.addEventListener("click",this.onButtonClick_),this.textC_=new jr(e,{parser:t.parser,props:J.fromObject({formatter:t.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new zu(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=t.pickerLayout==="popup"?new vo(e,{viewProps:this.viewProps}):null;const i=new Dc(e,{colorType:t.colorType,supportsAlpha:t.supportsAlpha,value:this.value,viewProps:this.viewProps});i.view.allFocusableElements.forEach(o=>{o.addEventListener("blur",this.onPopupChildBlur_),o.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=i,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(i.view.element),jt({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:o=>o,backward:(o,a)=>a})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Lr(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,r=Fe(e.relatedTarget);(!r||!t.contains(r))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,r=Ji(e);r&&t.contains(r)||r&&r===this.swatchC_.view.buttonElement&&!yr(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}}function Rc(n){return Ye(n.getComponents("rgb")).reduce((e,t)=>e<<8|Math.floor(t)&255,0)}function Fc(n){return n.getComponents("rgb").reduce((e,t,r)=>{const i=Math.floor(r===3?t*255:t)&255;return e<<8|i},0)>>>0}function Uc(n){return new Z([n>>16&255,n>>8&255,n&255],"rgb")}function Nc(n){return new Z([n>>24&255,n>>16&255,n>>8&255,ne(n&255,0,255,0,1)],"rgb")}function zc(n){return typeof n!="number"?Z.black():Uc(n)}function Hc(n){return typeof n!="number"?Z.black():Nc(n)}function Nn(n,e){return typeof n!="object"||de(n)?!1:e in n&&typeof n[e]=="number"}function qo(n){return Nn(n,"r")&&Nn(n,"g")&&Nn(n,"b")}function Wo(n){return qo(n)&&Nn(n,"a")}function Yo(n){return qo(n)}function Wr(n,e){if(n.mode!==e.mode||n.type!==e.type)return!1;const t=n.getComponents(),r=e.getComponents();for(let i=0;i<t.length;i++)if(t[i]!==r[i])return!1;return!0}function Xo(n){return"a"in n?[n.r,n.g,n.b,n.a]:[n.r,n.g,n.b]}function Gc(n){const e=$o(n);return e?(t,r)=>{an(t,e(r))}:null}function $c(n){const e=n?Fc:Rc;return(t,r)=>{an(t,e(r))}}function Kc(n,e,t){const i=Ce(e,t).toRgbaObject();n.writeProperty("r",i.r),n.writeProperty("g",i.g),n.writeProperty("b",i.b),n.writeProperty("a",i.a)}function qc(n,e,t){const i=Ce(e,t).toRgbaObject();n.writeProperty("r",i.r),n.writeProperty("g",i.g),n.writeProperty("b",i.b)}function Wc(n,e){return(t,r)=>{n?Kc(t,r,e):qc(t,r,e)}}function Yc(n){var e;return!!((e=n==null?void 0:n.color)===null||e===void 0?void 0:e.alpha)}function Xc(n){return n?e=>Hr(e,"0x"):e=>zr(e,"0x")}function Zc(n){return"color"in n||n.view==="color"}Pe({id:"input-color-number",type:"input",accept:(n,e)=>{if(typeof n!="number"||!Zc(e))return null;const t=Fr(e);return t?{initialValue:n,params:Object.assign(Object.assign({},t),{supportsAlpha:Yc(e)})}:null},binding:{reader:n=>n.params.supportsAlpha?Hc:zc,equals:Wr,writer:n=>$c(n.params.supportsAlpha)},controller:n=>{var e,t;return new qr(n.document,{colorType:"int",expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:Xc(n.params.supportsAlpha),parser:ln("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.supportsAlpha,value:n.value,viewProps:n.viewProps})}});function Qc(n,e){if(!Yo(n))return Ce(Z.black(),e);if(e==="int"){const t=Xo(n);return new Z(t,"rgb")}if(e==="float"){const t=Xo(n);return new Ur(t,"rgb")}return Ce(Z.black(),"int")}function Jc(n){return Wo(n)}function ed(n){return e=>{const t=Qc(e,n);return Ce(t,"int")}}function td(n,e){return t=>n?Go(t,e):Ho(t,e)}Pe({id:"input-color-object",type:"input",accept:(n,e)=>{var t;if(!Yo(n))return null;const r=Fr(e);return r?{initialValue:n,params:Object.assign(Object.assign({},r),{colorType:(t=Lo(e))!==null&&t!==void 0?t:"int"})}:null},binding:{reader:n=>ed(n.params.colorType),equals:Wr,writer:n=>Wc(Jc(n.initialValue),n.params.colorType)},controller:n=>{var e,t;const r=Wo(n.initialValue);return new qr(n.document,{colorType:n.params.colorType,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:td(r,n.params.colorType),parser:ln("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:r,value:n.value,viewProps:n.viewProps})}});Pe({id:"input-color-string",type:"input",accept:(n,e)=>{if(typeof n!="string"||e.view==="text")return null;const t=pc(n,Lo(e));if(!t)return null;const r=$o(t);if(!r)return null;const i=Fr(e);return i?{initialValue:n,params:Object.assign(Object.assign({},i),{format:t,stringifier:r})}:null},binding:{reader:()=>mc,equals:Wr,writer:n=>{const e=Gc(n.params.format);if(!e)throw Ae.notBindable();return e}},controller:n=>{var e,t;return new qr(n.document,{colorType:n.params.format.type,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:n.params.stringifier,parser:ln("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.format.alpha,value:n.value,viewProps:n.viewProps})}});class Yr{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const t=this.asm_.toComponents(e).map((r,i)=>{var o,a;return(a=(o=this.components[i])===null||o===void 0?void 0:o.constrain(r))!==null&&a!==void 0?a:r});return this.asm_.fromComponents(t)}}const Zo=ee("pndtxt");class nd{constructor(e,t){this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(Zo()),this.textViews.forEach(r=>{const i=e.createElement("div");i.classList.add(Zo("a")),i.appendChild(r.element),this.element.appendChild(i)})}}function rd(n,e,t){return new on(n,{arrayPosition:t===0?"fst":t===e.axes.length-1?"lst":"mid",parser:e.parser,props:e.axes[t].textProps,value:be(0,{constraint:e.axes[t].constraint}),viewProps:e.viewProps})}class Xr{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map((r,i)=>rd(e,t,i)),this.acs_.forEach((r,i)=>{jt({primary:this.value,secondary:r.value,forward:o=>t.assembly.toComponents(o)[i],backward:(o,a)=>{const s=t.assembly.toComponents(o);return s[i]=a,t.assembly.fromComponents(s)}})}),this.view=new nd(e,{textViews:this.acs_.map(r=>r.view)})}get textControllers(){return this.acs_}}class id extends br{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(e){this.controller.valueController.sliderController.props.set("max",e)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(e){this.controller.valueController.sliderController.props.set("min",e)}}function od(n,e){const t=[],r=$i(n,e);r&&t.push(r);const i=Ki(n);i&&t.push(i);const o=Or(n.options);return o&&t.push(o),new nn(t)}Pe({id:"input-number",type:"input",accept:(n,e)=>{if(typeof n!="number")return null;const t=xe(e,r=>Object.assign(Object.assign({},Wi(r)),{options:r.optional.custom(In),readonly:r.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>Ni,constraint:n=>od(n.params,n.initialValue),writer:n=>an},controller:n=>{const e=n.value,t=n.constraint,r=t&&jn(t,Dn);if(r)return new Vt(n.document,{props:new J({options:r.values.value("options")}),value:e,viewProps:n.viewProps});const i=qi(n.params,e.rawValue),o=t&&jn(t,Ln);return o?new xo(n.document,Object.assign(Object.assign({},Bu(Object.assign(Object.assign({},i),{keyScale:be(i.keyScale),max:o.values.value("max"),min:o.values.value("min")}))),{parser:ct,value:e,viewProps:n.viewProps})):new on(n.document,{parser:ct,props:J.fromObject(i),value:e,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="number"?null:n.controller.valueController instanceof xo?new id(n.controller):n.controller.valueController instanceof Vt?new Ar(n.controller):null}});class pt{constructor(e=0,t=0){this.x=e,this.y=t}getComponents(){return[this.x,this.y]}static isObject(e){if(de(e))return!1;const t=e.x,r=e.y;return!(typeof t!="number"||typeof r!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y}toObject(){return{x:this.x,y:this.y}}}const Qo={toComponents:n=>n.getComponents(),fromComponents:n=>new pt(...n)},Bt=ee("p2d");class sd{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Bt()),t.viewProps.bindClassModifiers(this.element),it(t.expanded,Ot(this.element,Bt(void 0,"expanded")));const r=e.createElement("div");r.classList.add(Bt("h")),this.element.appendChild(r);const i=e.createElement("button");i.classList.add(Bt("b")),i.appendChild(Vn(e,"p2dpad")),t.viewProps.bindDisabled(i),r.appendChild(i),this.buttonElement=i;const o=e.createElement("div");if(o.classList.add(Bt("t")),r.appendChild(o),this.textElement=o,t.pickerLayout==="inline"){const a=e.createElement("div");a.classList.add(Bt("p")),this.element.appendChild(a),this.pickerElement=a}else this.pickerElement=null}}const mt=ee("p2dp");class ad{constructor(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=e.createElement("div"),this.element.classList.add(mt()),t.layout==="popup"&&this.element.classList.add(mt(void 0,"p")),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("div");r.classList.add(mt("p")),t.viewProps.bindTabIndex(r),this.element.appendChild(r),this.padElement=r;const i=e.createElementNS(qe,"svg");i.classList.add(mt("g")),this.padElement.appendChild(i),this.svgElem_=i;const o=e.createElementNS(qe,"line");o.classList.add(mt("ax")),o.setAttributeNS(null,"x1","0"),o.setAttributeNS(null,"y1","50%"),o.setAttributeNS(null,"x2","100%"),o.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(o);const a=e.createElementNS(qe,"line");a.classList.add(mt("ax")),a.setAttributeNS(null,"x1","50%"),a.setAttributeNS(null,"y1","0"),a.setAttributeNS(null,"x2","50%"),a.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(a);const s=e.createElementNS(qe,"line");s.classList.add(mt("l")),s.setAttributeNS(null,"x1","50%"),s.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(s),this.lineElem_=s;const p=e.createElement("div");p.classList.add(mt("m")),this.padElement.appendChild(p),this.markerElem_=p,t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,t]=this.value.rawValue.getComponents(),r=this.props_.get("max"),i=ne(e,-r,+r,0,100),o=ne(t,-r,+r,0,100),a=this.props_.get("invertsY")?100-o:o;this.lineElem_.setAttributeNS(null,"x2",`${i}%`),this.lineElem_.setAttributeNS(null,"y2",`${a}%`),this.markerElem_.style.left=`${i}%`,this.markerElem_.style.top=`${a}%`}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}}function Jo(n,e,t){return[Me(e[0],ot(n)),Me(e[1],rn(n))*(t?1:-1)]}class ld{constructor(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new ad(e,{layout:t.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new xt(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const r=this.props.get("max"),i=ne(e.point.x,0,e.bounds.width,-r,+r),o=ne(this.props.get("invertsY")?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-r,+r);this.value.setRawValue(new pt(i,o),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){yo(e.key)&&e.preventDefault();const[t,r]=Jo(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&r===0||this.value.setRawValue(new pt(this.value.rawValue.x+t,this.value.rawValue.y+r),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[t,r]=Jo(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&r===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class ud{constructor(e,t){var r,i;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Qt.create(t.expanded),this.popC_=t.pickerLayout==="popup"?new vo(e,{viewProps:this.viewProps}):null;const o=new ld(e,{layout:t.pickerLayout,props:new J({invertsY:be(t.invertsY),max:be(t.max),xKeyScale:t.axes[0].textProps.value("keyScale"),yKeyScale:t.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});o.view.allFocusableElements.forEach(a=>{a.addEventListener("blur",this.onPopupChildBlur_),a.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=o,this.textC_=new Xr(e,{assembly:Qo,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new sd(e,{expanded:this.foldable_.value("expanded"),pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(r=this.view.buttonElement)===null||r===void 0||r.addEventListener("blur",this.onPadButtonBlur_),(i=this.view.buttonElement)===null||i===void 0||i.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),jt({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:a=>a,backward:(a,s)=>s})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Lr(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onPadButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,r=Fe(e.relatedTarget);(!r||!t.contains(r))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,r=Ji(e);r&&t.contains(r)||r&&r===this.view.buttonElement&&!yr(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.view.buttonElement.focus()}}function cd(n){return pt.isObject(n)?new pt(n.x,n.y):new pt}function dd(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y)}function hd(n,e){return new Yr({assembly:Qo,components:[st(Object.assign(Object.assign({},n),n.x),e.x),st(Object.assign(Object.assign({},n),n.y),e.y)]})}function es(n,e){var t,r;if(!de(n.min)||!de(n.max))return Math.max(Math.abs((t=n.min)!==null&&t!==void 0?t:0),Math.abs((r=n.max)!==null&&r!==void 0?r:0));const i=Gi(n);return Math.max(Math.abs(i)*10,Math.abs(e)*10)}function pd(n,e){var t,r;const i=es(yt(n,(t=n.x)!==null&&t!==void 0?t:{}),e.x),o=es(yt(n,(r=n.y)!==null&&r!==void 0?r:{}),e.y);return Math.max(i,o)}function md(n){if(!("y"in n))return!1;const e=n.y;return e&&"inverted"in e?!!e.inverted:!1}Pe({id:"input-point2d",type:"input",accept:(n,e)=>{if(!pt.isObject(n))return null;const t=xe(e,r=>Object.assign(Object.assign({},sn(r)),{expanded:r.optional.boolean,picker:r.optional.custom(Co),readonly:r.optional.constant(!1),x:r.optional.custom(dt),y:r.optional.object(Object.assign(Object.assign({},sn(r)),{inverted:r.optional.boolean}))}));return t?{initialValue:n,params:t}:null},binding:{reader:()=>cd,constraint:n=>hd(n.params,n.initialValue),equals:pt.equals,writer:()=>dd},controller:n=>{var e,t;const r=n.document,i=n.value,o=n.constraint,a=[n.params.x,n.params.y];return new ud(r,{axes:i.rawValue.getComponents().map((s,p)=>{var f;return gr({constraint:o.components[p],initialValue:s,params:yt(n.params,(f=a[p])!==null&&f!==void 0?f:{})})}),expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,invertsY:md(n.params),max:pd(n.params,i.rawValue),parser:ct,pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",value:i,viewProps:n.viewProps})}});class Rt{constructor(e=0,t=0,r=0){this.x=e,this.y=t,this.z=r}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if(de(e))return!1;const t=e.x,r=e.y,i=e.z;return!(typeof t!="number"||typeof r!="number"||typeof i!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const ts={toComponents:n=>n.getComponents(),fromComponents:n=>new Rt(...n)};function fd(n){return Rt.isObject(n)?new Rt(n.x,n.y,n.z):new Rt}function vd(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z)}function gd(n,e){return new Yr({assembly:ts,components:[st(Object.assign(Object.assign({},n),n.x),e.x),st(Object.assign(Object.assign({},n),n.y),e.y),st(Object.assign(Object.assign({},n),n.z),e.z)]})}Pe({id:"input-point3d",type:"input",accept:(n,e)=>{if(!Rt.isObject(n))return null;const t=xe(e,r=>Object.assign(Object.assign({},sn(r)),{readonly:r.optional.constant(!1),x:r.optional.custom(dt),y:r.optional.custom(dt),z:r.optional.custom(dt)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>fd,constraint:n=>gd(n.params,n.initialValue),equals:Rt.equals,writer:n=>vd},controller:n=>{const e=n.value,t=n.constraint,r=[n.params.x,n.params.y,n.params.z];return new Xr(n.document,{assembly:ts,axes:e.rawValue.getComponents().map((i,o)=>{var a;return gr({constraint:t.components[o],initialValue:i,params:yt(n.params,(a=r[o])!==null&&a!==void 0?a:{})})}),parser:ct,value:e,viewProps:n.viewProps})}});class Ft{constructor(e=0,t=0,r=0,i=0){this.x=e,this.y=t,this.z=r,this.w=i}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if(de(e))return!1;const t=e.x,r=e.y,i=e.z,o=e.w;return!(typeof t!="number"||typeof r!="number"||typeof i!="number"||typeof o!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const ns={toComponents:n=>n.getComponents(),fromComponents:n=>new Ft(...n)};function wd(n){return Ft.isObject(n)?new Ft(n.x,n.y,n.z,n.w):new Ft}function bd(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z),n.writeProperty("w",e.w)}function _d(n,e){return new Yr({assembly:ns,components:[st(Object.assign(Object.assign({},n),n.x),e.x),st(Object.assign(Object.assign({},n),n.y),e.y),st(Object.assign(Object.assign({},n),n.z),e.z),st(Object.assign(Object.assign({},n),n.w),e.w)]})}Pe({id:"input-point4d",type:"input",accept:(n,e)=>{if(!Ft.isObject(n))return null;const t=xe(e,r=>Object.assign(Object.assign({},sn(r)),{readonly:r.optional.constant(!1),w:r.optional.custom(dt),x:r.optional.custom(dt),y:r.optional.custom(dt),z:r.optional.custom(dt)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>wd,constraint:n=>_d(n.params,n.initialValue),equals:Ft.equals,writer:n=>bd},controller:n=>{const e=n.value,t=n.constraint,r=[n.params.x,n.params.y,n.params.z,n.params.w];return new Xr(n.document,{assembly:ns,axes:e.rawValue.getComponents().map((i,o)=>{var a;return gr({constraint:t.components[o],initialValue:i,params:yt(n.params,(a=r[o])!==null&&a!==void 0?a:{})})}),parser:ct,value:e,viewProps:n.viewProps})}});function yd(n){const e=[],t=Or(n.options);return t&&e.push(t),new nn(e)}Pe({id:"input-string",type:"input",accept:(n,e)=>{if(typeof n!="string")return null;const t=xe(e,r=>({readonly:r.optional.constant(!1),options:r.optional.custom(In)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>_o,constraint:n=>yd(n.params),writer:n=>an},controller:n=>{const e=n.document,t=n.value,r=n.constraint,i=r&&jn(r,Dn);return i?new Vt(e,{props:new J({options:i.values.value("options")}),value:t,viewProps:n.viewProps}):new jr(e,{parser:o=>o,props:J.fromObject({formatter:Dr}),value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="string"?null:n.controller.valueController instanceof Vt?new Ar(n.controller):null}});const zn={monitor:{defaultInterval:200,defaultRows:3}},rs=ee("mll");class xd{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(rs()),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("textarea");r.classList.add(rs("i")),r.style.height=`calc(var(${Po("containerUnitSize")}) * ${t.rows})`,r.readOnly=!0,t.viewProps.bindDisabled(r),this.element.appendChild(r),this.textareaElem_=r,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.textareaElem_,t=e.scrollTop===e.scrollHeight-e.clientHeight,r=[];this.value.rawValue.forEach(i=>{i!==void 0&&r.push(this.formatter_(i))}),e.textContent=r.join(`
`),t&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}}class Zr{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new xd(e,{formatter:t.formatter,rows:t.rows,value:this.value,viewProps:this.viewProps})}}const is=ee("sgl");class Pd{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(is()),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("input");r.classList.add(is("i")),r.readOnly=!0,r.type="text",t.viewProps.bindDisabled(r),this.element.appendChild(r),this.inputElement=r,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=t!==void 0?this.formatter_(t):""}onValueUpdate_(){this.update_()}}class Qr{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Pd(e,{formatter:t.formatter,value:this.value,viewProps:this.viewProps})}}Pe({id:"monitor-bool",type:"monitor",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=xe(e,r=>({readonly:r.required.constant(!0),rows:r.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>wo},controller:n=>{var e;return n.value.rawValue.length===1?new Qr(n.document,{formatter:bo,value:n.value,viewProps:n.viewProps}):new Zr(n.document,{formatter:bo,rows:(e=n.params.rows)!==null&&e!==void 0?e:zn.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}});class Cd extends br{get max(){return this.controller.valueController.props.get("max")}set max(e){this.controller.valueController.props.set("max",e)}get min(){return this.controller.valueController.props.get("min")}set min(e){this.controller.valueController.props.set("min",e)}}const ft=ee("grl");class Ed{constructor(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(ft()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.props_=t.props,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const r=e.createElementNS(qe,"svg");r.classList.add(ft("g")),r.style.height=`calc(var(${Po("containerUnitSize")}) * ${t.rows})`,this.element.appendChild(r),this.svgElem_=r;const i=e.createElementNS(qe,"polyline");this.svgElem_.appendChild(i),this.lineElem_=i;const o=e.createElement("div");o.classList.add(ft("t"),ee("tt")()),this.element.appendChild(o),this.tooltipElem_=o,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const{clientWidth:e,clientHeight:t}=this.element,r=this.value.rawValue.length-1,i=this.props_.get("min"),o=this.props_.get("max"),a=[];this.value.rawValue.forEach((g,E)=>{if(g===void 0)return;const O=ne(E,0,r,0,e),b=ne(g,i,o,t,0);a.push([O,b].join(","))}),this.lineElem_.setAttributeNS(null,"points",a.join(" "));const s=this.tooltipElem_,p=this.value.rawValue[this.cursor_.rawValue];if(p===void 0){s.classList.remove(ft("t","a"));return}const f=ne(this.cursor_.rawValue,0,r,0,e),_=ne(p,i,o,t,0);s.style.left=`${f}px`,s.style.top=`${_}px`,s.textContent=`${this.formatter_(p)}`,s.classList.contains(ft("t","a"))||(s.classList.add(ft("t","a"),ft("t","in")),On(s),s.classList.remove(ft("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class os{constructor(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.cursor_=be(-1),this.view=new Ed(e,{cursor:this.cursor_,formatter:t.formatter,rows:t.rows,props:this.props,value:this.value,viewProps:this.viewProps}),!yr(e))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const r=new xt(this.view.element);r.emitter.on("down",this.onGraphPointerDown_),r.emitter.on("move",this.onGraphPointerMove_),r.emitter.on("up",this.onGraphPointerUp_)}}importProps(e){return $e(e,null,t=>({max:t.required.number,min:t.required.number}),t=>(this.props.set("max",t.max),this.props.set("min",t.min),!0))}exportProps(){return Ke(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(e){const{clientWidth:t}=this.view.element;this.cursor_.rawValue=Math.floor(ne(e.offsetX,0,t,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){if(!e.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(ne(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function Jr(n){return de(n.format)?Ee(2):n.format}function Md(n){var e;return n.value.rawValue.length===1?new Qr(n.document,{formatter:Jr(n.params),value:n.value,viewProps:n.viewProps}):new Zr(n.document,{formatter:Jr(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:zn.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}function Sd(n){var e,t,r;return new os(n.document,{formatter:Jr(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:zn.monitor.defaultRows,props:J.fromObject({max:(t=n.params.max)!==null&&t!==void 0?t:100,min:(r=n.params.min)!==null&&r!==void 0?r:0}),value:n.value,viewProps:n.viewProps})}function ss(n){return n.view==="graph"}Pe({id:"monitor-number",type:"monitor",accept:(n,e)=>{if(typeof n!="number")return null;const t=xe(e,r=>({format:r.optional.function,max:r.optional.number,min:r.optional.number,readonly:r.required.constant(!0),rows:r.optional.number,view:r.optional.string}));return t?{initialValue:n,params:t}:null},binding:{defaultBufferSize:n=>ss(n)?64:1,reader:n=>Ni},controller:n=>ss(n.params)?Sd(n):Md(n),api:n=>n.controller.valueController instanceof os?new Cd(n.controller):null});Pe({id:"monitor-string",type:"monitor",accept:(n,e)=>{if(typeof n!="string")return null;const t=xe(e,r=>({multiline:r.optional.boolean,readonly:r.required.constant(!0),rows:r.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>_o},controller:n=>{var e;const t=n.value;return t.rawValue.length>1||n.params.multiline?new Zr(n.document,{formatter:Dr,rows:(e=n.params.rows)!==null&&e!==void 0?e:zn.monitor.defaultRows,value:t,viewProps:n.viewProps}):new Qr(n.document,{formatter:Dr,value:t,viewProps:n.viewProps})}});new io("4.0.3");var cn=Uint8Array,as=Uint16Array,Td=Uint32Array,Ld=new cn([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),kd=new cn([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ls=function(n,e){for(var t=new as(31),r=0;r<31;++r)t[r]=e+=1<<n[r-1];for(var i=new Td(t[30]),r=1;r<30;++r)for(var o=t[r];o<t[r+1];++o)i[o]=o-t[r]<<5|r;return[t,i]},us=ls(Ld,2),Ad=us[0],Od=us[1];Ad[28]=258,Od[258]=28;ls(kd,0);var Vd=new as(32768);for(var ae=0;ae<32768;++ae){var vt=(ae&43690)>>>1|(ae&21845)<<1;vt=(vt&52428)>>>2|(vt&13107)<<2,vt=(vt&61680)>>>4|(vt&3855)<<4,Vd[ae]=((vt&65280)>>>8|(vt&255)<<8)>>>1}var Hn=new cn(288);for(var ae=0;ae<144;++ae)Hn[ae]=8;for(var ae=144;ae<256;++ae)Hn[ae]=9;for(var ae=256;ae<280;++ae)Hn[ae]=7;for(var ae=280;ae<288;++ae)Hn[ae]=8;var jd=new cn(32);for(var ae=0;ae<32;++ae)jd[ae]=5;var Dd=new cn(0),Id=typeof TextDecoder<"u"&&new TextDecoder,Bd=0;try{Id.decode(Dd,{stream:!0}),Bd=1}catch{}new Is;new X;new hi(0,0,0,"YXZ");new X;var Rd=Object.defineProperty,Fd=(n,e,t)=>e in n?Rd(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,z=(n,e,t)=>(Fd(n,typeof e!="symbol"?e+"":e,t),t);const Gn=new Bs,cs=new pi,Ud=Math.cos(70*(Math.PI/180)),ds=(n,e)=>(n%e+e)%e;class Nd extends Ws{constructor(e,t){super(),z(this,"object"),z(this,"domElement"),z(this,"enabled",!0),z(this,"target",new X),z(this,"minDistance",0),z(this,"maxDistance",1/0),z(this,"minZoom",0),z(this,"maxZoom",1/0),z(this,"minPolarAngle",0),z(this,"maxPolarAngle",Math.PI),z(this,"minAzimuthAngle",-1/0),z(this,"maxAzimuthAngle",1/0),z(this,"enableDamping",!1),z(this,"dampingFactor",.05),z(this,"enableZoom",!0),z(this,"zoomSpeed",1),z(this,"enableRotate",!0),z(this,"rotateSpeed",1),z(this,"enablePan",!0),z(this,"panSpeed",1),z(this,"screenSpacePanning",!0),z(this,"keyPanSpeed",7),z(this,"zoomToCursor",!1),z(this,"autoRotate",!1),z(this,"autoRotateSpeed",2),z(this,"reverseOrbit",!1),z(this,"reverseHorizontalOrbit",!1),z(this,"reverseVerticalOrbit",!1),z(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),z(this,"mouseButtons",{LEFT:Mt.ROTATE,MIDDLE:Mt.DOLLY,RIGHT:Mt.PAN}),z(this,"touches",{ONE:ut.ROTATE,TWO:ut.DOLLY_PAN}),z(this,"target0"),z(this,"position0"),z(this,"zoom0"),z(this,"_domElementKeyEvents",null),z(this,"getPolarAngle"),z(this,"getAzimuthalAngle"),z(this,"setPolarAngle"),z(this,"setAzimuthalAngle"),z(this,"getDistance"),z(this,"listenToKeyEvents"),z(this,"stopListenToKeyEvents"),z(this,"saveState"),z(this,"reset"),z(this,"update"),z(this,"connect"),z(this,"dispose"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>_.phi,this.getAzimuthalAngle=()=>_.theta,this.setPolarAngle=x=>{let I=ds(x,2*Math.PI),N=_.phi;N<0&&(N+=2*Math.PI),I<0&&(I+=2*Math.PI);let te=Math.abs(I-N);2*Math.PI-te<te&&(I<N?I+=2*Math.PI:N+=2*Math.PI),g.phi=I-N,r.update()},this.setAzimuthalAngle=x=>{let I=ds(x,2*Math.PI),N=_.theta;N<0&&(N+=2*Math.PI),I<0&&(I+=2*Math.PI);let te=Math.abs(I-N);2*Math.PI-te<te&&(I<N?I+=2*Math.PI:N+=2*Math.PI),g.theta=I-N,r.update()},this.getDistance=()=>r.object.position.distanceTo(r.target),this.listenToKeyEvents=x=>{x.addEventListener("keydown",Xn),this._domElementKeyEvents=x},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Xn),this._domElementKeyEvents=null},this.saveState=()=>{r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=()=>{r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(i),r.update(),p=s.NONE},this.update=(()=>{const x=new X,I=new X(0,1,0),N=new er().setFromUnitVectors(e.up,I),te=N.clone().invert(),ke=new X,Ie=new er,fn=2*Math.PI;return function(){const li=r.object.position;N.setFromUnitVectors(e.up,I),te.copy(N).invert(),x.copy(li).sub(r.target),x.applyQuaternion(N),_.setFromVector3(x),r.autoRotate&&p===s.NONE&&B(k()),r.enableDamping?(_.theta+=g.theta*r.dampingFactor,_.phi+=g.phi*r.dampingFactor):(_.theta+=g.theta,_.phi+=g.phi);let Ze=r.minAzimuthAngle,Qe=r.maxAzimuthAngle;isFinite(Ze)&&isFinite(Qe)&&(Ze<-Math.PI?Ze+=fn:Ze>Math.PI&&(Ze-=fn),Qe<-Math.PI?Qe+=fn:Qe>Math.PI&&(Qe-=fn),Ze<=Qe?_.theta=Math.max(Ze,Math.min(Qe,_.theta)):_.theta=_.theta>(Ze+Qe)/2?Math.max(Ze,_.theta):Math.min(Qe,_.theta)),_.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,_.phi)),_.makeSafe(),r.enableDamping===!0?r.target.addScaledVector(O,r.dampingFactor):r.target.add(O),r.zoomToCursor&&d||r.object.isOrthographicCamera?_.radius=Ue(_.radius):_.radius=Ue(_.radius*E),x.setFromSpherical(_),x.applyQuaternion(te),li.copy(r.target).add(x),r.object.matrixAutoUpdate||r.object.updateMatrix(),r.object.lookAt(r.target),r.enableDamping===!0?(g.theta*=1-r.dampingFactor,g.phi*=1-r.dampingFactor,O.multiplyScalar(1-r.dampingFactor)):(g.set(0,0,0),O.set(0,0,0));let vn=!1;if(r.zoomToCursor&&d){let Nt=null;if(r.object instanceof Ge&&r.object.isPerspectiveCamera){const zt=x.length();Nt=Ue(zt*E);const gn=zt-Nt;r.object.position.addScaledVector(y,gn),r.object.updateMatrixWorld()}else if(r.object.isOrthographicCamera){const zt=new X(c.x,c.y,0);zt.unproject(r.object),r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/E)),r.object.updateProjectionMatrix(),vn=!0;const gn=new X(c.x,c.y,0);gn.unproject(r.object),r.object.position.sub(gn).add(zt),r.object.updateMatrixWorld(),Nt=x.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),r.zoomToCursor=!1;Nt!==null&&(r.screenSpacePanning?r.target.set(0,0,-1).transformDirection(r.object.matrix).multiplyScalar(Nt).add(r.object.position):(Gn.origin.copy(r.object.position),Gn.direction.set(0,0,-1).transformDirection(r.object.matrix),Math.abs(r.object.up.dot(Gn.direction))<Ud?e.lookAt(r.target):(cs.setFromNormalAndCoplanarPoint(r.object.up,r.target),Gn.intersectPlane(cs,r.target))))}else r.object instanceof wt&&r.object.isOrthographicCamera&&(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/E)),r.object.updateProjectionMatrix(),vn=!0);return E=1,d=!1,vn||ke.distanceToSquared(r.object.position)>f||8*(1-Ie.dot(r.object.quaternion))>f?(r.dispatchEvent(i),ke.copy(r.object.position),Ie.copy(r.object.quaternion),vn=!1,!0):!1}})(),this.connect=x=>{x===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),r.domElement=x,r.domElement.style.touchAction="none",r.domElement.addEventListener("contextmenu",oi),r.domElement.addEventListener("pointerdown",se),r.domElement.addEventListener("pointercancel",mn),r.domElement.addEventListener("wheel",ze)},this.dispose=()=>{var x,I,N,te,ke,Ie;(x=r.domElement)==null||x.removeEventListener("contextmenu",oi),(I=r.domElement)==null||I.removeEventListener("pointerdown",se),(N=r.domElement)==null||N.removeEventListener("pointercancel",mn),(te=r.domElement)==null||te.removeEventListener("wheel",ze),(ke=r.domElement)==null||ke.ownerDocument.removeEventListener("pointermove",Ve),(Ie=r.domElement)==null||Ie.ownerDocument.removeEventListener("pointerup",at),r._domElementKeyEvents!==null&&r._domElementKeyEvents.removeEventListener("keydown",Xn)};const r=this,i={type:"change"},o={type:"start"},a={type:"end"},s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let p=s.NONE;const f=1e-6,_=new gi,g=new gi;let E=1;const O=new X,b=new _e,P=new _e,M=new _e,C=new _e,S=new _e,L=new _e,T=new _e,j=new _e,v=new _e,y=new X,c=new _e;let d=!1;const u=[],m={};function k(){return 2*Math.PI/60/60*r.autoRotateSpeed}function U(){return Math.pow(.95,r.zoomSpeed)}function B(x){r.reverseOrbit||r.reverseHorizontalOrbit?g.theta+=x:g.theta-=x}function D(x){r.reverseOrbit||r.reverseVerticalOrbit?g.phi+=x:g.phi-=x}const G=(()=>{const x=new X;return function(I,N){x.setFromMatrixColumn(N,0),x.multiplyScalar(-I),O.add(x)}})(),q=(()=>{const x=new X;return function(I,N){r.screenSpacePanning===!0?x.setFromMatrixColumn(N,1):(x.setFromMatrixColumn(N,0),x.crossVectors(r.object.up,x)),x.multiplyScalar(I),O.add(x)}})(),oe=(()=>{const x=new X;return function(I,N){const te=r.domElement;if(te&&r.object instanceof Ge&&r.object.isPerspectiveCamera){const ke=r.object.position;x.copy(ke).sub(r.target);let Ie=x.length();Ie*=Math.tan(r.object.fov/2*Math.PI/180),G(2*I*Ie/te.clientHeight,r.object.matrix),q(2*N*Ie/te.clientHeight,r.object.matrix)}else te&&r.object instanceof wt&&r.object.isOrthographicCamera?(G(I*(r.object.right-r.object.left)/r.object.zoom/te.clientWidth,r.object.matrix),q(N*(r.object.top-r.object.bottom)/r.object.zoom/te.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}})();function Q(x){r.object instanceof Ge&&r.object.isPerspectiveCamera||r.object instanceof wt&&r.object.isOrthographicCamera?E/=x:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function K(x){r.object instanceof Ge&&r.object.isPerspectiveCamera||r.object instanceof wt&&r.object.isOrthographicCamera?E*=x:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function gt(x){if(!r.zoomToCursor||!r.domElement)return;d=!0;const I=r.domElement.getBoundingClientRect(),N=x.clientX-I.left,te=x.clientY-I.top,ke=I.width,Ie=I.height;c.x=N/ke*2-1,c.y=-(te/Ie)*2+1,y.set(c.x,c.y,1).unproject(r.object).sub(r.object.position).normalize()}function Ue(x){return Math.max(r.minDistance,Math.min(r.maxDistance,x))}function Xe(x){b.set(x.clientX,x.clientY)}function pe(x){gt(x),T.set(x.clientX,x.clientY)}function Le(x){C.set(x.clientX,x.clientY)}function Ne(x){P.set(x.clientX,x.clientY),M.subVectors(P,b).multiplyScalar(r.rotateSpeed);const I=r.domElement;I&&(B(2*Math.PI*M.x/I.clientHeight),D(2*Math.PI*M.y/I.clientHeight)),b.copy(P),r.update()}function R(x){j.set(x.clientX,x.clientY),v.subVectors(j,T),v.y>0?Q(U()):v.y<0&&K(U()),T.copy(j),r.update()}function l(x){S.set(x.clientX,x.clientY),L.subVectors(S,C).multiplyScalar(r.panSpeed),oe(L.x,L.y),C.copy(S),r.update()}function h(x){gt(x),x.deltaY<0?K(U()):x.deltaY>0&&Q(U()),r.update()}function w(x){let I=!1;switch(x.code){case r.keys.UP:oe(0,r.keyPanSpeed),I=!0;break;case r.keys.BOTTOM:oe(0,-r.keyPanSpeed),I=!0;break;case r.keys.LEFT:oe(r.keyPanSpeed,0),I=!0;break;case r.keys.RIGHT:oe(-r.keyPanSpeed,0),I=!0;break}I&&(x.preventDefault(),r.update())}function A(){if(u.length==1)b.set(u[0].pageX,u[0].pageY);else{const x=.5*(u[0].pageX+u[1].pageX),I=.5*(u[0].pageY+u[1].pageY);b.set(x,I)}}function V(){if(u.length==1)C.set(u[0].pageX,u[0].pageY);else{const x=.5*(u[0].pageX+u[1].pageX),I=.5*(u[0].pageY+u[1].pageY);C.set(x,I)}}function F(){const x=u[0].pageX-u[1].pageX,I=u[0].pageY-u[1].pageY,N=Math.sqrt(x*x+I*I);T.set(0,N)}function $(){r.enableZoom&&F(),r.enablePan&&V()}function re(){r.enableZoom&&F(),r.enableRotate&&A()}function le(x){if(u.length==1)P.set(x.pageX,x.pageY);else{const N=Zn(x),te=.5*(x.pageX+N.x),ke=.5*(x.pageY+N.y);P.set(te,ke)}M.subVectors(P,b).multiplyScalar(r.rotateSpeed);const I=r.domElement;I&&(B(2*Math.PI*M.x/I.clientHeight),D(2*Math.PI*M.y/I.clientHeight)),b.copy(P)}function me(x){if(u.length==1)S.set(x.pageX,x.pageY);else{const I=Zn(x),N=.5*(x.pageX+I.x),te=.5*(x.pageY+I.y);S.set(N,te)}L.subVectors(S,C).multiplyScalar(r.panSpeed),oe(L.x,L.y),C.copy(S)}function fe(x){const I=Zn(x),N=x.pageX-I.x,te=x.pageY-I.y,ke=Math.sqrt(N*N+te*te);j.set(0,ke),v.set(0,Math.pow(j.y/T.y,r.zoomSpeed)),Q(v.y),T.copy(j)}function ve(x){r.enableZoom&&fe(x),r.enablePan&&me(x)}function ue(x){r.enableZoom&&fe(x),r.enableRotate&&le(x)}function se(x){var I,N;r.enabled!==!1&&(u.length===0&&((I=r.domElement)==null||I.ownerDocument.addEventListener("pointermove",Ve),(N=r.domElement)==null||N.ownerDocument.addEventListener("pointerup",at)),xs(x),x.pointerType==="touch"?_s(x):Wn(x))}function Ve(x){r.enabled!==!1&&(x.pointerType==="touch"?ys(x):Yn(x))}function at(x){var I,N,te;si(x),u.length===0&&((I=r.domElement)==null||I.releasePointerCapture(x.pointerId),(N=r.domElement)==null||N.ownerDocument.removeEventListener("pointermove",Ve),(te=r.domElement)==null||te.ownerDocument.removeEventListener("pointerup",at)),r.dispatchEvent(a),p=s.NONE}function mn(x){si(x)}function Wn(x){let I;switch(x.button){case 0:I=r.mouseButtons.LEFT;break;case 1:I=r.mouseButtons.MIDDLE;break;case 2:I=r.mouseButtons.RIGHT;break;default:I=-1}switch(I){case Mt.DOLLY:if(r.enableZoom===!1)return;pe(x),p=s.DOLLY;break;case Mt.ROTATE:if(x.ctrlKey||x.metaKey||x.shiftKey){if(r.enablePan===!1)return;Le(x),p=s.PAN}else{if(r.enableRotate===!1)return;Xe(x),p=s.ROTATE}break;case Mt.PAN:if(x.ctrlKey||x.metaKey||x.shiftKey){if(r.enableRotate===!1)return;Xe(x),p=s.ROTATE}else{if(r.enablePan===!1)return;Le(x),p=s.PAN}break;default:p=s.NONE}p!==s.NONE&&r.dispatchEvent(o)}function Yn(x){if(r.enabled!==!1)switch(p){case s.ROTATE:if(r.enableRotate===!1)return;Ne(x);break;case s.DOLLY:if(r.enableZoom===!1)return;R(x);break;case s.PAN:if(r.enablePan===!1)return;l(x);break}}function ze(x){r.enabled===!1||r.enableZoom===!1||p!==s.NONE&&p!==s.ROTATE||(x.preventDefault(),r.dispatchEvent(o),h(x),r.dispatchEvent(a))}function Xn(x){r.enabled===!1||r.enablePan===!1||w(x)}function _s(x){switch(ai(x),u.length){case 1:switch(r.touches.ONE){case ut.ROTATE:if(r.enableRotate===!1)return;A(),p=s.TOUCH_ROTATE;break;case ut.PAN:if(r.enablePan===!1)return;V(),p=s.TOUCH_PAN;break;default:p=s.NONE}break;case 2:switch(r.touches.TWO){case ut.DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;$(),p=s.TOUCH_DOLLY_PAN;break;case ut.DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;re(),p=s.TOUCH_DOLLY_ROTATE;break;default:p=s.NONE}break;default:p=s.NONE}p!==s.NONE&&r.dispatchEvent(o)}function ys(x){switch(ai(x),p){case s.TOUCH_ROTATE:if(r.enableRotate===!1)return;le(x),r.update();break;case s.TOUCH_PAN:if(r.enablePan===!1)return;me(x),r.update();break;case s.TOUCH_DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;ve(x),r.update();break;case s.TOUCH_DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;ue(x),r.update();break;default:p=s.NONE}}function oi(x){r.enabled!==!1&&x.preventDefault()}function xs(x){u.push(x)}function si(x){delete m[x.pointerId];for(let I=0;I<u.length;I++)if(u[I].pointerId==x.pointerId){u.splice(I,1);return}}function ai(x){let I=m[x.pointerId];I===void 0&&(I=new _e,m[x.pointerId]=I),I.set(x.pageX,x.pageY)}function Zn(x){const I=x.pointerId===u[0].pointerId?u[1]:u[0];return m[I.pointerId]}t!==void 0&&this.connect(t),this.update()}}new er;new bn;new hi;new X;var zd=Object.defineProperty,Hd=(n,e,t)=>e in n?zd(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ei=(n,e,t)=>(Hd(n,typeof e!="symbol"?e+"":e,t),t);class hs{constructor(e){ei(this,"data"),this.data=e}generateShapes(e,t=100,r){const i=[],o=He({letterSpacing:0,lineHeight:1},r),a=Gd(e,t,this.data,o);for(let s=0,p=a.length;s<p;s++)Array.prototype.push.apply(i,a[s].toShapes(!1));return i}}ei(hs,"isFont");ei(hs,"type");function Gd(n,e,t,r){const i=Array.from(n),o=e/t.resolution,a=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*o,s=[];let p=0,f=0;for(let _=0;_<i.length;_++){const g=i[_];if(g===`
`)p=0,f-=a*r.lineHeight;else{const E=$d(g,o,p,f,t);E&&(p+=E.offsetX+r.letterSpacing,s.push(E.path))}}return s}function $d(n,e,t,r,i){const o=i.glyphs[n]||i.glyphs["?"];if(!o){console.error('THREE.Font: character "'+n+'" does not exists in font family '+i.familyName+".");return}const a=new na;let s,p,f,_,g,E,O,b;if(o.o){const P=o._cachedOutline||(o._cachedOutline=o.o.split(" "));for(let M=0,C=P.length;M<C;)switch(P[M++]){case"m":s=parseInt(P[M++])*e+t,p=parseInt(P[M++])*e+r,a.moveTo(s,p);break;case"l":s=parseInt(P[M++])*e+t,p=parseInt(P[M++])*e+r,a.lineTo(s,p);break;case"q":f=parseInt(P[M++])*e+t,_=parseInt(P[M++])*e+r,g=parseInt(P[M++])*e+t,E=parseInt(P[M++])*e+r,a.quadraticCurveTo(g,E,f,_);break;case"b":f=parseInt(P[M++])*e+t,_=parseInt(P[M++])*e+r,g=parseInt(P[M++])*e+t,E=parseInt(P[M++])*e+r,O=parseInt(P[M++])*e+t,b=parseInt(P[M++])*e+r,a.bezierCurveTo(g,E,O,b,f,_);break}}return{offsetX:o.ha*e,path:a}}class dn extends Ht{constructor(e,t={}){super(e),this.isReflector=!0,this.type="Reflector",this.camera=new Ge;const r=this,i=t.color!==void 0?new lt(t.color):new lt(8355711),o=t.textureWidth||512,a=t.textureHeight||512,s=t.clipBias||0,p=t.shader||dn.ReflectorShader,f=t.multisample!==void 0?t.multisample:4,_=new pi,g=new X,E=new X,O=new X,b=new bn,P=new X(0,0,-1),M=new bt,C=new X,S=new X,L=new bt,T=new bn,j=this.camera,v=new Ys(o,a,{samples:f,type:Xs}),y=new nr({name:p.name!==void 0?p.name:"unspecified",uniforms:tr.clone(p.uniforms),fragmentShader:p.fragmentShader,vertexShader:p.vertexShader});y.uniforms.tDiffuse.value=v.texture,y.uniforms.color.value=i,y.uniforms.textureMatrix.value=T,this.material=y,this.onBeforeRender=function(c,d,u){if(E.setFromMatrixPosition(r.matrixWorld),O.setFromMatrixPosition(u.matrixWorld),b.extractRotation(r.matrixWorld),g.set(0,0,1),g.applyMatrix4(b),C.subVectors(E,O),C.dot(g)>0)return;C.reflect(g).negate(),C.add(E),b.extractRotation(u.matrixWorld),P.set(0,0,-1),P.applyMatrix4(b),P.add(O),S.subVectors(E,P),S.reflect(g).negate(),S.add(E),j.position.copy(C),j.up.set(0,1,0),j.up.applyMatrix4(b),j.up.reflect(g),j.lookAt(S),j.far=u.far,j.updateMatrixWorld(),j.projectionMatrix.copy(u.projectionMatrix),T.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),T.multiply(j.projectionMatrix),T.multiply(j.matrixWorldInverse),T.multiply(r.matrixWorld),_.setFromNormalAndCoplanarPoint(g,E),_.applyMatrix4(j.matrixWorldInverse),M.set(_.normal.x,_.normal.y,_.normal.z,_.constant);const m=j.projectionMatrix;L.x=(Math.sign(M.x)+m.elements[8])/m.elements[0],L.y=(Math.sign(M.y)+m.elements[9])/m.elements[5],L.z=-1,L.w=(1+m.elements[10])/m.elements[14],M.multiplyScalar(2/M.dot(L)),m.elements[2]=M.x,m.elements[6]=M.y,m.elements[10]=M.z+1-s,m.elements[14]=M.w,r.visible=!1;const k=c.getRenderTarget(),U=c.xr.enabled,B=c.shadowMap.autoUpdate;c.xr.enabled=!1,c.shadowMap.autoUpdate=!1,c.setRenderTarget(v),c.state.buffers.depth.setMask(!0),c.autoClear===!1&&c.clear(),c.render(d,j),c.xr.enabled=U,c.shadowMap.autoUpdate=B,c.setRenderTarget(k);const D=u.viewport;D!==void 0&&c.state.viewport(D),r.visible=!0},this.getRenderTarget=function(){return v},this.dispose=function(){v.dispose(),r.material.dispose()}}}dn.ReflectorShader={name:"ReflectorShader",uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:`
		uniform mat4 textureMatrix;
		varying vec4 vUv;

		#include <common>
		#include <logdepthbuf_pars_vertex>

		void main() {

			vUv = textureMatrix * vec4( position, 1.0 );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

			#include <logdepthbuf_vertex>

		}`,fragmentShader:`
		uniform vec3 color;
		uniform sampler2D tDiffuse;
		varying vec4 vUv;

		#include <logdepthbuf_pars_fragment>

		float blendOverlay( float base, float blend ) {

			return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );

		}

		vec3 blendOverlay( vec3 base, vec3 blend ) {

			return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );

		}

		void main() {

			#include <logdepthbuf_fragment>

			vec4 base = texture2DProj( tDiffuse, vUv );
			gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>

		}`};const Kd=["args","material-uniforms-color-value"],qd=ma("TresPlaneGeometry",{args:[5,5]},null,-1);dn.ReflectorShader;function Wd(n){return _i()?(yi(n),!0):!1}function ps(n){return typeof n=="function"?n():W(n)}const Yd=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Xd=Object.prototype.toString,Zd=n=>Xd.call(n)==="[object Object]",Qd=()=>{};function Jd(n){var e;const t=ps(n);return(e=t==null?void 0:t.$el)!=null?e:t}const eh=Yd?window:void 0;function hn(...n){let e,t,r,i;if(typeof n[0]=="string"||Array.isArray(n[0])?([t,r,i]=n,e=eh):[e,t,r,i]=n,!e)return Qd;Array.isArray(t)||(t=[t]),Array.isArray(r)||(r=[r]);const o=[],a=()=>{o.forEach(_=>_()),o.length=0},s=(_,g,E,O)=>(_.addEventListener(g,E,O),()=>_.removeEventListener(g,E,O)),p=ye(()=>[Jd(e),ps(i)],([_,g])=>{if(a(),!_)return;const E=Zd(g)?He({},g):g;o.push(...t.flatMap(O=>r.map(b=>s(_,O,b,E))))},{immediate:!0,flush:"post"}),f=()=>{p(),a()};return Wd(f),f}Je({name:"GlobalAudio",props:["src","loop","volume","playbackRate","playTrigger","stopTrigger"],async setup(n,{expose:e,emit:t}){var E,O;var r;const{camera:i,renderer:o}=Wt(),a=new Rs;(r=i.value)==null||r.add(a);const s=new Fs(a),p=new Us;e({sound:s}),et(()=>{s&&s.disconnect()}),ye(()=>[n.playbackRate],()=>{var b;return s.setPlaybackRate((b=n.playbackRate)!=null?b:1)},{immediate:!0}),ye(()=>[n.volume],()=>{var b;return s.setVolume((b=n.volume)!=null?b:.5)},{immediate:!0}),ye(()=>[n.loop],()=>{var b;return s.setLoop((b=n.loop)!=null?b:!1)},{immediate:!0}),ye(()=>[n.src],async()=>{const b=await p.loadAsync(n.src);s.setBuffer(b)},{immediate:!0});const f=document.getElementById((E=n.playTrigger)!=null?E:""),_=f||o.value.domElement;hn(_,"click",()=>{s.isPlaying?s.pause():s.play(),t("isPlaying",s.isPlaying)});const g=document.getElementById((O=n.stopTrigger)!=null?O:"");return g&&hn(g,"click",()=>{s.stop(),t("isPlaying",s.isPlaying)}),null}});class $n extends Ht{constructor(){super($n.Geometry,new Zs({opacity:0,transparent:!0})),this.isLensflare=!0,this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;const e=new X,t=new X,r=new wi(16,16),i=new wi(16,16);let o=bi;const a=$n.Geometry,s=new rr({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:`

				precision highp float;

				uniform vec3 screenPosition;
				uniform vec2 scale;

				attribute vec3 position;

				void main() {

					gl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );

				}`,fragmentShader:`

				precision highp float;

				void main() {

					gl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );

				}`,depthTest:!0,depthWrite:!1,transparent:!1}),p=new rr({uniforms:{map:{value:r},scale:{value:null},screenPosition:{value:null}},vertexShader:`

				precision highp float;

				uniform vec3 screenPosition;
				uniform vec2 scale;

				attribute vec3 position;
				attribute vec2 uv;

				varying vec2 vUV;

				void main() {

					vUV = uv;

					gl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );

				}`,fragmentShader:`

				precision highp float;

				uniform sampler2D map;

				varying vec2 vUV;

				void main() {

					gl_FragColor = texture2D( map, vUV );

				}`,depthTest:!1,depthWrite:!1,transparent:!1}),f=new Ht(a,s),_=[],g=ms.Shader,E=new rr({name:g.name,uniforms:{map:{value:null},occlusionMap:{value:i},color:{value:new lt(16777215)},scale:{value:new _e},screenPosition:{value:new X}},vertexShader:g.vertexShader,fragmentShader:g.fragmentShader,blending:Qs,transparent:!0,depthWrite:!1}),O=new Ht(a,E);this.addElement=function(S){_.push(S)};const b=new _e,P=new _e,M=new Js,C=new bt;this.onBeforeRender=function(S,L,T){S.getCurrentViewport(C);const j=S.getRenderTarget(),v=j!==null?j.texture.type:bi;o!==v&&(r.dispose(),i.dispose(),r.type=i.type=v,o=v);const y=C.w/C.z,c=C.z/2,d=C.w/2;let u=16/C.w;if(b.set(u*y,u),M.min.set(C.x,C.y),M.max.set(C.x+(C.z-16),C.y+(C.w-16)),t.setFromMatrixPosition(this.matrixWorld),t.applyMatrix4(T.matrixWorldInverse),!(t.z>0)&&(e.copy(t).applyMatrix4(T.projectionMatrix),P.x=C.x+e.x*c+c-8,P.y=C.y+e.y*d+d-8,M.containsPoint(P))){S.copyFramebufferToTexture(P,r);let m=s.uniforms;m.scale.value=b,m.screenPosition.value=e,S.renderBufferDirect(T,null,a,s,f,null),S.copyFramebufferToTexture(P,i),m=p.uniforms,m.scale.value=b,m.screenPosition.value=e,S.renderBufferDirect(T,null,a,p,f,null);const k=-e.x*2,U=-e.y*2;for(let B=0,D=_.length;B<D;B++){const G=_[B],q=E.uniforms;q.color.value.copy(G.color),q.map.value=G.texture,q.screenPosition.value.x=e.x+k*G.distance,q.screenPosition.value.y=e.y+U*G.distance,u=G.size/C.w;const oe=C.w/C.z;q.scale.value.set(u*oe,u),E.uniformsNeedUpdate=!0,S.renderBufferDirect(T,null,a,E,O,null)}}},this.dispose=function(){s.dispose(),p.dispose(),E.dispose(),r.dispose(),i.dispose();for(let S=0,L=_.length;S<L;S++)_[S].texture.dispose()}}}class ms{constructor(e,t=1,r=0,i=new lt(16777215)){this.texture=e,this.size=t,this.distance=r,this.color=i}}ms.Shader={name:"LensflareElementShader",uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:`

		precision highp float;

		uniform vec3 screenPosition;
		uniform vec2 scale;

		uniform sampler2D occlusionMap;

		attribute vec3 position;
		attribute vec2 uv;

		varying vec2 vUV;
		varying float vVisibility;

		void main() {

			vUV = uv;

			vec2 pos = position.xy;

			vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );

			vVisibility =        visibility.r / 9.0;
			vVisibility *= 1.0 - visibility.g / 9.0;
			vVisibility *=       visibility.b / 9.0;

			gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );

		}`,fragmentShader:`

		precision highp float;

		uniform sampler2D map;
		uniform vec3 color;

		varying vec2 vUV;
		varying float vVisibility;

		void main() {

			vec4 texture = texture2D( map, vUV );
			texture.a *= vVisibility;
			gl_FragColor = texture;
			gl_FragColor.rgb *= color;

		}`};$n.Geometry=function(){const n=new Ns,e=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),t=new zs(e,5);return n.setIndex([0,1,2,0,2,3]),n.setAttribute("position",new mi(t,3,0,!1)),n.setAttribute("uv",new mi(t,2,3,!1)),n}();fi.clamp;fi.lerp;const th=["target","auto-rotate","auto-rotate-speed","enable-damping","damping-factor","enable-pan","key-pan-speed","keys","max-azimuth-angle","min-azimuth-angle","max-polar-angle","min-polar-angle","min-distance","max-distance","min-zoom","max-zoom","touches","enable-zoom","zoom-speed","enable-rotate","rotate-speed","args"],nh=Je({__name:"OrbitControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},target:{default:()=>[0,0,0]},enableDamping:{type:Boolean,default:!1},dampingFactor:{default:.05},autoRotate:{type:Boolean,default:!1},autoRotateSpeed:{default:2},enablePan:{type:Boolean,default:!0},keyPanSpeed:{default:7},keys:{},maxAzimuthAngle:{default:1/0},minAzimuthAngle:{default:-1/0},maxPolarAngle:{default:Math.PI},minPolarAngle:{default:0},minDistance:{default:0},maxDistance:{default:1/0},minZoom:{default:0},maxZoom:{default:1/0},touches:{default:()=>({ONE:ut.ROTATE,TWO:ut.DOLLY_PAN})},enableZoom:{type:Boolean,default:!0},zoomSpeed:{default:1},enableRotate:{type:Boolean,default:!0},rotateSpeed:{default:1}},emits:["change","start","end"],setup(n,{expose:e,emit:t}){const r=n,i=t,{makeDefault:o,autoRotate:a,autoRotateSpeed:s,enableDamping:p,dampingFactor:f,enablePan:_,keyPanSpeed:g,maxAzimuthAngle:E,minAzimuthAngle:O,maxPolarAngle:b,minPolarAngle:P,minDistance:M,maxDistance:C,minZoom:S,maxZoom:L,enableZoom:T,zoomSpeed:j,enableRotate:v,touches:y,rotateSpeed:c,target:d}=yn(r),{camera:u,renderer:m,extend:k,controls:U}=Wt(),B=Y(null);k({OrbitControls:Nd}),ye(B,q=>{D(),q&&o.value?U.value=q:U.value=null});function D(){hn(B.value,"change",()=>i("change",B.value)),hn(B.value,"start",()=>i("start",B.value)),hn(B.value,"end",()=>i("end",B.value))}const{onLoop:G}=At();return G(()=>{B.value&&(p.value||a.value)&&B.value.update()}),et(()=>{B.value&&B.value.dispose()}),e({value:B}),(q,oe)=>(q.camera||W(u))&&(q.domElement||W(m))?(Tt(),Lt("TresOrbitControls",{key:0,ref_key:"controlsRef",ref:B,target:W(d),"auto-rotate":W(a),"auto-rotate-speed":W(s),"enable-damping":W(p),"damping-factor":W(f),"enable-pan":W(_),"key-pan-speed":W(g),keys:q.keys,"max-azimuth-angle":W(E),"min-azimuth-angle":W(O),"max-polar-angle":W(b),"min-polar-angle":W(P),"min-distance":W(M),"max-distance":W(C),"min-zoom":W(S),"max-zoom":W(L),touches:W(y),"enable-zoom":W(T),"zoom-speed":W(j),"enable-rotate":W(v),"rotate-speed":W(c),args:[q.camera||W(u),q.domElement||W(m).domElement]},null,8,th)):Ei("",!0)}});/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768});const rh=typeof window<"u";rh&&/Mac/.test(navigator.platform);var ih=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function oh(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Kn(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var fs={exports:{}};(function(n,e){(function(t){n.exports=t()})(function(){return function t(r,i,o){function a(f,_){if(!i[f]){if(!r[f]){var g=typeof Kn=="function"&&Kn;if(!_&&g)return g(f,!0);if(s)return s(f,!0);throw new Error("Cannot find module '"+f+"'")}_=i[f]={exports:{}},r[f][0].call(_.exports,function(E){var O=r[f][1][E];return a(O||E)},_,_.exports,t,r,i,o)}return i[f].exports}for(var s=typeof Kn=="function"&&Kn,p=0;p<o.length;p++)a(o[p]);return a}({1:[function(t,r,i){(function(o,a,s,p,f,_,g,E,O){var b=t("crypto");function P(v,y){y=S(v,y);var c;return(c=y.algorithm!=="passthrough"?b.createHash(y.algorithm):new j).write===void 0&&(c.write=c.update,c.end=c.update),T(y,c).dispatch(v),c.update||c.end(""),c.digest?c.digest(y.encoding==="buffer"?void 0:y.encoding):(v=c.read(),y.encoding!=="buffer"?v.toString(y.encoding):v)}(i=r.exports=P).sha1=function(v){return P(v)},i.keys=function(v){return P(v,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},i.MD5=function(v){return P(v,{algorithm:"md5",encoding:"hex"})},i.keysMD5=function(v){return P(v,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var M=b.getHashes?b.getHashes().slice():["sha1","md5"],C=(M.push("passthrough"),["buffer","hex","binary","base64"]);function S(v,y){var c={};if(c.algorithm=(y=y||{}).algorithm||"sha1",c.encoding=y.encoding||"hex",c.excludeValues=!!y.excludeValues,c.algorithm=c.algorithm.toLowerCase(),c.encoding=c.encoding.toLowerCase(),c.ignoreUnknown=y.ignoreUnknown===!0,c.respectType=y.respectType!==!1,c.respectFunctionNames=y.respectFunctionNames!==!1,c.respectFunctionProperties=y.respectFunctionProperties!==!1,c.unorderedArrays=y.unorderedArrays===!0,c.unorderedSets=y.unorderedSets!==!1,c.unorderedObjects=y.unorderedObjects!==!1,c.replacer=y.replacer||void 0,c.excludeKeys=y.excludeKeys||void 0,v===void 0)throw new Error("Object argument required.");for(var d=0;d<M.length;++d)M[d].toLowerCase()===c.algorithm.toLowerCase()&&(c.algorithm=M[d]);if(M.indexOf(c.algorithm)===-1)throw new Error('Algorithm "'+c.algorithm+'"  not supported. supported values: '+M.join(", "));if(C.indexOf(c.encoding)===-1&&c.algorithm!=="passthrough")throw new Error('Encoding "'+c.encoding+'"  not supported. supported values: '+C.join(", "));return c}function L(v){if(typeof v=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(v))!=null}function T(v,y,c){c=c||[];function d(u){return y.update?y.update(u,"utf8"):y.write(u,"utf8")}return{dispatch:function(u){return this["_"+((u=v.replacer?v.replacer(u):u)===null?"null":typeof u)](u)},_object:function(u){var m,k=Object.prototype.toString.call(u),U=/\[object (.*)\]/i.exec(k);if(U=(U=U?U[1]:"unknown:["+k+"]").toLowerCase(),0<=(k=c.indexOf(u)))return this.dispatch("[CIRCULAR:"+k+"]");if(c.push(u),s!==void 0&&s.isBuffer&&s.isBuffer(u))return d("buffer:"),d(u);if(U==="object"||U==="function"||U==="asyncfunction")return k=Object.keys(u),v.unorderedObjects&&(k=k.sort()),v.respectType===!1||L(u)||k.splice(0,0,"prototype","__proto__","constructor"),v.excludeKeys&&(k=k.filter(function(B){return!v.excludeKeys(B)})),d("object:"+k.length+":"),m=this,k.forEach(function(B){m.dispatch(B),d(":"),v.excludeValues||m.dispatch(u[B]),d(",")});if(!this["_"+U]){if(v.ignoreUnknown)return d("["+U+"]");throw new Error('Unknown object type "'+U+'"')}this["_"+U](u)},_array:function(u,m){m=m!==void 0?m:v.unorderedArrays!==!1;var k=this;if(d("array:"+u.length+":"),!m||u.length<=1)return u.forEach(function(B){return k.dispatch(B)});var U=[],m=u.map(function(B){var D=new j,G=c.slice();return T(v,D,G).dispatch(B),U=U.concat(G.slice(c.length)),D.read().toString()});return c=c.concat(U),m.sort(),this._array(m,!1)},_date:function(u){return d("date:"+u.toJSON())},_symbol:function(u){return d("symbol:"+u.toString())},_error:function(u){return d("error:"+u.toString())},_boolean:function(u){return d("bool:"+u.toString())},_string:function(u){d("string:"+u.length+":"),d(u.toString())},_function:function(u){d("fn:"),L(u)?this.dispatch("[native]"):this.dispatch(u.toString()),v.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(u.name)),v.respectFunctionProperties&&this._object(u)},_number:function(u){return d("number:"+u.toString())},_xml:function(u){return d("xml:"+u.toString())},_null:function(){return d("Null")},_undefined:function(){return d("Undefined")},_regexp:function(u){return d("regex:"+u.toString())},_uint8array:function(u){return d("uint8array:"),this.dispatch(Array.prototype.slice.call(u))},_uint8clampedarray:function(u){return d("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(u))},_int8array:function(u){return d("int8array:"),this.dispatch(Array.prototype.slice.call(u))},_uint16array:function(u){return d("uint16array:"),this.dispatch(Array.prototype.slice.call(u))},_int16array:function(u){return d("int16array:"),this.dispatch(Array.prototype.slice.call(u))},_uint32array:function(u){return d("uint32array:"),this.dispatch(Array.prototype.slice.call(u))},_int32array:function(u){return d("int32array:"),this.dispatch(Array.prototype.slice.call(u))},_float32array:function(u){return d("float32array:"),this.dispatch(Array.prototype.slice.call(u))},_float64array:function(u){return d("float64array:"),this.dispatch(Array.prototype.slice.call(u))},_arraybuffer:function(u){return d("arraybuffer:"),this.dispatch(new Uint8Array(u))},_url:function(u){return d("url:"+u.toString())},_map:function(u){return d("map:"),u=Array.from(u),this._array(u,v.unorderedSets!==!1)},_set:function(u){return d("set:"),u=Array.from(u),this._array(u,v.unorderedSets!==!1)},_file:function(u){return d("file:"),this.dispatch([u.name,u.size,u.type,u.lastModfied])},_blob:function(){if(v.ignoreUnknown)return d("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return d("domwindow")},_bigint:function(u){return d("bigint:"+u.toString())},_process:function(){return d("process")},_timer:function(){return d("timer")},_pipe:function(){return d("pipe")},_tcp:function(){return d("tcp")},_udp:function(){return d("udp")},_tty:function(){return d("tty")},_statwatcher:function(){return d("statwatcher")},_securecontext:function(){return d("securecontext")},_connection:function(){return d("connection")},_zlib:function(){return d("zlib")},_context:function(){return d("context")},_nodescript:function(){return d("nodescript")},_httpparser:function(){return d("httpparser")},_dataview:function(){return d("dataview")},_signal:function(){return d("signal")},_fsevent:function(){return d("fsevent")},_tlswrap:function(){return d("tlswrap")}}}function j(){return{buf:"",write:function(v){this.buf+=v},end:function(v){this.buf+=v},read:function(){return this.buf}}}i.writeToStream=function(v,y,c){return c===void 0&&(c=y,y={}),T(y=S(v,y),c).dispatch(v)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(t,r,i){(function(o,a,s,p,f,_,g,E,O){(function(b){var P=typeof Uint8Array<"u"?Uint8Array:Array,M=43,C=47,S=48,L=97,T=65,j=45,v=95;function y(c){return c=c.charCodeAt(0),c===M||c===j?62:c===C||c===v?63:c<S?-1:c<S+10?c-S+26+26:c<T+26?c-T:c<L+26?c-L+26:void 0}b.toByteArray=function(c){var d,u;if(0<c.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var m=c.length,m=c.charAt(m-2)==="="?2:c.charAt(m-1)==="="?1:0,k=new P(3*c.length/4-m),U=0<m?c.length-4:c.length,B=0;function D(G){k[B++]=G}for(d=0;d<U;d+=4,0)D((16711680&(u=y(c.charAt(d))<<18|y(c.charAt(d+1))<<12|y(c.charAt(d+2))<<6|y(c.charAt(d+3))))>>16),D((65280&u)>>8),D(255&u);return m==2?D(255&(u=y(c.charAt(d))<<2|y(c.charAt(d+1))>>4)):m==1&&(D((u=y(c.charAt(d))<<10|y(c.charAt(d+1))<<4|y(c.charAt(d+2))>>2)>>8&255),D(255&u)),k},b.fromByteArray=function(c){var d,u,m,k,U=c.length%3,B="";function D(G){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(G)}for(d=0,m=c.length-U;d<m;d+=3)u=(c[d]<<16)+(c[d+1]<<8)+c[d+2],B+=D((k=u)>>18&63)+D(k>>12&63)+D(k>>6&63)+D(63&k);switch(U){case 1:B=(B+=D((u=c[c.length-1])>>2))+D(u<<4&63)+"==";break;case 2:B=(B=(B+=D((u=(c[c.length-2]<<8)+c[c.length-1])>>10))+D(u>>4&63))+D(u<<2&63)+"="}return B}})(i===void 0?this.base64js={}:i)}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(t,r,i){(function(o,a,s,p,f,_,g,E,O){var b=t("base64-js"),P=t("ieee754");function s(l,h,w){if(!(this instanceof s))return new s(l,h,w);var A,V,F,$,re=typeof l;if(h==="base64"&&re=="string")for(l=($=l).trim?$.trim():$.replace(/^\s+|\s+$/g,"");l.length%4!=0;)l+="=";if(re=="number")A=q(l);else if(re=="string")A=s.byteLength(l,h);else{if(re!="object")throw new Error("First argument needs to be a number, array or string.");A=q(l.length)}if(s._useTypedArrays?V=s._augment(new Uint8Array(A)):((V=this).length=A,V._isBuffer=!0),s._useTypedArrays&&typeof l.byteLength=="number")V._set(l);else if(oe($=l)||s.isBuffer($)||$&&typeof $=="object"&&typeof $.length=="number")for(F=0;F<A;F++)s.isBuffer(l)?V[F]=l.readUInt8(F):V[F]=l[F];else if(re=="string")V.write(l,0,h);else if(re=="number"&&!s._useTypedArrays&&!w)for(F=0;F<A;F++)V[F]=0;return V}function M(l,h,w,A){return s._charsWritten=Ue(function(V){for(var F=[],$=0;$<V.length;$++)F.push(255&V.charCodeAt($));return F}(h),l,w,A)}function C(l,h,w,A){return s._charsWritten=Ue(function(V){for(var F,$,re=[],le=0;le<V.length;le++)$=V.charCodeAt(le),F=$>>8,$=$%256,re.push($),re.push(F);return re}(h),l,w,A)}function S(l,h,w){var A="";w=Math.min(l.length,w);for(var V=h;V<w;V++)A+=String.fromCharCode(l[V]);return A}function L(l,h,w,A){A||(R(typeof w=="boolean","missing or invalid endian"),R(h!=null,"missing offset"),R(h+1<l.length,"Trying to read beyond buffer length"));var V,A=l.length;if(!(A<=h))return w?(V=l[h],h+1<A&&(V|=l[h+1]<<8)):(V=l[h]<<8,h+1<A&&(V|=l[h+1])),V}function T(l,h,w,A){A||(R(typeof w=="boolean","missing or invalid endian"),R(h!=null,"missing offset"),R(h+3<l.length,"Trying to read beyond buffer length"));var V,A=l.length;if(!(A<=h))return w?(h+2<A&&(V=l[h+2]<<16),h+1<A&&(V|=l[h+1]<<8),V|=l[h],h+3<A&&(V+=l[h+3]<<24>>>0)):(h+1<A&&(V=l[h+1]<<16),h+2<A&&(V|=l[h+2]<<8),h+3<A&&(V|=l[h+3]),V+=l[h]<<24>>>0),V}function j(l,h,w,A){if(A||(R(typeof w=="boolean","missing or invalid endian"),R(h!=null,"missing offset"),R(h+1<l.length,"Trying to read beyond buffer length")),!(l.length<=h))return A=L(l,h,w,!0),32768&A?-1*(65535-A+1):A}function v(l,h,w,A){if(A||(R(typeof w=="boolean","missing or invalid endian"),R(h!=null,"missing offset"),R(h+3<l.length,"Trying to read beyond buffer length")),!(l.length<=h))return A=T(l,h,w,!0),2147483648&A?-1*(4294967295-A+1):A}function y(l,h,w,A){return A||(R(typeof w=="boolean","missing or invalid endian"),R(h+3<l.length,"Trying to read beyond buffer length")),P.read(l,h,w,23,4)}function c(l,h,w,A){return A||(R(typeof w=="boolean","missing or invalid endian"),R(h+7<l.length,"Trying to read beyond buffer length")),P.read(l,h,w,52,8)}function d(l,h,w,A,V){if(V||(R(h!=null,"missing value"),R(typeof A=="boolean","missing or invalid endian"),R(w!=null,"missing offset"),R(w+1<l.length,"trying to write beyond buffer length"),pe(h,65535)),V=l.length,!(V<=w))for(var F=0,$=Math.min(V-w,2);F<$;F++)l[w+F]=(h&255<<8*(A?F:1-F))>>>8*(A?F:1-F)}function u(l,h,w,A,V){if(V||(R(h!=null,"missing value"),R(typeof A=="boolean","missing or invalid endian"),R(w!=null,"missing offset"),R(w+3<l.length,"trying to write beyond buffer length"),pe(h,4294967295)),V=l.length,!(V<=w))for(var F=0,$=Math.min(V-w,4);F<$;F++)l[w+F]=h>>>8*(A?F:3-F)&255}function m(l,h,w,A,V){V||(R(h!=null,"missing value"),R(typeof A=="boolean","missing or invalid endian"),R(w!=null,"missing offset"),R(w+1<l.length,"Trying to write beyond buffer length"),Le(h,32767,-32768)),l.length<=w||d(l,0<=h?h:65535+h+1,w,A,V)}function k(l,h,w,A,V){V||(R(h!=null,"missing value"),R(typeof A=="boolean","missing or invalid endian"),R(w!=null,"missing offset"),R(w+3<l.length,"Trying to write beyond buffer length"),Le(h,2147483647,-2147483648)),l.length<=w||u(l,0<=h?h:4294967295+h+1,w,A,V)}function U(l,h,w,A,V){V||(R(h!=null,"missing value"),R(typeof A=="boolean","missing or invalid endian"),R(w!=null,"missing offset"),R(w+3<l.length,"Trying to write beyond buffer length"),Ne(h,34028234663852886e22,-34028234663852886e22)),l.length<=w||P.write(l,h,w,A,23,4)}function B(l,h,w,A,V){V||(R(h!=null,"missing value"),R(typeof A=="boolean","missing or invalid endian"),R(w!=null,"missing offset"),R(w+7<l.length,"Trying to write beyond buffer length"),Ne(h,17976931348623157e292,-17976931348623157e292)),l.length<=w||P.write(l,h,w,A,52,8)}i.Buffer=s,i.SlowBuffer=s,i.INSPECT_MAX_BYTES=50,s.poolSize=8192,s._useTypedArrays=function(){try{var l=new ArrayBuffer(0),h=new Uint8Array(l);return h.foo=function(){return 42},h.foo()===42&&typeof h.subarray=="function"}catch{return!1}}(),s.isEncoding=function(l){switch(String(l).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.isBuffer=function(l){return!(l==null||!l._isBuffer)},s.byteLength=function(l,h){var w;switch(l+="",h||"utf8"){case"hex":w=l.length/2;break;case"utf8":case"utf-8":w=K(l).length;break;case"ascii":case"binary":case"raw":w=l.length;break;case"base64":w=gt(l).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":w=2*l.length;break;default:throw new Error("Unknown encoding")}return w},s.concat=function(l,h){if(R(oe(l),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),l.length===0)return new s(0);if(l.length===1)return l[0];if(typeof h!="number")for(V=h=0;V<l.length;V++)h+=l[V].length;for(var w=new s(h),A=0,V=0;V<l.length;V++){var F=l[V];F.copy(w,A),A+=F.length}return w},s.prototype.write=function(l,h,w,A){isFinite(h)?isFinite(w)||(A=w,w=void 0):(le=A,A=h,h=w,w=le),h=Number(h)||0;var V,F,$,re,le=this.length-h;switch((!w||le<(w=Number(w)))&&(w=le),A=String(A||"utf8").toLowerCase()){case"hex":V=function(me,fe,ve,ue){ve=Number(ve)||0;var se=me.length-ve;(!ue||se<(ue=Number(ue)))&&(ue=se),R((se=fe.length)%2==0,"Invalid hex string"),se/2<ue&&(ue=se/2);for(var Ve=0;Ve<ue;Ve++){var at=parseInt(fe.substr(2*Ve,2),16);R(!isNaN(at),"Invalid hex string"),me[ve+Ve]=at}return s._charsWritten=2*Ve,Ve}(this,l,h,w);break;case"utf8":case"utf-8":F=this,$=h,re=w,V=s._charsWritten=Ue(K(l),F,$,re);break;case"ascii":case"binary":V=M(this,l,h,w);break;case"base64":F=this,$=h,re=w,V=s._charsWritten=Ue(gt(l),F,$,re);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":V=C(this,l,h,w);break;default:throw new Error("Unknown encoding")}return V},s.prototype.toString=function(l,h,w){var A,V,F,$,re=this;if(l=String(l||"utf8").toLowerCase(),h=Number(h)||0,(w=w!==void 0?Number(w):re.length)===h)return"";switch(l){case"hex":A=function(le,me,fe){var ve=le.length;(!me||me<0)&&(me=0),(!fe||fe<0||ve<fe)&&(fe=ve);for(var ue="",se=me;se<fe;se++)ue+=Q(le[se]);return ue}(re,h,w);break;case"utf8":case"utf-8":A=function(le,me,fe){var ve="",ue="";fe=Math.min(le.length,fe);for(var se=me;se<fe;se++)le[se]<=127?(ve+=Xe(ue)+String.fromCharCode(le[se]),ue=""):ue+="%"+le[se].toString(16);return ve+Xe(ue)}(re,h,w);break;case"ascii":case"binary":A=S(re,h,w);break;case"base64":V=re,$=w,A=(F=h)===0&&$===V.length?b.fromByteArray(V):b.fromByteArray(V.slice(F,$));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":A=function(le,me,fe){for(var ve=le.slice(me,fe),ue="",se=0;se<ve.length;se+=2)ue+=String.fromCharCode(ve[se]+256*ve[se+1]);return ue}(re,h,w);break;default:throw new Error("Unknown encoding")}return A},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.copy=function(l,h,w,A){if(h=h||0,(A=A||A===0?A:this.length)!==(w=w||0)&&l.length!==0&&this.length!==0){R(w<=A,"sourceEnd < sourceStart"),R(0<=h&&h<l.length,"targetStart out of bounds"),R(0<=w&&w<this.length,"sourceStart out of bounds"),R(0<=A&&A<=this.length,"sourceEnd out of bounds"),A>this.length&&(A=this.length);var V=(A=l.length-h<A-w?l.length-h+w:A)-w;if(V<100||!s._useTypedArrays)for(var F=0;F<V;F++)l[F+h]=this[F+w];else l._set(this.subarray(w,w+V),h)}},s.prototype.slice=function(l,h){var w=this.length;if(l=G(l,w,0),h=G(h,w,w),s._useTypedArrays)return s._augment(this.subarray(l,h));for(var A=h-l,V=new s(A,void 0,!0),F=0;F<A;F++)V[F]=this[F+l];return V},s.prototype.get=function(l){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(l)},s.prototype.set=function(l,h){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(l,h)},s.prototype.readUInt8=function(l,h){if(h||(R(l!=null,"missing offset"),R(l<this.length,"Trying to read beyond buffer length")),!(l>=this.length))return this[l]},s.prototype.readUInt16LE=function(l,h){return L(this,l,!0,h)},s.prototype.readUInt16BE=function(l,h){return L(this,l,!1,h)},s.prototype.readUInt32LE=function(l,h){return T(this,l,!0,h)},s.prototype.readUInt32BE=function(l,h){return T(this,l,!1,h)},s.prototype.readInt8=function(l,h){if(h||(R(l!=null,"missing offset"),R(l<this.length,"Trying to read beyond buffer length")),!(l>=this.length))return 128&this[l]?-1*(255-this[l]+1):this[l]},s.prototype.readInt16LE=function(l,h){return j(this,l,!0,h)},s.prototype.readInt16BE=function(l,h){return j(this,l,!1,h)},s.prototype.readInt32LE=function(l,h){return v(this,l,!0,h)},s.prototype.readInt32BE=function(l,h){return v(this,l,!1,h)},s.prototype.readFloatLE=function(l,h){return y(this,l,!0,h)},s.prototype.readFloatBE=function(l,h){return y(this,l,!1,h)},s.prototype.readDoubleLE=function(l,h){return c(this,l,!0,h)},s.prototype.readDoubleBE=function(l,h){return c(this,l,!1,h)},s.prototype.writeUInt8=function(l,h,w){w||(R(l!=null,"missing value"),R(h!=null,"missing offset"),R(h<this.length,"trying to write beyond buffer length"),pe(l,255)),h>=this.length||(this[h]=l)},s.prototype.writeUInt16LE=function(l,h,w){d(this,l,h,!0,w)},s.prototype.writeUInt16BE=function(l,h,w){d(this,l,h,!1,w)},s.prototype.writeUInt32LE=function(l,h,w){u(this,l,h,!0,w)},s.prototype.writeUInt32BE=function(l,h,w){u(this,l,h,!1,w)},s.prototype.writeInt8=function(l,h,w){w||(R(l!=null,"missing value"),R(h!=null,"missing offset"),R(h<this.length,"Trying to write beyond buffer length"),Le(l,127,-128)),h>=this.length||(0<=l?this.writeUInt8(l,h,w):this.writeUInt8(255+l+1,h,w))},s.prototype.writeInt16LE=function(l,h,w){m(this,l,h,!0,w)},s.prototype.writeInt16BE=function(l,h,w){m(this,l,h,!1,w)},s.prototype.writeInt32LE=function(l,h,w){k(this,l,h,!0,w)},s.prototype.writeInt32BE=function(l,h,w){k(this,l,h,!1,w)},s.prototype.writeFloatLE=function(l,h,w){U(this,l,h,!0,w)},s.prototype.writeFloatBE=function(l,h,w){U(this,l,h,!1,w)},s.prototype.writeDoubleLE=function(l,h,w){B(this,l,h,!0,w)},s.prototype.writeDoubleBE=function(l,h,w){B(this,l,h,!1,w)},s.prototype.fill=function(l,h,w){if(h=h||0,w=w||this.length,R(typeof(l=typeof(l=l||0)=="string"?l.charCodeAt(0):l)=="number"&&!isNaN(l),"value is not a number"),R(h<=w,"end < start"),w!==h&&this.length!==0){R(0<=h&&h<this.length,"start out of bounds"),R(0<=w&&w<=this.length,"end out of bounds");for(var A=h;A<w;A++)this[A]=l}},s.prototype.inspect=function(){for(var l=[],h=this.length,w=0;w<h;w++)if(l[w]=Q(this[w]),w===i.INSPECT_MAX_BYTES){l[w+1]="...";break}return"<Buffer "+l.join(" ")+">"},s.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(s._useTypedArrays)return new s(this).buffer;for(var l=new Uint8Array(this.length),h=0,w=l.length;h<w;h+=1)l[h]=this[h];return l.buffer};var D=s.prototype;function G(l,h,w){return typeof l!="number"?w:h<=(l=~~l)?h:0<=l||0<=(l+=h)?l:0}function q(l){return(l=~~Math.ceil(+l))<0?0:l}function oe(l){return(Array.isArray||function(h){return Object.prototype.toString.call(h)==="[object Array]"})(l)}function Q(l){return l<16?"0"+l.toString(16):l.toString(16)}function K(l){for(var h=[],w=0;w<l.length;w++){var A=l.charCodeAt(w);if(A<=127)h.push(l.charCodeAt(w));else for(var V=w,F=(55296<=A&&A<=57343&&w++,encodeURIComponent(l.slice(V,w+1)).substr(1).split("%")),$=0;$<F.length;$++)h.push(parseInt(F[$],16))}return h}function gt(l){return b.toByteArray(l)}function Ue(l,h,w,A){for(var V=0;V<A&&!(V+w>=h.length||V>=l.length);V++)h[V+w]=l[V];return V}function Xe(l){try{return decodeURIComponent(l)}catch{return"\uFFFD"}}function pe(l,h){R(typeof l=="number","cannot write a non-number as a number"),R(0<=l,"specified a negative value for writing an unsigned value"),R(l<=h,"value is larger than maximum value for type"),R(Math.floor(l)===l,"value has a fractional component")}function Le(l,h,w){R(typeof l=="number","cannot write a non-number as a number"),R(l<=h,"value larger than maximum allowed value"),R(w<=l,"value smaller than minimum allowed value"),R(Math.floor(l)===l,"value has a fractional component")}function Ne(l,h,w){R(typeof l=="number","cannot write a non-number as a number"),R(l<=h,"value larger than maximum allowed value"),R(w<=l,"value smaller than minimum allowed value")}function R(l,h){if(!l)throw new Error(h||"Failed assertion")}s._augment=function(l){return l._isBuffer=!0,l._get=l.get,l._set=l.set,l.get=D.get,l.set=D.set,l.write=D.write,l.toString=D.toString,l.toLocaleString=D.toString,l.toJSON=D.toJSON,l.copy=D.copy,l.slice=D.slice,l.readUInt8=D.readUInt8,l.readUInt16LE=D.readUInt16LE,l.readUInt16BE=D.readUInt16BE,l.readUInt32LE=D.readUInt32LE,l.readUInt32BE=D.readUInt32BE,l.readInt8=D.readInt8,l.readInt16LE=D.readInt16LE,l.readInt16BE=D.readInt16BE,l.readInt32LE=D.readInt32LE,l.readInt32BE=D.readInt32BE,l.readFloatLE=D.readFloatLE,l.readFloatBE=D.readFloatBE,l.readDoubleLE=D.readDoubleLE,l.readDoubleBE=D.readDoubleBE,l.writeUInt8=D.writeUInt8,l.writeUInt16LE=D.writeUInt16LE,l.writeUInt16BE=D.writeUInt16BE,l.writeUInt32LE=D.writeUInt32LE,l.writeUInt32BE=D.writeUInt32BE,l.writeInt8=D.writeInt8,l.writeInt16LE=D.writeInt16LE,l.writeInt16BE=D.writeInt16BE,l.writeInt32LE=D.writeInt32LE,l.writeInt32BE=D.writeInt32BE,l.writeFloatLE=D.writeFloatLE,l.writeFloatBE=D.writeFloatBE,l.writeDoubleLE=D.writeDoubleLE,l.writeDoubleBE=D.writeDoubleBE,l.fill=D.fill,l.inspect=D.inspect,l.toArrayBuffer=D.toArrayBuffer,l}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(t,r,i){(function(o,a,s,p,f,_,g,E,O){var s=t("buffer").Buffer,b=4,P=new s(b);P.fill(0),r.exports={hash:function(M,C,S,L){for(var T=C(function(d,u){d.length%b!=0&&(m=d.length+(b-d.length%b),d=s.concat([d,P],m));for(var m,k=[],U=u?d.readInt32BE:d.readInt32LE,B=0;B<d.length;B+=b)k.push(U.call(d,B));return k}(M=s.isBuffer(M)?M:new s(M),L),8*M.length),C=L,j=new s(S),v=C?j.writeInt32BE:j.writeInt32LE,y=0;y<T.length;y++)v.call(j,T[y],4*y,!0);return j}}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(t,r,i){(function(o,a,s,p,f,_,g,E,O){var s=t("buffer").Buffer,b=t("./sha"),P=t("./sha256"),M=t("./rng"),C={sha1:b,sha256:P,md5:t("./md5")},S=64,L=new s(S);function T(d,u){var m=C[d=d||"sha1"],k=[];return m||j("algorithm:",d,"is not yet supported"),{update:function(U){return s.isBuffer(U)||(U=new s(U)),k.push(U),U.length,this},digest:function(U){var B=s.concat(k),B=u?function(D,G,q){s.isBuffer(G)||(G=new s(G)),s.isBuffer(q)||(q=new s(q)),G.length>S?G=D(G):G.length<S&&(G=s.concat([G,L],S));for(var oe=new s(S),Q=new s(S),K=0;K<S;K++)oe[K]=54^G[K],Q[K]=92^G[K];return q=D(s.concat([oe,q])),D(s.concat([Q,q]))}(m,u,B):m(B);return k=null,U?B.toString(U):B}}}function j(){var d=[].slice.call(arguments).join(" ");throw new Error([d,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}L.fill(0),i.createHash=function(d){return T(d)},i.createHmac=T,i.randomBytes=function(d,u){if(!u||!u.call)return new s(M(d));try{u.call(this,void 0,new s(M(d)))}catch(m){u(m)}};var v,y=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],c=function(d){i[d]=function(){j("sorry,",d,"is not implemented yet")}};for(v in y)c(y[v])}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(t,r,i){(function(o,a,s,p,f,_,g,E,O){var b=t("./helpers");function P(v,y){v[y>>5]|=128<<y%32,v[14+(y+64>>>9<<4)]=y;for(var c=1732584193,d=-271733879,u=-1732584194,m=271733878,k=0;k<v.length;k+=16){var U=c,B=d,D=u,G=m,c=C(c,d,u,m,v[k+0],7,-680876936),m=C(m,c,d,u,v[k+1],12,-389564586),u=C(u,m,c,d,v[k+2],17,606105819),d=C(d,u,m,c,v[k+3],22,-1044525330);c=C(c,d,u,m,v[k+4],7,-176418897),m=C(m,c,d,u,v[k+5],12,1200080426),u=C(u,m,c,d,v[k+6],17,-1473231341),d=C(d,u,m,c,v[k+7],22,-45705983),c=C(c,d,u,m,v[k+8],7,1770035416),m=C(m,c,d,u,v[k+9],12,-1958414417),u=C(u,m,c,d,v[k+10],17,-42063),d=C(d,u,m,c,v[k+11],22,-1990404162),c=C(c,d,u,m,v[k+12],7,1804603682),m=C(m,c,d,u,v[k+13],12,-40341101),u=C(u,m,c,d,v[k+14],17,-1502002290),c=S(c,d=C(d,u,m,c,v[k+15],22,1236535329),u,m,v[k+1],5,-165796510),m=S(m,c,d,u,v[k+6],9,-1069501632),u=S(u,m,c,d,v[k+11],14,643717713),d=S(d,u,m,c,v[k+0],20,-373897302),c=S(c,d,u,m,v[k+5],5,-701558691),m=S(m,c,d,u,v[k+10],9,38016083),u=S(u,m,c,d,v[k+15],14,-660478335),d=S(d,u,m,c,v[k+4],20,-405537848),c=S(c,d,u,m,v[k+9],5,568446438),m=S(m,c,d,u,v[k+14],9,-1019803690),u=S(u,m,c,d,v[k+3],14,-187363961),d=S(d,u,m,c,v[k+8],20,1163531501),c=S(c,d,u,m,v[k+13],5,-1444681467),m=S(m,c,d,u,v[k+2],9,-51403784),u=S(u,m,c,d,v[k+7],14,1735328473),c=L(c,d=S(d,u,m,c,v[k+12],20,-1926607734),u,m,v[k+5],4,-378558),m=L(m,c,d,u,v[k+8],11,-2022574463),u=L(u,m,c,d,v[k+11],16,1839030562),d=L(d,u,m,c,v[k+14],23,-35309556),c=L(c,d,u,m,v[k+1],4,-1530992060),m=L(m,c,d,u,v[k+4],11,1272893353),u=L(u,m,c,d,v[k+7],16,-155497632),d=L(d,u,m,c,v[k+10],23,-1094730640),c=L(c,d,u,m,v[k+13],4,681279174),m=L(m,c,d,u,v[k+0],11,-358537222),u=L(u,m,c,d,v[k+3],16,-722521979),d=L(d,u,m,c,v[k+6],23,76029189),c=L(c,d,u,m,v[k+9],4,-640364487),m=L(m,c,d,u,v[k+12],11,-421815835),u=L(u,m,c,d,v[k+15],16,530742520),c=T(c,d=L(d,u,m,c,v[k+2],23,-995338651),u,m,v[k+0],6,-198630844),m=T(m,c,d,u,v[k+7],10,1126891415),u=T(u,m,c,d,v[k+14],15,-1416354905),d=T(d,u,m,c,v[k+5],21,-57434055),c=T(c,d,u,m,v[k+12],6,1700485571),m=T(m,c,d,u,v[k+3],10,-1894986606),u=T(u,m,c,d,v[k+10],15,-1051523),d=T(d,u,m,c,v[k+1],21,-2054922799),c=T(c,d,u,m,v[k+8],6,1873313359),m=T(m,c,d,u,v[k+15],10,-30611744),u=T(u,m,c,d,v[k+6],15,-1560198380),d=T(d,u,m,c,v[k+13],21,1309151649),c=T(c,d,u,m,v[k+4],6,-145523070),m=T(m,c,d,u,v[k+11],10,-1120210379),u=T(u,m,c,d,v[k+2],15,718787259),d=T(d,u,m,c,v[k+9],21,-343485551),c=j(c,U),d=j(d,B),u=j(u,D),m=j(m,G)}return Array(c,d,u,m)}function M(v,y,c,d,u,m){return j((y=j(j(y,v),j(d,m)))<<u|y>>>32-u,c)}function C(v,y,c,d,u,m,k){return M(y&c|~y&d,v,y,u,m,k)}function S(v,y,c,d,u,m,k){return M(y&d|c&~d,v,y,u,m,k)}function L(v,y,c,d,u,m,k){return M(y^c^d,v,y,u,m,k)}function T(v,y,c,d,u,m,k){return M(c^(y|~d),v,y,u,m,k)}function j(v,y){var c=(65535&v)+(65535&y);return(v>>16)+(y>>16)+(c>>16)<<16|65535&c}r.exports=function(v){return b.hash(v,P,16)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(t,r,i){(function(o,a,s,p,f,_,g,E,O){r.exports=function(b){for(var P,M=new Array(b),C=0;C<b;C++)!(3&C)&&(P=4294967296*Math.random()),M[C]=P>>>((3&C)<<3)&255;return M}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(t,r,i){(function(o,a,s,p,f,_,g,E,O){var b=t("./helpers");function P(S,L){S[L>>5]|=128<<24-L%32,S[15+(L+64>>9<<4)]=L;for(var T,j,v,y=Array(80),c=1732584193,d=-271733879,u=-1732584194,m=271733878,k=-1009589776,U=0;U<S.length;U+=16){for(var B=c,D=d,G=u,q=m,oe=k,Q=0;Q<80;Q++){y[Q]=Q<16?S[U+Q]:C(y[Q-3]^y[Q-8]^y[Q-14]^y[Q-16],1);var K=M(M(C(c,5),(K=d,j=u,v=m,(T=Q)<20?K&j|~K&v:!(T<40)&&T<60?K&j|K&v|j&v:K^j^v)),M(M(k,y[Q]),(T=Q)<20?1518500249:T<40?1859775393:T<60?-1894007588:-899497514)),k=m,m=u,u=C(d,30),d=c,c=K}c=M(c,B),d=M(d,D),u=M(u,G),m=M(m,q),k=M(k,oe)}return Array(c,d,u,m,k)}function M(S,L){var T=(65535&S)+(65535&L);return(S>>16)+(L>>16)+(T>>16)<<16|65535&T}function C(S,L){return S<<L|S>>>32-L}r.exports=function(S){return b.hash(S,P,20,!0)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(t,r,i){(function(o,a,s,p,f,_,g,E,O){function b(L,T){var j=(65535&L)+(65535&T);return(L>>16)+(T>>16)+(j>>16)<<16|65535&j}function P(L,T){var j,v=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),y=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),c=new Array(64);L[T>>5]|=128<<24-T%32,L[15+(T+64>>9<<4)]=T;for(var d,u,m=0;m<L.length;m+=16){for(var k=y[0],U=y[1],B=y[2],D=y[3],G=y[4],q=y[5],oe=y[6],Q=y[7],K=0;K<64;K++)c[K]=K<16?L[K+m]:b(b(b((u=c[K-2],C(u,17)^C(u,19)^S(u,10)),c[K-7]),(u=c[K-15],C(u,7)^C(u,18)^S(u,3))),c[K-16]),j=b(b(b(b(Q,C(u=G,6)^C(u,11)^C(u,25)),G&q^~G&oe),v[K]),c[K]),d=b(C(d=k,2)^C(d,13)^C(d,22),k&U^k&B^U&B),Q=oe,oe=q,q=G,G=b(D,j),D=B,B=U,U=k,k=b(j,d);y[0]=b(k,y[0]),y[1]=b(U,y[1]),y[2]=b(B,y[2]),y[3]=b(D,y[3]),y[4]=b(G,y[4]),y[5]=b(q,y[5]),y[6]=b(oe,y[6]),y[7]=b(Q,y[7])}return y}var M=t("./helpers"),C=function(L,T){return L>>>T|L<<32-T},S=function(L,T){return L>>>T};r.exports=function(L){return M.hash(L,P,32,!0)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(t,r,i){(function(o,a,s,p,f,_,g,E,O){i.read=function(b,P,M,C,S){var L,T,j=8*S-C-1,v=(1<<j)-1,y=v>>1,c=-7,d=M?S-1:0,u=M?-1:1,S=b[P+d];for(d+=u,L=S&(1<<-c)-1,S>>=-c,c+=j;0<c;L=256*L+b[P+d],d+=u,c-=8);for(T=L&(1<<-c)-1,L>>=-c,c+=C;0<c;T=256*T+b[P+d],d+=u,c-=8);if(L===0)L=1-y;else{if(L===v)return T?NaN:1/0*(S?-1:1);T+=Math.pow(2,C),L-=y}return(S?-1:1)*T*Math.pow(2,L-C)},i.write=function(b,P,M,C,S,L){var T,j,v=8*L-S-1,y=(1<<v)-1,c=y>>1,d=S===23?Math.pow(2,-24)-Math.pow(2,-77):0,u=C?0:L-1,m=C?1:-1,L=P<0||P===0&&1/P<0?1:0;for(P=Math.abs(P),isNaN(P)||P===1/0?(j=isNaN(P)?1:0,T=y):(T=Math.floor(Math.log(P)/Math.LN2),P*(C=Math.pow(2,-T))<1&&(T--,C*=2),2<=(P+=1<=T+c?d/C:d*Math.pow(2,1-c))*C&&(T++,C/=2),y<=T+c?(j=0,T=y):1<=T+c?(j=(P*C-1)*Math.pow(2,S),T+=c):(j=P*Math.pow(2,c-1)*Math.pow(2,S),T=0));8<=S;b[M+u]=255&j,u+=m,j/=256,S-=8);for(T=T<<S|j,v+=S;0<v;b[M+u]=255&T,u+=m,T/=256,v-=8);b[M+u-m]|=128*L}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(t,r,i){(function(o,a,s,p,f,_,g,E,O){var b,P,M;function C(){}(o=r.exports={}).nextTick=(P=typeof window<"u"&&window.setImmediate,M=typeof window<"u"&&window.postMessage&&window.addEventListener,P?function(S){return window.setImmediate(S)}:M?(b=[],window.addEventListener("message",function(S){var L=S.source;L!==window&&L!==null||S.data!=="process-tick"||(S.stopPropagation(),0<b.length&&b.shift()())},!0),function(S){b.push(S),window.postMessage("process-tick","*")}):function(S){setTimeout(S,0)}),o.title="browser",o.browser=!0,o.env={},o.argv=[],o.on=C,o.addListener=C,o.once=C,o.off=C,o.removeListener=C,o.removeAllListeners=C,o.emit=C,o.binding=function(S){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(S){throw new Error("process.chdir is not supported")}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})})(fs);fs.exports;var sh=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"],ti=sh;ti=ti.slice().filter(function(n){return!/^(gl\_|texture)/.test(n)});ti.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"]);function ah(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function lh(n){var e=ah(n,"string");return typeof e=="symbol"?e:String(e)}function ie(n,e,t){return e=lh(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var H={position:"csm_Position",positionRaw:"csm_PositionRaw",pointSize:"csm_PointSize",fragColor:"csm_FragColor",diffuseColor:"csm_DiffuseColor",normal:"csm_Normal",roughness:"csm_Roughness",metalness:"csm_Metalness",emissive:"csm_Emissive",ao:"csm_AO",bump:"csm_Bump",depthAlpha:"csm_DepthAlpha"},Se,Ut;Se={},ie(Se,"".concat(H.normal),{"#include <beginnormal_vertex>":`
    vec3 objectNormal = `.concat(H.normal,`;
    #ifdef USE_TANGENT
	    vec3 objectTangent = vec3( tangent.xyz );
    #endif
    `)}),ie(Se,"".concat(H.position),{"#include <begin_vertex>":`
    vec3 transformed = `.concat(H.position,`;
  `)}),ie(Se,"".concat(H.positionRaw),{"#include <begin_vertex>":`
    vec4 csm_internal_positionUnprojected = `.concat(H.positionRaw,`;
    mat4x4 csm_internal_unprojectMatrix = projectionMatrix * modelViewMatrix;
    #ifdef USE_INSTANCING
      csm_internal_unprojectMatrix = csm_internal_unprojectMatrix * instanceMatrix;
    #endif
    csm_internal_positionUnprojected = inverse(csm_internal_unprojectMatrix) * csm_internal_positionUnprojected;
    vec3 transformed = csm_internal_positionUnprojected.xyz;
  `)}),ie(Se,"".concat(H.pointSize),{"gl_PointSize = size;":`
    gl_PointSize = `.concat(H.pointSize,`;
    `)}),ie(Se,"".concat(H.diffuseColor),{"#include <color_fragment>":`
    #include <color_fragment>
    diffuseColor = `.concat(H.diffuseColor,`;
  `)}),ie(Se,"".concat(H.fragColor),{"#include <dithering_fragment>":`
    #include <dithering_fragment>
    gl_FragColor  = `.concat(H.fragColor,`;
  `)}),ie(Se,"".concat(H.emissive),{"vec3 totalEmissiveRadiance = emissive;":`
    vec3 totalEmissiveRadiance = `.concat(H.emissive,`;
    `)}),ie(Se,"".concat(H.roughness),{"#include <roughnessmap_fragment>":`
    #include <roughnessmap_fragment>
    roughnessFactor = `.concat(H.roughness,`;
    `)}),ie(Se,"".concat(H.metalness),{"#include <metalnessmap_fragment>":`
    #include <metalnessmap_fragment>
    metalnessFactor = `.concat(H.metalness,`;
    `)}),ie(Se,"".concat(H.ao),{"#include <aomap_fragment>":`
    #include <aomap_fragment>
    reflectedLight.indirectDiffuse *= 1. - `.concat(H.ao,`;
    `)}),ie(Se,"".concat(H.bump),{"#include <normal_fragment_maps>":`
    #include <normal_fragment_maps>

    vec3 csm_internal_orthogonal = `.concat(H.bump," - (dot(").concat(H.bump,`, normal) * normal);
    vec3 csm_internal_projectedbump = mat3(csm_internal_vModelViewMatrix) * csm_internal_orthogonal;
    normal = normalize(normal - csm_internal_projectedbump);
    `)}),ie(Se,"".concat(H.depthAlpha),{"gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );":`
      gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity * `.concat(H.depthAlpha,` );
    `),"gl_FragColor = packDepthToRGBA( fragCoordZ );":`
      gl_FragColor = packDepthToRGBA( fragCoordZ );
      gl_FragColor.a *= `.concat(H.depthAlpha,`;
    `)});Ut={},ie(Ut,"".concat(H.position),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":`
    gl_Position = projectionMatrix * modelViewMatrix * vec4( `.concat(H.position,`, 1.0 );
  `)}),ie(Ut,"".concat(H.positionRaw),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":`
    gl_Position = `.concat(H.position,`;
  `)}),ie(Ut,"".concat(H.diffuseColor),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":`
    gl_FragColor = `.concat(H.diffuseColor,`;
  `)}),ie(Ut,"".concat(H.fragColor),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":`
    gl_FragColor = `.concat(H.fragColor,`;
  `)});var Te;Te={},ie(Te,"".concat(H.position),"*"),ie(Te,"".concat(H.positionRaw),"*"),ie(Te,"".concat(H.normal),"*"),ie(Te,"".concat(H.pointSize),["PointsMaterial"]),ie(Te,"".concat(H.diffuseColor),"*"),ie(Te,"".concat(H.fragColor),"*"),ie(Te,"".concat(H.emissive),["MeshStandardMaterial","MeshPhysicalMaterial"]),ie(Te,"".concat(H.roughness),["MeshStandardMaterial","MeshPhysicalMaterial"]),ie(Te,"".concat(H.metalness),["MeshStandardMaterial","MeshPhysicalMaterial"]),ie(Te,"".concat(H.ao),["MeshStandardMaterial","MeshPhysicalMaterial","MeshBasicMaterial","MeshLambertMaterial","MeshPhongMaterial","MeshToonMaterial"]),ie(Te,"".concat(H.bump),["MeshLambertMaterial","MeshMatcapMaterial","MeshNormalMaterial","MeshPhongMaterial","MeshPhysicalMaterial","MeshStandardMaterial","MeshToonMaterial","ShadowMaterial"]),ie(Te,"".concat(H.depthAlpha),"*");new vi;new X;_n.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new _e(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};Hs.line={uniforms:tr.merge([_n.common,_n.fog,_n.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				// get the offset direction as perpendicular to the view vector
				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 offset;
				if ( position.y < 0.5 ) {

					offset = normalize( cross( start.xyz, worldDir ) );

				} else {

					offset = normalize( cross( end.xyz, worldDir ) );

				}

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// extend the line bounds to encompass  endcaps
					start.xyz += - worldDir * linewidth * 0.5;
					end.xyz += worldDir * linewidth * 0.5;

					// shift the position of the quad so it hugs the forward edge of the line
					offset.xy -= dir * forwardOffset;
					offset.z += 0.5;

				#endif

				// endcaps
				if ( position.y > 1.0 || position.y < 0.0 ) {

					offset.xy += dir * 2.0 * forwardOffset;

				}

				// adjust for linewidth
				offset *= linewidth * 0.5;

				// set the world position
				worldPos = ( position.y < 0.5 ) ? start : end;
				worldPos.xyz += offset;

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segments overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			float alpha = opacity;

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};new X;new X;new bt;new bt;new bt;new X;new bn;new Gs;new X;new vi;new $s;new bt;class ni extends Ht{constructor(){const e=ni.SkyShader,t=new nr({name:e.name,uniforms:tr.clone(e.uniforms),vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,side:ea,depthWrite:!1});super(new ta(1,1,1),t),this.isSky=!0}}ni.SkyShader={name:"SkyShader",uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new X},up:{value:new X(0,1,0)}},vertexShader:`
		uniform vec3 sunPosition;
		uniform float rayleigh;
		uniform float turbidity;
		uniform float mieCoefficient;
		uniform vec3 up;

		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		// constants for atmospheric scattering
		const float e = 2.71828182845904523536028747135266249775724709369995957;
		const float pi = 3.141592653589793238462643383279502884197169;

		// wavelength of used primaries, according to preetham
		const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
		// this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
		// (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
		const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

		// mie stuff
		// K coefficient for the primaries
		const float v = 4.0;
		const vec3 K = vec3( 0.686, 0.678, 0.666 );
		// MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
		const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

		// earth shadow hack
		// cutoffAngle = pi / 1.95;
		const float cutoffAngle = 1.6110731556870734;
		const float steepness = 1.5;
		const float EE = 1000.0;

		float sunIntensity( float zenithAngleCos ) {
			zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
			return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
		}

		vec3 totalMie( float T ) {
			float c = ( 0.2 * T ) * 10E-18;
			return 0.434 * c * MieConst;
		}

		void main() {

			vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
			vWorldPosition = worldPosition.xyz;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			gl_Position.z = gl_Position.w; // set z to camera.far

			vSunDirection = normalize( sunPosition );

			vSunE = sunIntensity( dot( vSunDirection, up ) );

			vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

			float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

			// extinction (absorbtion + out scattering)
			// rayleigh coefficients
			vBetaR = totalRayleigh * rayleighCoefficient;

			// mie coefficients
			vBetaM = totalMie( turbidity ) * mieCoefficient;

		}`,fragmentShader:`
		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		uniform float mieDirectionalG;
		uniform vec3 up;

		// constants for atmospheric scattering
		const float pi = 3.141592653589793238462643383279502884197169;

		const float n = 1.0003; // refractive index of air
		const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

		// optical length at zenith for molecules
		const float rayleighZenithLength = 8.4E3;
		const float mieZenithLength = 1.25E3;
		// 66 arc seconds -> degrees, and the cosine of that
		const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

		// 3.0 / ( 16.0 * pi )
		const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
		// 1.0 / ( 4.0 * pi )
		const float ONE_OVER_FOURPI = 0.07957747154594767;

		float rayleighPhase( float cosTheta ) {
			return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
		}

		float hgPhase( float cosTheta, float g ) {
			float g2 = pow( g, 2.0 );
			float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
			return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
		}

		void main() {

			vec3 direction = normalize( vWorldPosition - cameraPosition );

			// optical length
			// cutoff angle at 90 to avoid singularity in next formula.
			float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
			float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
			float sR = rayleighZenithLength * inverse;
			float sM = mieZenithLength * inverse;

			// combined extinction factor
			vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

			// in scattering
			float cosTheta = dot( direction, vSunDirection );

			float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
			vec3 betaRTheta = vBetaR * rPhase;

			float mPhase = hgPhase( cosTheta, mieDirectionalG );
			vec3 betaMTheta = vBetaM * mPhase;

			vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
			Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

			// nightsky
			float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
			float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
			vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
			vec3 L0 = vec3( 0.1 ) * Fex;

			// composition + solar disc
			float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
			L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

			vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

			vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

			gl_FragColor = vec4( retColor, 1.0 );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>

		}`};var vs={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(ih,function(){var t=function(){function r(O){return a.appendChild(O.dom),O}function i(O){for(var b=0;b<a.children.length;b++)a.children[b].style.display=b===O?"block":"none";o=O}var o=0,a=document.createElement("div");a.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",a.addEventListener("click",function(O){O.preventDefault(),i(++o%a.children.length)},!1);var s=(performance||Date).now(),p=s,f=0,_=r(new t.Panel("FPS","#0ff","#002")),g=r(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var E=r(new t.Panel("MB","#f08","#201"));return i(0),{REVISION:16,dom:a,addPanel:r,showPanel:i,begin:function(){s=(performance||Date).now()},end:function(){f++;var O=(performance||Date).now();if(g.update(O-s,200),O>p+1e3&&(_.update(1e3*f/(O-p),100),p=O,f=0,E)){var b=performance.memory;E.update(b.usedJSHeapSize/1048576,b.jsHeapSizeLimit/1048576)}return O},update:function(){s=this.end()},domElement:a,setMode:i}};return t.Panel=function(r,i,o){var a=1/0,s=0,p=Math.round,f=p(window.devicePixelRatio||1),_=80*f,g=48*f,E=3*f,O=2*f,b=3*f,P=15*f,M=74*f,C=30*f,S=document.createElement("canvas");S.width=_,S.height=g,S.style.cssText="width:80px;height:48px";var L=S.getContext("2d");return L.font="bold "+9*f+"px Helvetica,Arial,sans-serif",L.textBaseline="top",L.fillStyle=o,L.fillRect(0,0,_,g),L.fillStyle=i,L.fillText(r,E,O),L.fillRect(b,P,M,C),L.fillStyle=o,L.globalAlpha=.9,L.fillRect(b,P,M,C),{dom:S,update:function(T,j){a=Math.min(a,T),s=Math.max(s,T),L.fillStyle=o,L.globalAlpha=1,L.fillRect(0,0,_,P),L.fillStyle=i,L.fillText(p(T)+" "+r+" ("+p(a)+"-"+p(s)+")",E,O),L.drawImage(S,b+f,P,M-f,C,b,P,M-f,C),L.fillRect(b+M-f,P,f,C),L.fillStyle=o,L.globalAlpha=.9,L.fillRect(b+M-f,P,f,p((1-T/j)*C))}}},t})})(vs);var uh=vs.exports;const ch=oh(uh);Je({name:"Stats",props:{showPanel:{type:Number,default:0}},setup(n,{expose:e}){const t=new ch;e({stats:t});const r=document.body;t.showPanel(n.showPanel||0),r==null||r.appendChild(t.dom);const{onBeforeLoop:i,onAfterLoop:o,resume:a}=At();return a(),i(()=>t.begin()),o(()=>t.end()),et(()=>{r==null||r.removeChild(t.dom)}),null}});class dh{constructor(e,t,r){this.name=e,this.fg=t,this.bg=r,this.PR=Math.round(window.devicePixelRatio||1),this.WIDTH=90*this.PR,this.HEIGHT=48*this.PR,this.TEXT_X=3*this.PR,this.TEXT_Y=2*this.PR,this.GRAPH_X=3*this.PR,this.GRAPH_Y=15*this.PR,this.GRAPH_WIDTH=84*this.PR,this.GRAPH_HEIGHT=30*this.PR,this.canvas=document.createElement("canvas"),this.canvas.width=90*this.PR,this.canvas.height=48*this.PR,this.canvas.style.width="90px",this.canvas.style.position="absolute",this.canvas.style.height="48px",this.canvas.style.cssText="width:90px;height:48px",this.context=this.canvas.getContext("2d"),this.context&&(this.context.font="bold "+9*this.PR+"px Helvetica,Arial,sans-serif",this.context.textBaseline="top",this.context.fillStyle=this.bg,this.context.fillRect(0,0,this.WIDTH,this.HEIGHT),this.context.fillStyle=this.fg,this.context.fillText(this.name,this.TEXT_X,this.TEXT_Y),this.context.fillRect(this.GRAPH_X,this.GRAPH_Y,this.GRAPH_WIDTH,this.GRAPH_HEIGHT),this.context.fillStyle=this.bg,this.context.globalAlpha=.9,this.context.fillRect(this.GRAPH_X,this.GRAPH_Y,this.GRAPH_WIDTH,this.GRAPH_HEIGHT))}update(e,t,r,i,o=0){let a=1/0,s=0;this.context&&(a=Math.min(a,e),s=Math.max(r,e),i=Math.max(i,t),this.context.fillStyle=this.bg,this.context.globalAlpha=1,this.context.fillRect(0,0,this.WIDTH,this.GRAPH_Y),this.context.fillStyle=this.fg,this.context.fillText(e.toFixed(o)+" "+this.name+" ("+a.toFixed(o)+"-"+parseFloat(s.toFixed(o))+")",this.TEXT_X,this.TEXT_Y),this.context.drawImage(this.canvas,this.GRAPH_X+this.PR,this.GRAPH_Y,this.GRAPH_WIDTH-this.PR,this.GRAPH_HEIGHT,this.GRAPH_X,this.GRAPH_Y,this.GRAPH_WIDTH-this.PR,this.GRAPH_HEIGHT),this.context.fillRect(this.GRAPH_X+this.GRAPH_WIDTH-this.PR,this.GRAPH_Y,this.PR,this.GRAPH_HEIGHT),this.context.fillStyle=this.bg,this.context.globalAlpha=.9,this.context.fillRect(this.GRAPH_X+this.GRAPH_WIDTH-this.PR,this.GRAPH_Y,this.PR,(1-t/i)*this.GRAPH_HEIGHT))}}const gs=class qn{constructor({logsPerSecond:e=20,samplesLog:t=100,samplesGraph:r=10,precision:i=2,minimal:o=!1,horizontal:a=!0,mode:s=0}={}){this.mode=s,this.horizontal=a,this.container=document.createElement("div"),this.container.style.cssText="position:fixed;top:0;left:0;opacity:0.9;z-index:10000;",o&&(this.container.style.cssText+="cursor:pointer"),this.gl=null,this.query=null,this.minimal=o,this.beginTime=(performance||Date).now(),this.prevTime=this.beginTime,this.prevCpuTime=this.beginTime,this.frames=0,this.averageCpu={logs:[],graph:[]},this.averageGpu={logs:[],graph:[]},this.queryCreated=!1,this.fpsPanel=this.addPanel(new qn.Panel("FPS","#0ff","#002"),0),this.msPanel=this.addPanel(new qn.Panel("CPU","#0f0","#020"),1),this.gpuPanel=null,this.samplesLog=t,this.samplesGraph=r,this.precision=i,this.logsPerSecond=e,this.minimal?(this.container.addEventListener("click",p=>{p.preventDefault(),this.showPanel(++this.mode%this.container.children.length)},!1),this.mode=s,this.showPanel(this.mode)):window.addEventListener("resize",()=>{this.resizePanel(this.fpsPanel,0),this.resizePanel(this.msPanel,1),this.gpuPanel&&this.resizePanel(this.gpuPanel,2)})}resizePanel(e,t){e.canvas.style.position="absolute",this.minimal?e.canvas.style.display="none":(e.canvas.style.display="block",this.horizontal?(e.canvas.style.top="0px",e.canvas.style.left=t*e.WIDTH/e.PR+"px"):(e.canvas.style.left="0px",e.canvas.style.top=t*e.HEIGHT/e.PR+"px"))}addPanel(e,t){return e.canvas&&(this.container.appendChild(e.canvas),this.resizePanel(e,t)),e}showPanel(e){for(let t=0;t<this.container.children.length;t++){const r=this.container.children[t];r.style.display=t===e?"block":"none"}this.mode=e}init(e){if(!e){console.error('Stats: The "canvas" parameter is undefined.');return}if(e instanceof WebGL2RenderingContext)this.gl=e;else if(e instanceof HTMLCanvasElement||e instanceof OffscreenCanvas){if(this.gl=e.getContext("webgl2"),!this.gl){console.error("Stats: Unable to obtain WebGL2 context.");return}}else{console.error("Stats: Invalid input type. Expected WebGL2RenderingContext, HTMLCanvasElement, or OffscreenCanvas.");return}this.ext=this.gl.getExtension("EXT_disjoint_timer_query_webgl2"),this.ext&&(this.gpuPanel=this.addPanel(new qn.Panel("GPU","#ff0","#220"),2))}begin(){if(this.beginProfiling("cpu-started"),!(!this.gl||!this.ext)){if(this.query){const e=this.gl.getQueryParameter(this.query,this.gl.QUERY_RESULT_AVAILABLE);if(this.disjoint=this.gl.getParameter(this.ext.GPU_DISJOINT_EXT),e&&!this.disjoint){this.ns=this.gl.getQueryParameter(this.query,this.gl.QUERY_RESULT);const t=this.ns*1e-6;(e||this.disjoint)&&(this.gl.deleteQuery(this.query),this.query=null),e&&this.addToAverage(t,this.averageGpu)}}this.query||(this.queryCreated=!0,this.query=this.gl.createQuery(),this.query&&this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,this.query))}}end(){this.beginTime=this.endInternal(),this.endProfiling("cpu-started","cpu-finished","cpu-duration",this.averageCpu),!(!this.gl||!this.ext)&&this.queryCreated&&this.gl.getQuery(this.ext.TIME_ELAPSED_EXT,this.gl.CURRENT_QUERY)&&this.gl.endQuery(this.ext.TIME_ELAPSED_EXT)}endInternal(){this.frames++;const e=(performance||Date).now();if(e>=this.prevCpuTime+1e3/this.logsPerSecond&&(this.updatePanel(this.msPanel,this.averageCpu),this.updatePanel(this.gpuPanel,this.averageGpu),this.prevCpuTime=e),e>=this.prevTime+1e3){const t=this.frames*1e3/(e-this.prevTime);this.fpsPanel.update(t,t,100,100,0),this.prevTime=e,this.frames=0}return e}addToAverage(e,t){t.logs.push(e),t.logs.length>this.samplesLog&&t.logs.shift(),t.graph.push(e),t.graph.length>this.samplesGraph&&t.graph.shift()}beginProfiling(e){window.performance&&window.performance.mark(e)}endProfiling(e,t,r,i){if(window.performance&&t){window.performance.mark(t);const o=performance.measure(r,e,t);this.addToAverage(o.duration,i)}}updatePanel(e,t){if(t.logs.length>0){let r=0,i=.01;for(let s=0;s<t.logs.length;s++)r+=t.logs[s],t.logs[s]>i&&(i=t.logs[s]);let o=0,a=.01;for(let s=0;s<t.graph.length;s++)o+=t.graph[s],t.graph[s]>a&&(a=t.graph[s]);e&&e.update(r/Math.min(t.logs.length,this.samplesLog),o/Math.min(t.graph.length,this.samplesGraph),i,a,this.precision)}}};gs.Panel=dh;let hh=gs;Je({name:"StatsGl",props:["logsPerSecond","samplesLog","samplesGraph","precision","horizontal","minimal","mode"],async setup(n,{expose:e}){const t=new hh({logsPerSecond:n.logsPerSecond,samplesLog:n.samplesLog,samplesGraph:n.samplesGraph,precision:n.precision,horizontal:n.horizontal,minimal:n.minimal,mode:n.mode});e({statsGl:t});const r=document.body;r==null||r.appendChild(t.dom);const{renderer:i}=Wt(),{onAfterLoop:o,resume:a}=At();return t.init(i.value),a(),o(()=>{t.update()}),et(()=>{r==null||r.removeChild(t.dom)}),null}});var ph=`#include <common>

void main() {
  vec2 center = vec2(0., 1.);
  float rotation = 0.0;

  
  
  float size = 0.03;

  vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
  vec2 scale;
  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

  bool isPerspective = isPerspectiveMatrix( projectionMatrix );
  if ( isPerspective ) scale *= - mvPosition.z;

  vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
  vec2 rotatedPosition;
  rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
  rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
  mvPosition.xy += rotatedPosition;

  gl_Position = projectionMatrix * mvPosition;
}`,mh=`void main() {
  gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
}`;const pn=new X(0,0,0),ri=new X(0,0,0),fh=new X(0,0,0);function ws(n,e,t){const r=pn.setFromMatrixPosition(n.matrixWorld);r.project(e);const i=t.width/2,o=t.height/2;return[(Number.isNaN(r.x)?0:r.x)*i+i,-(r.y*o)+o]}function vh(n,e){const t=pn.setFromMatrixPosition(n.matrixWorld),r=ri.setFromMatrixPosition(e.matrixWorld),i=t.sub(r),o=e.getWorldDirection(fh);return i.angleTo(o)>Math.PI/2}function gh(n,e,t,r){const i=pn.setFromMatrixPosition(n.matrixWorld),o=i.clone();o.project(e),t.setFromCamera(new _e(o.x,o.y),e);const a=t.intersectObjects(r,!0);if(a.length>0){const s=a[0].distance;return i.distanceTo(t.ray.origin)<s}return!0}function wh(n,e){if(e instanceof wt)return e.zoom;if(e instanceof Ge){const t=pn.setFromMatrixPosition(n.matrixWorld),r=ri.setFromMatrixPosition(e.matrixWorld),i=e.fov*Math.PI/180,o=t.distanceTo(r);return 1/(2*Math.tan(i/2)*o)}else return 1}function bh(n,e,t){if(e instanceof Ge||e instanceof wt){const r=pn.setFromMatrixPosition(n.matrixWorld),i=ri.setFromMatrixPosition(e.matrixWorld),o=r.distanceTo(i),a=(t[1]-t[0])/(e.far-e.near),s=t[1]-a*e.far;return Math.round(a*o+s)}}const ii=n=>Math.abs(n)<1e-10?0:n;function bs(n,e,t=""){let r="matrix3d(";for(let i=0;i!==16;i++)r+=ii(e[i]*n.elements[i])+(i!==15?",":")");return t+r}const _h=(n=>e=>bs(e,n))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),yh=(n=>(e,t)=>bs(e,n(t),"translate(-50%,-50%)"))(n=>[1/n,1/n,1/n,1,-1/n,-1/n,-1/n,-1,1/n,1/n,1/n,1,1,1,1,1]),xh=["geometry","material"];new Ks;const Ph={class:"h-full bg-gray-600"},Sh=Je({__name:"tresjs",setup(n){return(e,t)=>{const r=Gt("TresPerspectiveCamera"),i=Gt("TresSphereGeometry"),o=Gt("TresMeshNormalMaterial"),a=Gt("TresMesh"),s=Gt("TresGridHelper");return Tt(),Lt("div",Ph,[Be(W(el),{"clear-color":"black","window-size":""},{default:Mi(()=>[Be(r),Be(W(nh)),Be(a,null,{default:Mi(()=>[Be(i),Be(o)]),_:1}),Be(s)]),_:1})])}}});export{Sh as default};
