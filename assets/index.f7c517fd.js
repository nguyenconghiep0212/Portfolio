import{b as W,m as q,ai as Y,aj as ae,a3 as T,ak as ie,g as E,af as le,al as re,ag as ce,C as de,ad as I,F as A,a6 as X,J as pe,a2 as F,am as ue,D as me,a9 as Z,S as fe,W as he,ac as ye,a8 as be,aa as we,a as ve}from"./three.module.890a6b73.js";import{O as _e}from"./OrbitControls.7256e180.js";import{a as ge,C as ke}from"./CSS2DRenderer.f3645388.js";import{f as xe,a as Me}from"./solarSystem.cb6e6335.js";import{g as Se,r as w,d as N,b as C,l as n,t as S,u as i,m as M,a as P,a3 as J,j as O,ad as B,i as K,e as j,O as Q,P as Pe,k as ee,o as De,ag as Ce,ah as U}from"./vendor.03126991.js";import{u as je}from"./index.c83be021.js";import{I as z}from"./index.b89f9ac4.js";async function Te({numStars:o=1e4}={}){function t(){const c=Math.random()*25+5e12,y=Math.random(),k=Math.random(),_=2*Math.PI*y,x=Math.acos(2*k-1),D=c*Math.sin(x)*Math.cos(_),$=c*Math.sin(x)*Math.sin(_),b=c*Math.cos(x);return{pos:new E(D,$,b),minDist:c}}const e=[],s=[],p=[0,.1,.65];let l;for(let c=0;c<o;c+=1){const y=p[Math.floor(Math.random()*p.length)],k=t(),{pos:_}=k;l=new W().setHSL(y,Math.random(),Math.random()),e.push(_.x,_.y,_.z),s.push(l.r,l.g,l.b)}const u=new q;u.setAttribute("position",new Y(e,3)),u.setAttribute("color",new Y(s,3));const h=await xe({filter:[{key:"key",value:"star"}]});if(h){const c=new ae({size:.2,vertexColors:!0,map:new T().load(h.data[0].url)});return new ie(u,c)}}const L=Se("solarSystemStore",()=>{const o=w(!0),t=w(!1),e=w(!0),s=1e-4,p=w(3),l=w(!0),u=w(60),a={exposure:1,strength:1.2,threshold:.4,radius:0},h=w(null),c=w(null),y=w([]);return{realTime:l,selectedPlanetMission:h,selectedPlanet:c,displayPath:o,displayGridHelper:t,isRealScale:e,controlSpeed:p,timelapseMultiply:u,scaleDown:s,BLOOM_PARAMS:a,planets:y}});function V(o){return o*1496e5}function te(o,t,e=1,s=.4){const p=5e3,l=L(),u=new le({color:t.color,linewidth:e,transparent:!0,opacity:s}),a=new re(0,0,V(t.perihelion_astronomical_unit)*l.scaleDown,V(t.aphelion_astronomical_unit)*l.scaleDown,0,2*Math.PI,!1,0),h=a.getPoints(p),c=new q().setFromPoints(h),y=new ce(c,u);y.rotation.x=Math.PI*.5;const k=new de;function _(){const x=new E,D=l.realTime?k.getElapsedTime()*(1/(t.synodic_orbital_period*31536e3)):k.getElapsedTime()*(1/t.synodic_orbital_period)/l.timelapseMultiply%1;a.getPointAt(D,x),o.position.copy(x),o.position.applyMatrix4(y.matrixWorld)}return{animatedPath:_,path:y}}function ze(o){return{all:o=o||new Map,on:function(t,e){var s=o.get(t);s?s.push(e):o.set(t,[e])},off:function(t,e){var s=o.get(t);s&&(e?s.splice(s.indexOf(e)>>>0,1):o.set(t,[]))},emit:function(t,e){var s=o.get(t);s&&s.slice().map(function(p){p(e)}),(s=o.get("*"))&&s.slice().map(function(p){p(t,e)})}}}var R=ze();const G=L();function Re(o){const t=new I,e=new I,s=new T().load(o.texture_map),p=new T().load(o.normal_map),l=new A(new X(o.radius*G.scaleDown,264,164),o.key==="sun"?new pe({map:s}):new F({map:s,normalMap:o.normal_map?p:null}));if(l.rotateZ(Math.PI/180*o.tilt),o.ring){const a=new T().load(o.ring),h=new ue(20,30,128),c=new F({map:a,side:me}),y=new A(h,c);y.rotateY(-.5*Math.PI),y.rotateX(-.4*Math.PI),e.add(y)}o.moons&&o.moons.length&&o.moons.forEach(a=>{const h=new I,c=new A(new X(a.radius*G.scaleDown,32,32),new F({map:new T().load(a.texture_map),normalMap:new T().load(a.normal_map)}));c.position.set(V(a.perihelion_astronomical_unit)*G.scaleDown,0,0);const y=new Z(a.color||16777215,.2,500,0);c.add(y),h.add(c),e.add(h),se(c,c,a),te(h,a)});let u;if(o.key!=="sun"&&(u=te(e,o)),o.key==="sun"){const a=new Z(16777215,o.luminosity*5,5e6,0);l.add(a)}se(l,e,o),e.add(l),t.add(e),G.planets.push({raw:o,bodySystemObj:t,bodySystem:e,body:l,path:u})}function se(o,t,e){const s=document.createElement("div");s.className=`${e.key} tracking-widest  uppercase cursor-pointer text-bold opacity-60`,s.innerText=e.name,s.addEventListener("pointerdown",()=>{R.emit("pin-planet",{object3d:t,planetData:e})});const p=new ge(s);p.position.copy(o.position),p.center.set(.5,1),p.layers.set(0),o.add(p)}const $e={class:"my-2 rounded w-[inherit] h-full bg-[#39393c3a] relative"},Ee={class:"mx-3 py-1"},Le={class:"flex justify-between items-center truncate"},Oe={class:"tracking-[8px] uppercase truncate transition-all duration-100 text-bold opacity-60"},Be={class:"flex items-center"},Ge=N({__name:"planetMission",emits:["close"],setup(o,{emit:t}){const e=L(),s=t;function p(){s("close")}return(l,u)=>(P(),C("div",$e,[n("div",Ee,[n("div",Le,[n("div",Oe,S(i(e).selectedPlanetMission.name)+"'s Missions ",1),n("div",Be,[M(i(z),{class:"scale-150 opacity-40 cursor-pointer",icon:"material-symbols:close-rounded",onClick:p})])])])]))}});const He={class:"absolute bottom-10 left-1/2 z-10"},Ie={class:"-translate-x-1/2 w-max space-y-1"},Ae={key:0,class:"flex justify-center tracking-widest truncate transition-all duration-100 text-bold opacity-60 space-x-1"},Fe=n("span",{class:"mr-1"},"1 year =",-1),Ne={class:"text-green-400"},Ue={class:"grid grid-cols-3 gap-7 min-h-[34px]"},Ve={class:"flex justify-center items-center"},We={class:"absolute top-0 left-0 z-10"},qe={class:"flex"},Ye={class:"flex items-center justify-between mb-1"},Xe={class:"tracking-widest uppercase truncate transition-all duration-100 cursor-pointer text-bold opacity-60"},Ze={class:"overflow-y-auto overflow-x-hidden space-y-1 planet-list pb-1 pr-1 max-h-[70vh]"},Je=["onClick"],Ke={class:"flex justify-between h-full"},Qe={class:"mx-3 my-1 flex flex-col justify-between"},et={class:"tracking-widest cursor-pointer text-bold"},tt={class:"flex space-x-2 mb-1"},st={class:"translate-x-1/3"},ot=["src"],nt={class:"absolute top-0 right-0 z-10"},at={class:"m-2 space-y-1"},it=n("div",{class:"text-right"},[n("h3",{class:"tracking-widest uppercase cursor-pointer text-bold opacity-60"}," Option ")],-1),lt=n("div",{class:"absolute z-10 bottom-1 left-1"},[n("div",{class:"opacity-30 italic"}," Real time position is not supported ")],-1),rt=N({__name:"navOverlay",setup(o){const{t}=je(),e=L(),s=w(!1),p=w("minute(s)"),l=[{key:"second(s)",label:"second"},{key:"minute(s)",label:"minute"},{key:"hour(s)",label:"hour"},{key:"day(s)",label:"day"}],u=w(!0),a=w(0);J(()=>{p.value==="minute(s)"?a.value=e.timelapseMultiply/60:p.value==="hour(s)"?a.value=e.timelapseMultiply/(60*60):p.value==="day(s)"?a.value=e.timelapseMultiply/(60*60*24):a.value=e.timelapseMultiply});function h(b){e.selectedPlanet?e.selectedPlanet.planetData.key===b.raw.key?e.selectedPlanet=null:R.emit("pin-planet",{object3d:b.bodySystem,planetData:b.raw}):R.emit("pin-planet",{object3d:b.bodySystem,planetData:b.raw})}function c(b){R.emit("move-to-planet",{object3d:b.bodySystem,planetData:b.raw})}function y(){switch(p.value){case"minute(s)":e.timelapseMultiply=e.timelapseMultiply+60;break;case"hour(s)":e.timelapseMultiply=e.timelapseMultiply+60*60;break;case"day(s)":e.timelapseMultiply=e.timelapseMultiply+60*60*24;break;default:++e.timelapseMultiply;break}}function k(){if(e.timelapseMultiply>0)switch(p.value){case"minute(s)":e.timelapseMultiply=e.timelapseMultiply-60;break;case"hour(s)":e.timelapseMultiply=e.timelapseMultiply-60*60;break;case"day(s)":e.timelapseMultiply=e.timelapseMultiply-60*60*24;break;default:--e.timelapseMultiply;break}}function _(b){switch(p.value=b,p.value){case"minute(s)":e.timelapseMultiply=a.value*60;break;case"hour(s)":e.timelapseMultiply=a.value*60*60;break;case"day(s)":e.timelapseMultiply=a.value*60*60*24;break;default:e.timelapseMultiply=a.value;break}}function x(){e.realTime=!e.realTime}function D(b,v){b.stopPropagation(),s.value=!0,e.selectedPlanetMission=v.raw}function $(){s.value=!s.value}return(b,v)=>{const r=ee("n-dropdown"),m=ee("n-button");return P(),C(Q,null,[n("div",He,[n("div",Ie,[i(e).realTime?B("",!0):(P(),C("div",Ae,[Fe,n("span",Ne,S(a.value),1),M(r,{trigger:"hover",options:l,onSelect:_},{default:O(()=>[n("span",null,S(p.value),1)]),_:1})])),n("div",Ue,[n("div",null,[i(e).realTime?B("",!0):(P(),K(m,{key:0,disabled:a.value===1||i(e).realTime,quaternary:"",class:"opacity-60 !bg-[#ffffff4d] w-min",onClick:k},{default:O(()=>[M(i(z),{icon:"solar:skip-previous-line-duotone"})]),_:1},8,["disabled"]))]),n("div",Ve,[n("div",{class:j(`${i(e).realTime?"bg-green-600 before:bg-green-600":"bg-blue-600 before:bg-blue-600"} rounded-full w-4 h-4 cursor-pointer before:w-6 before:h-6 before:opacity-60 before:content-[''] before:flex before:-m-1 before:rounded-full`),onClick:x},null,2)]),n("div",null,[i(e).realTime?B("",!0):(P(),K(m,{key:0,disabled:i(e).realTime,quaternary:"",class:"opacity-60 !bg-[#ffffff4d] w-min",onClick:y},{default:O(()=>[M(i(z),{icon:"solar:skip-next-line-duotone"})]),_:1},8,["disabled"]))])]),n("div",{class:j(`tracking-widest text-[16px] uppercase ${i(e).realTime?"text-green-600":"text-blue-600"} font-thin truncate transition-all duration-100 text-bold opacity-60`)},S(i(e).realTime?"Real time":"Relative time"),3)])]),n("div",We,[n("div",qe,[n("div",{class:j(`m-2  transition-all duration-200
       ${u.value?"w-[20vw]":"w-0"}`)},[n("div",Ye,[n("div",Xe,S(i(t)("view.solar_system.planet_nav.title")),1),n("div",null,[M(m,{size:"small",ghost:"",class:"bg-[#39393c99] opacity-60",onClick:v[0]||(v[0]=d=>u.value=!u.value)},{default:O(()=>[M(i(z),{icon:u.value?"ic:baseline-keyboard-double-arrow-left":"ic:baseline-keyboard-double-arrow-right"},null,8,["icon"])]),_:1})])]),n("div",Ze,[(P(!0),C(Q,null,Pe(i(e).planets,(d,f)=>(P(),C("div",{key:f,class:"bg-[#3a3a3d99] h-[7vh] hover:bg-[#39393c99] transition-all duration-100 rounded-sm opacity-40 hover:opacity-100 cursor-pointer",onClick:g=>c(d)},[n("div",Ke,[n("div",Qe,[n("div",et,S(d.raw.name),1),n("div",tt,[M(i(z),{class:"cursor-pointer",icon:i(e).selectedPlanet&&i(e).selectedPlanet.planetData.key===d.raw.key?"solar:pin-bold":"solar:pin-broken",onClick:g=>h(d)},null,8,["icon","onClick"]),M(i(z),{class:"cursor-pointer",icon:"solar:satellite-linear",onClick:g=>D(g,d)},null,8,["onClick"])])]),n("div",st,[n("img",{src:d.raw.logo,class:"h-full"},null,8,ot)])])],8,Je))),128))])],2),i(e).selectedPlanetMission?(P(),C("div",{key:0,class:j(`${u.value&&s.value?"w-[50vw]":"w-0"} h-[inherit] transition-all duration-100 `)},[M(Ge,{onClose:$})],2)):B("",!0)])]),n("div",nt,[n("div",at,[it,n("div",{class:j(`p-2 cursor-pointer  ${i(e).displayPath?"bg-[#ffffffb0] text-black":"bg-[#ffffff33] "}`),onClick:v[1]||(v[1]=d=>i(e).displayPath=!i(e).displayPath)},S(i(e).displayPath?i(t)("view.solar_system.option.show_orbit"):i(t)("view.solar_system.option.hide_orbit")),3),n("div",{class:j(`p-2 cursor-pointer  ${i(e).displayGridHelper?"bg-[#ffffffb0] text-black":"bg-[#ffffff33] "}`),onClick:v[2]||(v[2]=d=>i(e).displayGridHelper=!i(e).displayGridHelper)},S(i(e).displayGridHelper?"Show grid":"Hide grid"),3),n("div",{class:j(`p-2 cursor-pointer  ${i(e).isRealScale?"bg-[#ffffffb0] text-black":"bg-[#ffffff33] "}`),onClick:v[3]||(v[3]=d=>i(e).isRealScale=!i(e).isRealScale)},S(i(e).isRealScale?"Real scale":"Relative scale"),3)])]),lt],64)}}}),ct={class:"relative w-full h-full"},bt=N({__name:"index",setup(o){const t=L(),e=w(null),s=new fe,p=w(null);let l,u;const a=new he({antialias:!0,logarithmicDepthBuffer:!1}),h=new ke;let c=2;const y=new ye(1e7,1e3),k=new be(1e7),_=new we(4210752,.2);s.add(_),De(async()=>{s.background=new W("black");const r=await Te();s.add(r);const{width:m,height:d,top:f}=e.value.getBoundingClientRect();l=new ve(75,m/d,.1,1e12),l.position.set(0,8e4,8e4),a.setPixelRatio(window.devicePixelRatio),a.setSize(m,d),e.value.appendChild(a.domElement),h.setSize(m,d),h.domElement.style.position="absolute",h.domElement.style.top=f+"px",document.body.appendChild(h.domElement),u=new _e(l,h.domElement),u.zoomSpeed=t.controlSpeed,u.panSpeed=t.controlSpeed,v(),window.addEventListener("resize",D)}),Ce(()=>{location.reload()}),R.on("pin-planet",r=>{c=2,t.selectedPlanet=r;const{x:m,y:d,z:f}=t.selectedPlanet.object3d.position;l.position.x=m-t.selectedPlanet.planetData.radius*t.scaleDown-2,l.position.y=d+t.selectedPlanet.planetData.radius*t.scaleDown+1,l.position.z=f+t.selectedPlanet.planetData.radius*t.scaleDown+2,u.target=new E(m,d,f)}),R.on("move-to-planet",r=>{const{x:m,y:d,z:f}=r.object3d.position;l.position.x=m-r.planetData.radius*t.scaleDown-2,l.position.y=d+r.planetData.radius*t.scaleDown+1,l.position.z=f+r.planetData.radius*t.scaleDown+2,u.target=new E(m,d,f)}),J(()=>{t.displayGridHelper?(s.add(y),s.add(k)):(s.remove(y),s.remove(k)),u&&(u.zoomSpeed=t.controlSpeed,u.panSpeed=t.controlSpeed)}),x();async function x(){const r=[],d=await Me({filter:[]});d&&(d.data.forEach(f=>{if(f.mother_planet){const g=d.data.find(H=>H.key===f.mother_planet);g&&(g.moons||(g.moons=[]),g.moons.push(f))}else r.push(f)}),r.forEach(f=>{Re(f)}),t.planets.forEach(f=>{s.add(U(f.bodySystemObj)),f.path&&s.add(U(f.path.path))}))}function D(){const{width:r,height:m}=e.value.getBoundingClientRect();a.setSize(r,m)}window.addEventListener("wheel",$);function $(r){m(r)?c>2&&--c:c<10&&++c;function m(d){return d.wheelDelta?d.wheelDelta>0:d.deltaY<0}}function b(r,m){a.render(r,m),h.render(r,m)}function v(){if(p.value=requestAnimationFrame(v),u.update(),b(s,l),t.planets.length&&t.planets.forEach(r=>{r.raw.key!=="sun"&&(r.body.rotateY(t.realTime?1/(r.raw.synodic_rotation_period*84600):1/(r.raw.synodic_rotation_period*84600)/t.timelapseMultiply),r.path&&U(r.path.animatedPath()))}),t.selectedPlanet){const r=t.planets.find(ne=>ne.raw.key==="sun"),m=t.selectedPlanet.object3d.position.distanceTo(r==null?void 0:r.bodySystem.position),{x:d,y:f,z:g}=t.selectedPlanet.object3d.position,H=(m-t.selectedPlanet.planetData.radius*t.scaleDown*c)*(d/m),oe=(m-t.selectedPlanet.planetData.radius*t.scaleDown*c)*(g/m);l.position.x=H,l.position.z=oe,u.target=new E(d,f,g)}}return(r,m)=>(P(),C("div",ct,[n("div",{ref_key:"el",ref:e,class:"w-full h-full"},null,512),M(rt)]))}});export{bt as default};
